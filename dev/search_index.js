var documenterSearchIndex = {"docs":
[{"location":"Cylindrical/Circular/#Circular-Waveguide","page":"Circular Waveguides","title":"Circular Waveguide","text":"","category":"section"},{"location":"Cylindrical/Circular/","page":"Circular Waveguides","title":"Circular Waveguides","text":"Circular waveguides support both TE and TM modes, characterized by integer indices (m, n) where m represents the azimuthal variation and n represents the radial variation. The solutions involve Bessel functions of the first kind for the radial dependence and sinusoidal functions for the angular variation.","category":"page"},{"location":"Cylindrical/Circular/","page":"Circular Waveguides","title":"Circular Waveguides","text":"For modes with m > 0, two polarizations exist (cosine and sine variations), which have identical cutoff frequencies but different field orientations.","category":"page"},{"location":"Cylindrical/Circular/#Numerical-/-Analytical-Comparison","page":"Circular Waveguides","title":"Numerical / Analytical Comparison","text":"","category":"section"},{"location":"Cylindrical/Circular/","page":"Circular Waveguides","title":"Circular Waveguides","text":"To validate the analytical solutions, we first compute numerical results using a finite element method on a circular mesh. The mesh is generated using Gmsh for the circular cross-section of the waveguide.","category":"page"},{"location":"Cylindrical/Circular/","page":"Circular Waveguides","title":"Circular Waveguides","text":"Mesh files (.msh) can be found in \\src\\Assets\\mesh and are generated with Gmsh.jl using functions in \\src\\Assets\\example_mesh.jl.","category":"page"},{"location":"Cylindrical/Circular/","page":"Circular Waveguides","title":"Circular Waveguides","text":"The following code shows the first 18 TE modes computed numerically. Note that modes with m > 0 appear in  pairs (cosine/sine polarizations).","category":"page"},{"location":"Cylindrical/Circular/","page":"Circular Waveguides","title":"Circular Waveguides","text":"\nR = 1\nname = \"../Assets/mesh/circular_wg1.msh\"\ncwg_mesh(R; dl = 0.25e-1, name = name)\nmodel = GmshDiscreteModel(name, renumber = false)\n\nΩ_domain = Triangulation(model, tags=\"Domain\")\ngridap_coords = get_node_coordinates(Ω_domain)\nmakie_coords = map(x->Point2(x.data), gridap_coords)\nface_to_nodes = stack(map(x->x, get_cell_node_ids(Ω_domain)))'\n\nA_te, B_te, U_te, V_te = engeimode_gridap(model, :TE, order = 2)\nnev = 20\nλ_te, ϕ_te = eigs(A_te, B_te; nev=nev, which=:SM, maxiter=1200)\n\nt = range(0, 2*pi, length=100)\ncirc_y_r = @. R * sin(t)\ncirc_x_r = @. R * cos(t)\n\nfig = Figure(size = (1200, 900))\nplot_ids = Iterators.product(1:6, 1:3) |> collect |> vec\nfor (idp, (ii, jj)) in enumerate(plot_ids)\n    uh = FEFunction(V_te, real.(ϕ_te[:, idp+1]), get_dirichlet_dof_values(V_te))\n    gridap_values = evaluate(uh, gridap_coords)\n    fz_num = abs.(gridap_values)\n    fz_num = fz_num / maximum(fz_num)\n    coord2 = makie_coords[argmin(fz_num)]\n    axi = Axis(fig[jj,ii])\n    lines!(axi, circ_x_r, circ_y_r, linewidth = 3.5, color = :black)\n    mesh!(axi, makie_coords, face_to_nodes, color = fz_num, colormap = :jet)\n    hidedecorations!(axi)\nend\nLabel(fig[0, 3:4], \"Numeric TE Modes\", fontsize = 20)\nfig","category":"page"},{"location":"Cylindrical/Circular/","page":"Circular Waveguides","title":"Circular Waveguides","text":"(Image: Image 3)","category":"page"},{"location":"Cylindrical/Circular/","page":"Circular Waveguides","title":"Circular Waveguides","text":"The numerical solution shows the magnitude of the longitudinal magnetic field component (Hz) for TE modes. Each mode exhibits a characteristic pattern determined by its indices (m, n), with m radial nodal lines.","category":"page"},{"location":"Cylindrical/Circular/#Analytical-Results","page":"Circular Waveguides","title":"Analytical Results","text":"","category":"section"},{"location":"Cylindrical/Circular/","page":"Circular Waveguides","title":"Circular Waveguides","text":"We now compute the analytical field solutions using the te_cwg_fields and tm_cwg_fields functions. For visualization clarity, we show only one polarization (cosine variation) for modes with m > 0. The analytical solutions provide exact field distributions based on Bessel function evaluations.","category":"page"},{"location":"Cylindrical/Circular/","page":"Circular Waveguides","title":"Circular Waveguides","text":"R = 1\nfreq = 10e9\n\nname = \"../Assets/mesh/circular_wg1.msh\"\n#cwg_mesh(R; dl = 0.25e-1, name = name)\ncoord, conn = mesh_data(name)\ncoords = coord[:, 1:maximum(conn)]\nxcoords = coords[1, :]\nycoords = coords[2, :]\nrcoords = map((x, y) -> hypot(x, y), xcoords, ycoords)\nθcoords = map((x, y) -> atan(y, x), xcoords, ycoords)\n\nmodekind = [(1, 1, :TE), (0, 1, :TM), (2, 1, :TE), (0, 1, :TE), \n(1, 1, :TM), (3, 1, :TE), (2, 1, :TM), (4, 1, :TE), (1, 2, :TE), \n(0, 2, :TM), (3, 1, :TM), (5, 1, :TE), (2, 2, :TE), (0, 2, :TE),\n(1, 2, :TM), (6, 1, :TE), (4, 1, :TM), (3, 2, :TE), (2, 2, :TM),\n(1, 3, :TE), (7, 1, :TE), (0, 3, :TM), (5, 1, :TM), (4, 2, :TE)]\n\nfig = Figure(size = (1200, 900))\n\nt = range(0, 2*pi, length=100)\ncirc_y_r = @. R * sin(t)\ncirc_x_r = @. R * cos(t)\n\nplot_ids = Iterators.product(1:6, 1:4) |> collect |> vec\n\nfor (idp, (m, n, ki)) in enumerate(modekind)\n    stitle = L\"%$(ki)_{%$m,%$n}\"\n    ii, jj = plot_ids[idp]\n    axi = Axis(fig[jj, ii], title = stitle, titlesize = 20)\n    hidedecorations!(axi)\n\n    if ki == :TE\n        fields = te_cwg_fields(rcoords, θcoords, R, m, n, freq, 1.0, 1.0)\n        fz = map(x->abs(x[6]), fields)\n    else\n        fields = tm_cwg_fields(rcoords, θcoords, R, m, n, freq, 1.0, 1.0)\n        fz = map(x->abs(x[3]), fields)\n    end \n\n    lines!(axi, circ_x_r, circ_y_r, linewidth = 3.5, color = :black)\n    mesh!(axi, coords, conn, color = fz, colormap = :jet)\nend\nfig","category":"page"},{"location":"Cylindrical/Circular/","page":"Circular Waveguides","title":"Circular Waveguides","text":"This visualization displays 24 modes ordered by increasing cutoff frequency, alternating between TE and TM types. The color map shows the magnitude of Hz (for TE modes) or Ez (for TM modes).","category":"page"},{"location":"Cylindrical/Circular/#Transverse-Fields","page":"Circular Waveguides","title":"Transverse Fields","text":"","category":"section"},{"location":"Cylindrical/Circular/","page":"Circular Waveguides","title":"Circular Waveguides","text":"The field functions return electromagnetic field components in cylindrical coordinates (Er, Eθ, Ez, Hr, Hθ, Hz). For visualization and practical applications, we often need the transverse components in Cartesian coordinates. The conversion is performed using the metric and unit vector transformations provided by the metric_and_unit_cylindrical function.","category":"page"},{"location":"Cylindrical/Circular/","page":"Circular Waveguides","title":"Circular Waveguides","text":"The following code computes and visualizes the transverse electric field for TE modes and the transverse magnetic field for TM modes, displayed as vector arrow plots:","category":"page"},{"location":"Cylindrical/Circular/","page":"Circular Waveguides","title":"Circular Waveguides","text":"\nname = \"../Assets/mesh/circular_wg2.msh\"\n#cwg_mesh(R; dl = 0.7e-1, name = name)\ncoord, conn = mesh_data(name)\ncoords = coord[:, 1:maximum(conn)]\nxcoords = coords[1, :]\nycoords = coords[2, :]\nrcoords = map((x, y) -> hypot(x, y), xcoords, ycoords)\nθcoords = map((x, y) -> atan(y, x), xcoords, ycoords)\n\nfig = Figure(size = (1200, 900))\nfor (idp, (m, n, ki)) in enumerate(modekind)\n    stitle = L\"%$(ki)_{%$m,%$n}\"\n    ii, jj = plot_ids[idp]\n    axi = Axis(fig[jj, ii], title = stitle, titlesize = 20)\n    hidedecorations!(axi)\n\n    if ki == :TE\n        fields = te_cwg_fields(rcoords, θcoords, R, m, n, freq, 1.0, 1.0)\n        fzi = map(x->(x[1], x[2]), fields)\n    else\n        fields = tm_cwg_fields(rcoords, θcoords, R, m, n, freq, 1.0, 1.0)\n        fzi = map(x->(x[4], x[5]), fields)\n    end \n\n    fxy = map(fzi, rcoords, θcoords) do frθ, r, θ\n        h_r, h_ϕ, e_r_x, e_r_y, e_ϕ_x, e_ϕ_y = metric_and_unit_cylindrical(r, θ)\n        Fx = frθ[1] * e_r_x + frθ[2] * e_ϕ_x\n        Fy = frθ[1] * e_r_y + frθ[2] * e_ϕ_y \n        return (Fx, Fy)\n    end\n\n    t = lines!(axi, circ_x_r, circ_y_r, linewidth = 3.5, color = :black)\n    translate!(t, (0, 0, 2))\n    fu = real.(getindex.(fxy, 1))\n    fv = real.(getindex.(fxy, 2))\n    ft = map(x->hypot(x...), fxy) * 25\n    vm = maximum(ft)*10\n    fu = fu ./ ft\n    fv = fv ./ ft\n    arrows2d!(axi, xcoords, ycoords, fu, fv, color = ft, colormap = :jet)  \nend\nfig\n\n","category":"page"},{"location":"Cylindrical/Coaxial/#Coaxial-Waveguide","page":"Coaxial Waveguides","title":"Coaxial Waveguide","text":"","category":"section"},{"location":"Cylindrical/Coaxial/","page":"Coaxial Waveguides","title":"Coaxial Waveguides","text":"Coaxial waveguides are unique in supporting a TEM mode, which has no cutoff frequency. This makes coaxial transmission lines suitable for broadband applications. Additionally, coaxial structures support TE and TM higher-order modes, whose field solutions involve both Bessel functions of the first kind (Jₘ) and second kind (Yₘ) to satisfy boundary conditions on both the inner and outer conductors.","category":"page"},{"location":"Cylindrical/Coaxial/","page":"Coaxial Waveguides","title":"Coaxial Waveguides","text":"For visualization purposes, we focus on the higher-order TE and TM modes, as the TEM mode has a simple radial field pattern.","category":"page"},{"location":"Cylindrical/Coaxial/#Numerical-/-Analytical-Comparison","page":"Coaxial Waveguides","title":"Numerical / Analytical Comparison","text":"","category":"section"},{"location":"Cylindrical/Coaxial/","page":"Coaxial Waveguides","title":"Coaxial Waveguides","text":"To validate the analytical solutions, we compare numerical eigenmode results obtained with finite element method against the closed-form expressions. The mesh for the coaxial cross-section includes both the inner conductor boundary (at radius R2) and the outer conductor boundary (at radius R1).","category":"page"},{"location":"Cylindrical/Coaxial/","page":"Coaxial Waveguides","title":"Coaxial Waveguides","text":"Mesh files (.msh) can be found in \\src\\Assets\\mesh and are generated with Gmsh.jl using functions in \\src\\Assets\\example_mesh.jl.","category":"page"},{"location":"Cylindrical/Coaxial/","page":"Coaxial Waveguides","title":"Coaxial Waveguides","text":"\nusing GLMakie\n\nname = \"../Assets/mesh/coax_wg1.msh\"\n\nR1 = 1\nR2 = 0.1\n#coaxwg_mesh(R1, R2; dl = 0.1, name = name)\nmodel = GmshDiscreteModel(name, renumber = false)\nA_te, B_te, U_te, V_te = engeimode_gridap(model, :TE, order = 2)\nA_tm, B_tm, U_tm, V_tm = engeimode_gridap(model, :TM, order = 2)\n\nnev = 6\nλ_te, ϕ_te = eigs(A_te, B_te; nev=nev, which=:SM, maxiter=6200)\nλ_tm, ϕ_tm = eigs(A_tm, B_tm; nev=nev, which=:SM, maxiter=6200)\n\nΩ_domain = Triangulation(model, tags=\"Domain\")\ngridap_coords = get_node_coordinates(Ω_domain)\nmakie_coords = map(x->Point2(x.data), gridap_coords)\nface_to_nodes = stack(map(x->x, get_cell_node_ids(Ω_domain)))'\n\nmn = 3\nuh = FEFunction(V_te, real.(ϕ_te[:, mn]), get_dirichlet_dof_values(V_te))\ngridap_values = evaluate(uh, gridap_coords)\nfz_num = abs.(gridap_values)\nfz_num = fz_num / maximum(fz_num)\ncoord2 = makie_coords[argmin(fz_num)]\n\n# Analytic solution\nuh_t = CellField(x-> begin\n    x, y = x[1], x[2]\n    r = hypot(x, y)\n    θ = atan(y, x) - (atan(coord2[2], coord2[1])) + pi/2\n    (Er, Eθ, Ez, Hr, Hθ, Hz) = te_coax_fields(r, θ, R1, R2, 1, 1, 10e9, 1.0, 1.0)\nreturn Hz end, Ω_domain)\nfz_an = evaluate(uh_t, gridap_coords)\n\nfz_norm = abs.(fz_an) / maximum(abs.(fz_an))\n\nfig = Figure()\nax1 = Axis(fig[1,1], title = \"Eigenmode solution\")\nhidedecorations!(ax1)\nt = range(0, 2*pi, length=100)\ncirc_x_r1 = @. R1 * cos(t)\ncirc_y_r1 = @. R1 * sin(t)\nt1 = lines!(ax1, circ_x_r1, circ_y_r1, linewidth = 3.5, color = :black)\n\ncirc_x_r2 = @. R2 * cos(t)\ncirc_y_r2 = @. R2 * sin(t)\nt2 = lines!(ax1, circ_x_r2, circ_y_r2, linewidth = 3.5, color = :black)\ntranslate!(t1, (0, 0, 2))\ntranslate!(t2, (0, 0, 2))\n\nmesh!(ax1, makie_coords, face_to_nodes, color = fz_num, colormap = :jet)\n\n\nax2 = Axis(fig[1,2], title = \"Analytic solution\")\nhidedecorations!(ax2)\nt1 = lines!(ax2, circ_x_r1, circ_y_r1, linewidth = 2.5, color = :black)\nt2 = lines!(ax2, circ_x_r2, circ_y_r2, linewidth = 2.5, color = :black)\ntranslate!(t1, (0, 0, 2))\ntranslate!(t2, (0, 0, 2))\nmesh!(ax2, makie_coords, face_to_nodes, color = abs.(fz_an), colormap = :jet)\n\nfig","category":"page"},{"location":"Cylindrical/Coaxial/","page":"Coaxial Waveguides","title":"Coaxial Waveguides","text":"(Image: Image 4)","category":"page"},{"location":"Cylindrical/Coaxial/","page":"Coaxial Waveguides","title":"Coaxial Waveguides","text":"The comparison shows excellent agreement between the numerical eigenmode solution and the analytical result. Note that the numerical solution may have an arbitrary phase rotation, which is corrected in the visualization by aligning the field minimum.","category":"page"},{"location":"Cylindrical/Coaxial/","page":"Coaxial Waveguides","title":"Coaxial Waveguides","text":"The normalized error between the numerical approximation and the analytical solution is:","category":"page"},{"location":"Cylindrical/Coaxial/","page":"Coaxial Waveguides","title":"Coaxial Waveguides","text":"n_num = sqrt(sum(abs2, fz_num))\nn_an = sqrt(sum(abs2, fz_an))\nfz_num_norm = abs.(fz_num)/n_num \nfz_an_norm = abs.(fz_an)/n_an\nrmse = err = sqrt(sum(abs2, fz_num_norm-fz_an_norm)/length(fz_an_norm)) #0.0002707251478033022","category":"page"},{"location":"Cylindrical/Coaxial/","page":"Coaxial Waveguides","title":"Coaxial Waveguides","text":"This small RMSE (root mean square error) of approximately 0.00027 confirms the accuracy of the analytical solution.","category":"page"},{"location":"Cylindrical/Coaxial/#Analytical-Results","page":"Coaxial Waveguides","title":"Analytical Results","text":"","category":"section"},{"location":"Cylindrical/Coaxial/","page":"Coaxial Waveguides","title":"Coaxial Waveguides","text":"We now visualize the first 24 TE modes computed analytically using te_coax_fields. The modes are ordered by increasing cutoff frequency. For a coaxial guide with outer radius R1 = 1 and inner radius R2 = 0.1 (ratio 10:1), the mode patterns show the characteristic interference between fields reflected from the inner and outer conductors.","category":"page"},{"location":"Cylindrical/Coaxial/","page":"Coaxial Waveguides","title":"Coaxial Waveguides","text":"\nusing GLMakie\n\nname = \"../Assets/mesh/coax_wg2.msh\"\nR1 = 1\nR2 = 0.1\n#coaxwg_mesh(R1, R2; dl = 0.02, name = name)\ncoord, conn = mesh_data(name)\ncoords = coord[:, 1:maximum(conn)]\nxcoords = coords[1, :]\nycoords = coords[2, :]\nrcoords = map((x, y) -> hypot(x, y), xcoords, ycoords)\nθcoords = map((x, y) -> atan(y, x), xcoords, ycoords)\n\nmodekind = [(1, 1) ,(2, 1) ,(0, 1) ,(3, 1),(1, 2),\n            (4, 1) ,(5, 1) ,(2, 2) ,(0, 2) ,(6, 1),\n            (3, 2) ,(1, 3) ,(7, 1) ,(4, 2) ,(8, 1),\n            (2, 3) ,(5, 2) ,(9, 1) ,(0, 3) ,(3, 3),\n            (1, 4) ,(6, 2) ,(10, 1) ,(4, 3)]\n\nplot_ids = Iterators.product(1:6, 1:4) |> collect |> vec\n\nt = range(0, 2*pi, length=100)\ncirc_x_r1 = @. R1 * cos(t)\ncirc_y_r1 = @. R1 * sin(t)\ncirc_x_r2 = @. R2 * cos(t)\ncirc_y_r2 = @. R2 * sin(t)\n\nfig = Figure(size = (1200, 900))\nfor (idplot, (m, n)) in enumerate(modekind)\n    stitle = L\"TE_{%$m,%$n}\"\n    ii, jj = plot_ids[idplot]\n    axi = Axis(fig[jj,ii], title = stitle, titlesize = 20)\n    hidedecorations!(axi)\n\n    fields = te_coax_fields(rcoords, θcoords, R1, R2, m, n, 10e9, 1.0, 1.0)\n    fz = getindex.(fields, 6)\n\n    t1 = lines!(axi, circ_x_r1, circ_y_r1, linewidth = 3.5, color = :black)\n    t2 = lines!(axi, circ_x_r2, circ_y_r2, linewidth = 3.5, color = :black)\n    translate!(t1, (0, 0, 2))\n    translate!(t2, (0, 0, 2))\n    mesh!(axi, coords, conn, color = abs.(fz), colormap = :jet)\nend\nfig","category":"page"},{"location":"Cylindrical/Coaxial/","page":"Coaxial Waveguides","title":"Coaxial Waveguides","text":"The TE mode patterns display the magnitude of the longitudinal magnetic field Hz. Modes with m > 0 exhibit azimuthal variations, while modes with larger n exhibit additional radial nodal circles.","category":"page"},{"location":"Cylindrical/Coaxial/","page":"Coaxial Waveguides","title":"Coaxial Waveguides","text":"The TM modes for the same geometry different ordering and patterns:","category":"page"},{"location":"Cylindrical/Coaxial/","page":"Coaxial Waveguides","title":"Coaxial Waveguides","text":"\nmodekind = [(0, 1) ,(1, 1) ,(2, 1) ,(3, 1) ,(0, 2), \n            (1, 2) ,(4, 1) ,(2, 2) ,(5, 1) ,(3, 2),\n            (6, 1) ,(0, 3) ,(1, 3) ,(4, 2) ,(7, 1),\n            (2, 3) ,(8, 1) ,(5, 2) ,(3, 3) ,(9, 1),\n            (6, 2) ,(0, 4) ,(1, 4) ,(4, 3)]\n\nplot_ids = Iterators.product(1:6, 1:4) |> collect |> vec\n\nfig = Figure(size = (1200, 900))\nfor (idplot, (m, n)) in enumerate(modekind)\n    stitle = L\"TM_{%$m,%$n}\"\n    ii, jj = plot_ids[idplot]\n    axi = Axis(fig[jj,ii], title = stitle, titlesize = 20)\n    hidedecorations!(axi)\n\n    fields = tm_coax_fields(rcoords, θcoords, R1, R2, m, n, 10e9, 1.0, 1.0)\n    fz = getindex.(fields, 3)\n\n    t1 = lines!(axi, circ_x_r1, circ_y_r1, linewidth = 3.5, color = :black)\n    t2 = lines!(axi, circ_x_r2, circ_y_r2, linewidth = 3.5, color = :black)\n    translate!(t1, (0, 0, 2))\n    translate!(t2, (0, 0, 2))\n    mesh!(axi, coords, conn, color = abs.(fz), colormap = :jet)\nend\nfig","category":"page"},{"location":"Cylindrical/Coaxial/","page":"Coaxial Waveguides","title":"Coaxial Waveguides","text":"TM modes satisfy the boundary condition that Ez = 0 at both conductor surfaces. The field patterns are determined by combinations of Bessel functions chosen to satisfy these dual boundary conditions.","category":"page"},{"location":"Cylindrical/Coaxial/#Additional-Examples","page":"Coaxial Waveguides","title":"Additional Examples","text":"","category":"section"},{"location":"Cylindrical/Coaxial/","page":"Coaxial Waveguides","title":"Coaxial Waveguides","text":"To demonstrate how geometry affects mode patterns, we now examine a coaxial guide with a larger inner conductor. The following visualization shows the first 24 higher-order modes (excluding the TEM mode) for a radius ratio R1/R2 = 1/0.65, corresponding to a much thinner annular region.","category":"page"},{"location":"Cylindrical/Coaxial/","page":"Coaxial Waveguides","title":"Coaxial Waveguides","text":"\nR1 = 1\nR2 = 0.65\n\nname = \"../Assets/mesh/coax_wg3.msh\"\n#coaxwg_mesh(R1, R2; dl = 0.01, name = name)\ncoord, conn = mesh_data(name)\ncoords = coord[:, 1:maximum(conn)]\nxcoords = coords[1, :]\nycoords = coords[2, :]\nrcoords = map((x, y) -> hypot(x, y), xcoords, ycoords)\nθcoords = map((x, y) -> atan(y, x), xcoords, ycoords)\n\nmodekind = [(1, 1, :TE) , (2, 1, :TE) , (3, 1, :TE), (4, 1, :TE),\n            (5, 1, :TE) , (6, 1, :TE), (7, 1, :TE), (0, 1, :TM), \n            (0, 1, :TE) , (1, 1, :TM) , (1, 2, :TE) , (2, 1, :TM),\n            (2, 2, :TE) , (8, 1, :TE) , (3, 1, :TM) , (3, 2, :TE),\n            (4, 1, :TM) , (4, 2, :TE) , (9, 1, :TE), (5, 1, :TM),\n            (5, 2, :TE) , (6, 1, :TM) , (10, 1, :TE) , (6, 2, :TE)]\n\nt = range(0, 2*pi, length=100)\ncirc_x_r1 = @. R1 * cos(t)\ncirc_y_r1 = @. R1 * sin(t)\ncirc_x_r2 = @. R2 * cos(t)\ncirc_y_r2 = @. R2 * sin(t)\n\nfig = Figure(size = (1200, 900))\nfor (idplot, (m, n, ki)) in enumerate(modekind)\n    ii, jj = plot_ids[idplot]\n    stitle = L\"%$(ki)_{%$m,%$n}\"\n    axi = Axis(fig[jj,ii], title = stitle, titlesize = 20)\n    hidedecorations!(axi)\n\n    if ki == :TE\n        fields = te_coax_fields(rcoords, θcoords, R1, R2, m, n, 10e9, 1.0, 1.0)\n        fz = getindex.(fields, 6)\n    else\n        fields = tm_coax_fields(rcoords, θcoords, R1, R2, m, n, 10e9, 1.0, 1.0)\n        fz = getindex.(fields, 3)\n    end\n\n    t1 = lines!(axi, circ_x_r1, circ_y_r1, linewidth = 3.5, color = :black)\n    t2 = lines!(axi, circ_x_r2, circ_y_r2, linewidth = 3.5, color = :black)\n    translate!(t1, (0, 0, 2))\n    translate!(t2, (0, 0, 2))\n    mesh!(axi, coords, conn, color = abs.(fz), colormap = :jet)\nend\nfig","category":"page"},{"location":"Examples/#Examples-and-Gallery","page":"Gallery","title":"Examples and Gallery","text":"","category":"section"},{"location":"Examples/","page":"Gallery","title":"Gallery","text":"To facilitate visualization of analytical results and validate their accuracy, we compare them with numerical solutions obtained using the finite element method. For this purpose, we use Gridap.jl to solve the electromagnetic eigenvalue problem.","category":"page"},{"location":"Examples/","page":"Gallery","title":"Gallery","text":"Note: Numerical results obtained with Gridap are not executed during documentation generation for simplicity, but the code used to generate the images is included as reference.","category":"page"},{"location":"Examples/#Dependencies-for-Numerical-Comparison","page":"Gallery","title":"Dependencies for Numerical Comparison","text":"","category":"section"},{"location":"Examples/","page":"Gallery","title":"Gallery","text":"To reproduce the numerical comparisons, the following packages are required:","category":"page"},{"location":"Examples/","page":"Gallery","title":"Gallery","text":"using Gmsh\nusing Gmsh: gmsh\nusing Gridap\nusing GridapGmsh\nusing Gridap.Helpers\nusing Gridap.Arrays\nusing Gridap.CellData\nusing Gridap.Geometry\nusing Gridap.ReferenceFEs\nusing Gridap.Visualization\nusing Arpack\nusing GLMakie","category":"page"},{"location":"Examples/#Helper-Functions","page":"Gallery","title":"Helper Functions","text":"","category":"section"},{"location":"Examples/#Mesh-Data-Extraction","page":"Gallery","title":"Mesh Data Extraction","text":"","category":"section"},{"location":"Examples/","page":"Gallery","title":"Gallery","text":"The following function extracts node coordinates and element connectivity from Gmsh-generated meshes:","category":"page"},{"location":"Examples/","page":"Gallery","title":"Gallery","text":"function mesh_data(name)\n    Gmsh.gmsh.initialize()\n    Gmsh.gmsh.open(name)\n    Gmsh.gmsh.model.mesh.renumberNodes()\n    Gmsh.gmsh.model.mesh.renumberElements()\n\n    dt = Gmsh.gmsh.model.getPhysicalGroups(2)[1]\n    t = Gmsh.gmsh.model.getEntitiesForPhysicalGroup(dt...)[1]\n    _, nodeTagsPerElement = gmsh.model.mesh.getElementsByType(2, t)\n\n    tri_connectivity_flat = nodeTagsPerElement\n    num_nodes_per_element = 3 # Triangles\n    num_elements = length(tri_connectivity_flat) ÷ num_nodes_per_element\n    connectivity = reshape(tri_connectivity_flat, (num_nodes_per_element, num_elements))\n    nodeTags, nodeCoords, _ = Gmsh.gmsh.model.mesh.getNodes()\n\n    coordinates = reshape(nodeCoords, (3, length(nodeTags)))\n    Gmsh.gmsh.finalize()\n    return coordinates, connectivity'\nend","category":"page"},{"location":"Examples/#Eigenvalue-Problem-in-Gridap","page":"Gallery","title":"Eigenvalue Problem in Gridap","text":"","category":"section"},{"location":"Examples/","page":"Gallery","title":"Gallery","text":"The electromagnetic eigenvalue problem can be formulated concisely in Gridap. This function sets up the weak form of the Helmholtz equation for either TE or TM modes:","category":"page"},{"location":"Examples/","page":"Gallery","title":"Gallery","text":"function eigenmode_gridap(model, T; order = 1)\n    reffe = ReferenceFE(lagrangian, Float64, order)\n    if T == :TM\n        V = FESpace(model, reffe; conformity=:H1, dirichlet_tags=[\"PEC\"])\n    else\n\n        V = FESpace(model, reffe; conformity=:H1)\n    end\n    U = V\n    Ω = Triangulation(model)\n    dΩ = Measure(Ω, 2*order)\n\n    a(u,v) = ∫(∇(u)⋅∇(v))dΩ\n    b(u,v) = ∫(u*v)dΩ\n\n    A = assemble_matrix(a,U,V)\n    B = assemble_matrix(b,U,V)\n    return A, B, U, V\nend","category":"page"},{"location":"Examples/","page":"Gallery","title":"Gallery","text":"The eigenvalues λ obtained from this formulation are related to the cutoff wavenumber by kc² = λ. For TE modes, Neumann boundary conditions are applied (natural boundary condition in H1 space), while TM modes require Dirichlet boundary conditions (Ez = 0 at PEC walls).","category":"page"},{"location":"Examples/#Examples-by-Geometry","page":"Gallery","title":"Examples by Geometry","text":"","category":"section"},{"location":"Examples/","page":"Gallery","title":"Gallery","text":"Detailed examples for each geometry are organized in the following sections:","category":"page"},{"location":"Examples/","page":"Gallery","title":"Gallery","text":"Circular Waveguides: Comparison of TE and TM modes in circular waveguides\nCoaxial Waveguides: Visualization of TE, TM, and TEM modes in coaxial structures\nRadial and Wedge Waveguides: Modes in radial waveguides and wedge structures\nElliptic Waveguides: Modes using Mathieu functions\nRectangular Waveguides: Analytical solutions in Cartesian coordinates","category":"page"},{"location":"Rectangular/rectangular/#Rectangular-Waveguide","page":"Rectangular","title":"Rectangular Waveguide","text":"","category":"section"},{"location":"Rectangular/rectangular/","page":"Rectangular","title":"Rectangular","text":"Rectangular waveguides are the most common and analytically tractable waveguide geometry. The solutions for TE and TM modes are expressed using simple trigonometric functions (sin, cos), making them ideal for both educational purposes and practical applications. The mode indices (m, n) directly correspond to the number of half-wave variations along the width (a) and height (b) dimensions.","category":"page"},{"location":"Rectangular/rectangular/#Numerical-/-Analytical-Comparison","page":"Rectangular","title":"Numerical / Analytical Comparison","text":"","category":"section"},{"location":"Rectangular/rectangular/","page":"Rectangular","title":"Rectangular","text":"To validate the analytical solutions, we solve the eigenmode problem numerically using finite element method. A rectangular mesh is generated for the waveguide cross-section using Gmsh.","category":"page"},{"location":"Rectangular/rectangular/","page":"Rectangular","title":"Rectangular","text":"Mesh files (.msh) can be found in \\src\\Assets\\mesh and are generated with Gmsh.jl using functions in \\src\\Assets\\example_mesh.jl.","category":"page"},{"location":"Rectangular/rectangular/","page":"Rectangular","title":"Rectangular","text":"For the numerical solution, we solve for the scalar longitudinal field Hz (for TE modes) or Ez (for TM modes), which satisfies a Helmholtz equation with appropriate boundary conditions.","category":"page"},{"location":"Rectangular/rectangular/","page":"Rectangular","title":"Rectangular","text":"\nW = 1.0\nH = 0.5\nname = \"../Assets/mesh/rectangular_wg1.msh\"\nrwg_mesh(W, H; dl = 0.025, name = name)\nmodel = GmshDiscreteModel(name, renumber = false)\n\nA_te, B_te, U_te, V_te = engeimode_gridap(model, :TE, order = 2)\nA_tm, B_tm, U_tm, V_tm = engeimode_gridap(model, :TM, order = 2)\n\nnev = 10\nλ_te, ϕ_te = eigs(A_te, B_te; nev=nev, which=:SM, maxiter=5300)\nλ_tm, ϕ_tm = eigs(A_tm, B_tm; nev=nev, which=:SM, maxiter=5300)\n\n\nusing GLMakie\nfig = Figure( size = (800, 400) )\n\nfreq = 10.0e9\nmn = 3\nm, n = 2, 0\nuh = FEFunction(V_te, real.(ϕ_te[:, mn]), get_dirichlet_dof_values(V_te))\n\nΩ_triang = get_triangulation(model)\ngridap_coords = get_node_coordinates(Ω_triang)\nmakie_coords = map(x->Point2f(x.data), gridap_coords)\nface_to_nodes = stack(map(x->x, get_cell_node_ids(Ω_triang)))'\n\nfz_num = evaluate(uh, gridap_coords)\n\nax1 = Axis(fig[1,1], title = \"Numeric solution\")\nlines!(ax1, [0.0, W], [0.0, 0.0], linewidth = 3.5, color = :black)\nlines!(ax1, [0.0, W], [H, H], linewidth = 3.5, color = :black)\nlines!(ax1, [0.0, 0.0], [0.0, H], linewidth = 3.5, color = :black)\nlines!(ax1, [W, W], [0.0, H], linewidth = 3.5, color = :black)\nmesh!(ax1, makie_coords, face_to_nodes, color = abs.(fz_num), colormap = :jet)\nylims!(ax1, -W*0.25, H + W*0.25)\nhidedecorations!(ax1)\n\n# Analytic solution\n\nuh_a = CellField(x-> begin\n    (ex, ey, ez, hx, hy, hz) = te_rwg_fields(x[1], x[2], W, H, m, n, freq, 1.0, 1.0) \n    return abs(hz)\n    end, Ω_triang)\n\nfz_an = evaluate(uh_a, gridap_coords)\n\nax2 = Axis(fig[1,2], title = \"Analytic solution\")\nlines!(ax2, [0.0, W], [0.0, 0.0], linewidth = 3.5, color = :black)\nlines!(ax2, [0.0, W], [H, H], linewidth = 3.5, color = :black)\nlines!(ax2, [0.0, 0.0], [0.0, H], linewidth = 3.5, color = :black)\nlines!(ax2, [W, W], [0.0, H], linewidth = 3.5, color = :black)\nmesh!(ax2, makie_coords, face_to_nodes, color = abs.(fz_an), colormap = :jet)\nylims!(ax2, -W*0.25, H + W*0.25)\nhidedecorations!(ax2)\nfig","category":"page"},{"location":"Rectangular/rectangular/","page":"Rectangular","title":"Rectangular","text":"(Image: Image 1)","category":"page"},{"location":"Rectangular/rectangular/","page":"Rectangular","title":"Rectangular","text":"The comparison shows excellent agreement between the numerical eigenmode solution and the analytical expression. Both solutions show the TE₂₀ mode pattern with two half-wavelength variations along the width and uniform field along the height.","category":"page"},{"location":"Rectangular/rectangular/","page":"Rectangular","title":"Rectangular","text":"We can quantify the error by normalizing the field amplitudes:","category":"page"},{"location":"Rectangular/rectangular/","page":"Rectangular","title":"Rectangular","text":"n_num = sqrt(sum(abs2, fz_num))\nn_an = sqrt(sum(abs2, fz_an))\nfz_num_norm = abs.(fz_num)/n_num \nfz_an_norm = abs.(fz_an)/n_an\nrmse = err = sqrt(sum(abs2, fz_num_norm-fz_an_norm)/length(fz_an_norm)) # rmse =  0.00010047866871897437","category":"page"},{"location":"Rectangular/rectangular/","page":"Rectangular","title":"Rectangular","text":"The normalized RMSE of approximately 0.0001 demonstrates excellent agreement between the analytical and numerical solutions.","category":"page"},{"location":"Rectangular/rectangular/#Analytical-Results","page":"Rectangular","title":"Analytical Results","text":"","category":"section"},{"location":"Rectangular/rectangular/","page":"Rectangular","title":"Rectangular","text":"We now compute a comprehensive gallery of rectangular waveguide modes using the analytical functions te_rwg_fields and tm_rwg_fields. The following visualization displays 24 modes ordered by increasing cutoff frequency, showing both TE and TM types.","category":"page"},{"location":"Rectangular/rectangular/","page":"Rectangular","title":"Rectangular","text":"\nfreq = 10e9\nfig = Figure(size = (1200, 900))\n\nW = 1.0\nH = 0.7\n\nname = \"../Assets/mesh/rectangular_wg2.msh\"\n\n#rwg_mesh(W, H; dl = 1e-2, name)\n\ncoord, conn = mesh_data(name)\ncoords = coord[:, 1:maximum(conn)]\nxcoords = coords[1, :]\nycoords = coords[2, :]\n\nmodekind = [(:TE, 1, 0), (:TE, 0, 1), (:TE, 1, 1), (:TM, 1, 1),\n(:TE, 2, 0), (:TE, 2, 1), (:TM, 2, 1), (:TE, 0, 2), (:TE, 3, 0),\n(:TE, 1, 2), (:TM, 1, 2), (:TE, 3, 1), (:TM, 3, 1), (:TE, 2, 2),\n(:TM, 2, 2), (:TE, 4, 0), (:TE, 3, 2), (:TM, 3, 2), (:TE, 4, 1), \n(:TM, 4, 1), (:TE, 0, 3), (:TE, 1, 3), (:TM, 1, 3), (:TE, 2, 3)]\n\nplot_ids = Iterators.product(1:6, 1:4) |> collect |> vec\n\nfor (idp, (ki, m, n)) in enumerate(modekind)\n    stitle = L\"%$(ki)_{%$m,%$n}\"\n    ii, jj = plot_ids[idp]\n    axi = Axis(fig[jj, ii], title = stitle, titlesize = 20)\n    hidedecorations!(axi)\n\n    if ki == :TE\n        fields = te_rwg_fields(xcoords, ycoords, W, H, m, n, freq, 1.0, 1.0)\n        fz = map(x->abs(x[6]), fields) # Hz\n    else\n        fields = tm_rwg_fields(xcoords, ycoords, W, H, m, n, freq, 1.0, 1.0)\n        fz =  map(x->abs(x[3]), fields) # Ez\n    end \n\n    t1 = lines!(axi, [0.0, W], [0.0, 0.0], linewidth = 3.5, color = :black)\n    t2 = lines!(axi, [0.0, W], [H, H], linewidth = 3.5, color = :black)\n    t3 = lines!(axi, [0.0, 0.0], [0.0, H], linewidth = 3.5, color = :black)\n    t4 = lines!(axi, [W, W], [0.0, H], linewidth = 3.5, color = :black)\n    translate!(t1, (0.0, 0.0, 1.0))\n    translate!(t2, (0.0, 0.0, 1.0))\n    translate!(t3, (0.0, 0.0, 1.0))\n    translate!(t4, (0.0, 0.0, 1.0))\n    \n    mesh!(axi, coords, conn, color = fz, colormap = :jet)\n    ylims!(axi, -W*0.25, H + W*0.25)\nend\nfig\n","category":"page"},{"location":"Rectangular/rectangular/","page":"Rectangular","title":"Rectangular","text":"For rectangular waveguides, the cutoff frequency depends on both dimensions according to fc = (c/2)√[(m/a)² + (n/b)²]. The visualization shows how mode patterns become increasingly complex as the indices increase, with more nodal lines in both dimensions.","category":"page"},{"location":"Rectangular/rectangular/#Transverse-Field-Components","page":"Rectangular","title":"Transverse Field Components","text":"","category":"section"},{"location":"Rectangular/rectangular/","page":"Rectangular","title":"Rectangular","text":"In many practical applications, the transverse field components (Ex, Ey, Hx, Hy) are of primary interest, not just the longitudinal component. For TE modes, we visualize the transverse electric field (Ex, Ey), while for TM modes we show the transverse magnetic field (Hx, Hy).","category":"page"},{"location":"Rectangular/rectangular/","page":"Rectangular","title":"Rectangular","text":"\nfig = Figure(size = (1200, 900))\nname = \"../Assets/mesh/rectangular_wg3.msh\"\n#rwg_mesh(W, H; dl = 0.35e-1, name = name)\ncoord, conn = mesh_data(name)\ncoords = coord[:, 1:maximum(conn)]\nxcoords = coords[1, :]\nycoords = coords[2, :]\n\nfor (idp, (ki, m, n)) in enumerate(modekind)\n    stitle = L\"%$(ki)_{%$m,%$n}\"\n    ii, jj = plot_ids[idp]\n    axi = Axis(fig[jj, ii], title = stitle, titlesize = 20)\n    hidedecorations!(axi)\n\n    if ki == :TE\n        fields = te_rwg_fields(xcoords, ycoords, W, H, m, n, freq, 1.0, 1.0)\n        fz = map(x->(x[1], x[2]), fields) # (Ex, Ey)\n    else\n        fields = tm_rwg_fields(xcoords, ycoords, W, H, m, n, freq, 1.0, 1.0)\n        fz =  map(x->(x[4], x[5]), fields) # (Hx, Hy)\n    end \n\n    fu = real.(getindex.(fz, 1))\n    fv = real.(getindex.(fz, 2))\n    ft = map(x->hypot(x...), fz) * 55\n    vm = maximum(ft)*10\n    fu = fu ./ ft\n    fv = fv ./ ft\n    arrows2d!(axi, xcoords, ycoords,\n        fu, fv, color = ft, colormap = :jet)\n\n    t1 = lines!(axi, [0.0, W], [0.0, 0.0], linewidth = 3.5, color = :black)\n    t2 = lines!(axi, [0.0, W], [H, H], linewidth = 3.5, color = :black)\n    t3 = lines!(axi, [0.0, 0.0], [0.0, H], linewidth = 3.5, color = :black)\n    t4 = lines!(axi, [W, W], [0.0, H], linewidth = 3.5, color = :black)\n    translate!(t1, (0.0, 0.0, 1.0))\n    translate!(t2, (0.0, 0.0, 1.0))\n    translate!(t3, (0.0, 0.0, 1.0))\n    translate!(t4, (0.0, 0.0, 1.0))\n    ylims!(axi, -W*0.25, H + W*0.25)\nend\nfig","category":"page"},{"location":"Rectangular/rectangular/","page":"Rectangular","title":"Rectangular","text":"The arrow plots clearly show the vector nature of the electromagnetic fields.","category":"page"},{"location":"Rectangular/rectangular/","page":"Rectangular","title":"Rectangular","text":"To complete this tutorial, we demonstrate how to extract transverse field components from the numerical eigenmode solution and compare them with the analytical results.","category":"page"},{"location":"Rectangular/rectangular/","page":"Rectangular","title":"Rectangular","text":"\nfig = Figure( size = (800, 400) )\n\nfreq = 10.0e9\nmn = 4\nm, n = 1, 1\n\nmodel = GmshDiscreteModel(name, renumber = false)\n\nA_te, B_te, U_te, V_te = engeimode_gridap(model, :TE, order = 2)\nλ_te, ϕ_te = eigs(A_te, B_te; nev=nev, which=:SM, maxiter=5300)\n\nuh = FEFunction(V_te, real.(ϕ_te[:, mn]), get_dirichlet_dof_values(V_te))\n\n\nΩ_triang = get_triangulation(uh)\ngridap_coords = get_node_coordinates(Ω_triang)\nmakie_coords = map(x->Point2f(x.data), gridap_coords)\nface_to_nodes = stack(map(x->x, get_cell_node_ids(Ω_triang)))'\n\nfz_grad = evaluate(∇(uh), gridap_coords)\nkc_num = sqrt(λ_te[mn])\nβ = phase_constant(kc_num, freq, 1.0, 1.0)\nω = 2*pi*freq\nμ = 1.25663706127e-6\n\nfz_num= map(fz_grad) do grad\n    dFx, dFy = grad\n    Ht_x = (im/(kc_num^2))*(β*dFx)\n    Ht_y = (im/(kc_num^2))*(β*dFy)\n    return (Ht_x, Ht_y)\nend\nfig = Figure( size = (800, 400) )\n\nax1 = Axis(fig[1,1], title = \"Numeric solution\")\n\nfu = imag.(getindex.(fz_num, 1))\nfv = imag.(getindex.(fz_num, 2))\nft = map(x->hypot(x...), fz_num) * 55\nvm = maximum(ft)*10\nfu = fu ./ ft\nfv = fv ./ ft\n\narrows2d!(ax1, getindex.(makie_coords, 1), getindex.(makie_coords, 2), fu, fv, color = ft, colormap = :jet)\n\nt1 = lines!(ax1, [0.0, W], [0.0, 0.0], linewidth = 3.5, color = :black)\nt2 = lines!(ax1, [0.0, W], [H, H], linewidth = 3.5, color = :black)\nt3 = lines!(ax1, [0.0, 0.0], [0.0, H], linewidth = 3.5, color = :black)\nt4 = lines!(ax1, [W, W], [0.0, H], linewidth = 3.5, color = :black)\ntranslate!(t1, (0.0, 0.0, 1.0))\ntranslate!(t2, (0.0, 0.0, 1.0))\ntranslate!(t3, (0.0, 0.0, 1.0))\ntranslate!(t4, (0.0, 0.0, 1.0))\nylims!(ax1, -W*0.25, H + W*0.25)\nhidedecorations!(ax1)\n\n# Analytic solution\n\nuh_a = CellField(x-> begin\n    (ex, ey, ez, hx, hy, hz) = te_rwg_fields(x[1], x[2], W, H, m, n, freq, 1.0, 1.0) \n    return VectorValue(hx, hy)\n    end, Ω_triang)\n\n\nax2 = Axis(fig[1,2], title = \"Analytic solution\")\n\nfz_an = evaluate(uh_a, gridap_coords)\nfu_an = real.(getindex.(fz_an , 1))\nfv_an = real.(getindex.(fz_an , 2))\nft_an  = map(x->hypot(x...), fz_an ) * 55\nvm = maximum(ft_an)*10\nfu_an = fu_an ./ ft_an\nfv_an = fv_an ./ ft_an\n\narrows2d!(ax2, getindex.(makie_coords, 1), getindex.(makie_coords, 2),\n    fu_an, fv_an, color = ft_an, colormap = :jet)\n\nt1 = lines!(ax2, [0.0, W], [0.0, 0.0], linewidth = 3.5, color = :black)\nt2 = lines!(ax2, [0.0, W], [H, H], linewidth = 3.5, color = :black)\nt3 = lines!(ax2, [0.0, 0.0], [0.0, H], linewidth = 3.5, color = :black)\nt4 = lines!(ax2, [W, W], [0.0, H], linewidth = 3.5, color = :black)\ntranslate!(t1, (0.0, 0.0, 1.0))\ntranslate!(t2, (0.0, 0.0, 1.0))\ntranslate!(t3, (0.0, 0.0, 1.0))\ntranslate!(t4, (0.0, 0.0, 1.0))\nylims!(ax2, -W*0.25, H + W*0.25)\nhidedecorations!(ax2)\nfig","category":"page"},{"location":"Rectangular/rectangular/","page":"Rectangular","title":"Rectangular","text":"(Image: Image 2)","category":"page"},{"location":"Usage/#Usage-Guide","page":"Usage Guide","title":"Usage Guide","text":"","category":"section"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"This guide provides detailed information on using the AnalyticEMModes.jl package for computing electromagnetic field solutions in various geometries.","category":"page"},{"location":"Usage/#General-API-Structure","page":"Usage Guide","title":"General API Structure","text":"","category":"section"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"For each geometry, the package provides a consistent set of functions following a standardized naming convention. The general pattern replaces *** with the specific waveguide type abbreviation:","category":"page"},{"location":"Usage/#Field-Computation-Functions","page":"Usage Guide","title":"Field Computation Functions","text":"","category":"section"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"# TE mode fields (Transverse Electric: Ez = 0)\nte_***_fields(coords..., geometry_params..., mode_indices..., frequency, μᵣ, εᵣ)\n\n# TM mode fields (Transverse Magnetic: Hz = 0)\ntm_***_fields(coords..., geometry_params..., mode_indices..., frequency, μᵣ, εᵣ)\n","category":"page"},{"location":"Usage/#Cutoff-Wavenumber-Functions","page":"Usage Guide","title":"Cutoff Wavenumber Functions","text":"","category":"section"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"# Cutoff wavenumber for TE/TM modes\nkc = kc_***(geometry_params..., mode_indices..., mode_type)","category":"page"},{"location":"Usage/#Mode-Sorting-Functions","page":"Usage Guide","title":"Mode Sorting Functions","text":"","category":"section"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"# Get first N modes ordered by cutoff frequency\nmodes = first_n_modes_***(N, geometry_params...)","category":"page"},{"location":"Usage/#Coordinate-Systems-and-Parameters","page":"Usage Guide","title":"Coordinate Systems and Parameters","text":"","category":"section"},{"location":"Usage/#Rectangular-Waveguides-(rwg)","page":"Usage Guide","title":"Rectangular Waveguides (rwg)","text":"","category":"section"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"Coordinates: Cartesian (x, y)","category":"page"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"x: Position along width (0 ≤ x ≤ W)\ny: Position along height (0 ≤ y ≤ H)","category":"page"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"Geometry Parameters:","category":"page"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"W: Waveguide width (m)\nH: Waveguide height (m)","category":"page"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"Mode Indices:","category":"page"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"m: Number of half-wave variations along width\nn: Number of half-wave variations along height","category":"page"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"Functions:","category":"page"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"Ex, Ey, Ez, Hx, Hy, Hz = te_rwg_fields(x, y, W, H, m, n, f, μᵣ, εᵣ)\nEx, Ey, Ez, Hx, Hy, Hz = tm_rwg_fields(x, y, W, H, m, n, f, μᵣ, εᵣ)\nkc = kc_rwg(W, H, m, n)\nmodes = first_n_modes_rwg(N, W, H)","category":"page"},{"location":"Usage/#Circular-Waveguides-(cwg)","page":"Usage Guide","title":"Circular Waveguides (cwg)","text":"","category":"section"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"Coordinates: Cylindrical (r, θ)","category":"page"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"r: Radial distance from center (0 ≤ r ≤ R)\nθ: Azimuthal angle (radians)","category":"page"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"Geometry Parameters:","category":"page"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"R: Waveguide radius (m)","category":"page"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"Mode Indices:","category":"page"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"m: Azimuthal mode number (angular variations)\nn: Radial mode number (radial zeros)","category":"page"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"Functions:","category":"page"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"Er, Eθ, Ez, Hr, Hθ, Hz = te_cwg_fields(r, θ, R, m, n, f, μᵣ, εᵣ)\nEr, Eθ, Ez, Hr, Hθ, Hz = tm_cwg_fields(r, θ, R, m, n, f, μᵣ, εᵣ)\nkc = kc_cwg(R, m, n, mode_type)  # mode_type = :TE or :TM\nmodes = first_n_modes_cwg(N, R)","category":"page"},{"location":"Usage/#Coaxial-Waveguides-(coax)","page":"Usage Guide","title":"Coaxial Waveguides (coax)","text":"","category":"section"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"Coordinates: Cylindrical (r, θ)","category":"page"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"r: Radial distance from center (R2 ≤ r ≤ R1)\nθ: Azimuthal angle (radians)","category":"page"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"Geometry Parameters:","category":"page"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"R1: Outer conductor radius (m)\nR2: Inner conductor radius (m)","category":"page"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"Mode Indices:","category":"page"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"m: Azimuthal mode number\nn: Radial mode number","category":"page"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"Functions:","category":"page"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"Er, Eθ, Ez, Hr, Hθ, Hz = te_coax_fields(r, θ, R1, R2, m, n, f, μᵣ, εᵣ)\nEr, Eθ, Ez, Hr, Hθ, Hz = tm_coax_fields(r, θ, R1, R2, m, n, f, μᵣ, εᵣ)\nEr, Eθ, Ez, Hr, Hθ, Hz = tem_coax_fields(r, θ, R1, R2, f, μᵣ, εᵣ)\nkc = kc_coax(R1, R2, m, n, mode_type) # mode_type = :TE or :TM\nmodes = first_n_modes_coax(N, R1, R2)","category":"page"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"Special: TEM mode has no cutoff (kc = 0).","category":"page"},{"location":"Usage/#Elliptical-Waveguides-(ewg)","page":"Usage Guide","title":"Elliptical Waveguides (ewg)","text":"","category":"section"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"Coordinates: Elliptic cylindrical (ξ, η)","category":"page"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"ξ: Radial-like elliptic coordinate\nη: Angular-like elliptic coordinate","category":"page"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"Geometry Parameters:","category":"page"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"a: Semi-major axis (m)\nb: Semi-minor axis (m)","category":"page"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"Mode Indices:","category":"page"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"m: Angular Mathieu function order\nn: Radial Mathieu function order\neven: Boolean (true = even modes, false = odd modes)","category":"page"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"Functions:","category":"page"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"Eξ, Eη, Ez, Hξ, Hη, Hz = te_ewg_fields(ξ, η, a, b, m, n, even, f, μᵣ, εᵣ)\nEξ, Eη, Ez, Hξ, Hη, Hz = tm_ewg_fields(ξ, η, a, b, m, n, even, f, μᵣ, εᵣ)\nkc = kc_ewg(a, b, m, n, even, mode_type)\nmodes = first_n_modes_ewg(N, a, b)","category":"page"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"Coordinate Conversion:","category":"page"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"ξ, η = cart2elliptic(x, y, a, b)","category":"page"},{"location":"Usage/#Radial-Waveguides-(radial)","page":"Usage Guide","title":"Radial Waveguides (radial)","text":"","category":"section"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"Coordinates: Cylindrical (ρ, φ, z)","category":"page"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"ρ: Radial distance (propagation direction)\nφ: Azimuthal angle\nz: Vertical position (0 ≤ z ≤ H)","category":"page"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"Geometry Parameters:","category":"page"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"H: Height between parallel plates (m)\nm: Azimuthal mode number\nn: Vertical mode number\nρ0: Reference radial position","category":"page"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"Functions:","category":"page"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"Eρ, Eφ, Ez, Hρ, Hφ, Hz = te_radial_fields(ρ, φ, z, H, m, n, ρ0, kρ, f, μᵣ, εᵣ)\nEρ, Eφ, Ez, Hρ, Hφ, Hz = tm_radial_fields(ρ, φ, z, H, m, n, ρ0, kρ, f, μᵣ, εᵣ)","category":"page"},{"location":"Usage/#Wedge-Waveguides-(wedge)","page":"Usage Guide","title":"Wedge Waveguides (wedge)","text":"","category":"section"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"Coordinates: Cylindrical sector (ρ, φ, z)","category":"page"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"Angular extent: 0 ≤ φ ≤ φ₀","category":"page"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"Geometry Parameters:","category":"page"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"H: Height between parallel plates (m)\nφ0: Wedge angle (radians)\np: Angular mode number (quantized by φ₀)\nn: Vertical mode number","category":"page"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"Functions:","category":"page"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"Eρ, Eφ, Ez, Hρ, Hφ, Hz = te_wedge_fields(ρ, φ, z, H, φ0, p, n, kρ, ρ0, f, μᵣ, εᵣ)\nEρ, Eφ, Ez, Hρ, Hφ, Hz = tm_wedge_fields(ρ, φ, z, H, φ0, p, n, kρ, ρ0, f, μᵣ, εᵣ)","category":"page"},{"location":"Usage/#Return-Values","page":"Usage Guide","title":"Return Values","text":"","category":"section"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"Field functions return a 6-tuple of complex-valued phasor components:","category":"page"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"(E_coord1, E_coord2, E_coord3, H_coord1, H_coord2, H_coord3)","category":"page"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"The coordinate system depends on the waveguide geometry:","category":"page"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"Cartesian: (Ex, Ey, Ez, Hx, Hy, Hz)\nCylindrical: (Er, Eθ, Ez, Hr, Hθ, Hz)\nElliptic: (Eξ, Eη, Ez, Hξ, Hη, Hz)","category":"page"},{"location":"Usage/#Helper-Functions","page":"Usage Guide","title":"Helper Functions","text":"","category":"section"},{"location":"Usage/#Cutoff-Frequency-and-Propagation","page":"Usage Guide","title":"Cutoff Frequency and Propagation","text":"","category":"section"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"using AnalyticEMModes\n\n# Convert cutoff wavenumber to cutoff frequency\nfc = cutoff_frequency(kc, μᵣ, εᵣ)\n\n# Compute propagation constant\nβ = phase_constant(kc, f, μᵣ, εᵣ)\n","category":"page"},{"location":"Usage/#Coordinate-Transformations","page":"Usage Guide","title":"Coordinate Transformations","text":"","category":"section"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"# Cylindrical unit vectors and metric\nh_r, h_θ, e_r_x, e_r_y, e_θ_x, e_θ_y = metric_and_unit_cylindrical(r, θ)\n\n# Elliptic unit vectors and metric\nh, e_ξ_x, e_ξ_y, e_η_x, e_η_y = metric_and_unit_elliptic(ρ, ξ, η)\n\n# Convert field components from cylindrical to Cartesian\nFx = Fr * e_r_x + Fθ * e_θ_x\nFy = Fr * e_r_y + Fθ * e_θ_y","category":"page"},{"location":"Usage/#Mode-Sorting-and-Selection","page":"Usage Guide","title":"Mode Sorting and Selection","text":"","category":"section"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"Finding modes ordered by cutoff frequency:","category":"page"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"# Rectangular waveguide\nW, H = 0.05, 0.025\nmodes = first_n_modes_rwg(10, W, H)\nfor (mode_type, m, n, kc) in modes\n    fc = cutoff_frequency(kc, 1.0, 1.0)\n    println(\"$mode_type($m,$n): fc = $(fc/1e9) GHz\")\nend","category":"page"},{"location":"Usage/#Evaluate-Fields","page":"Usage Guide","title":"Evaluate Fields","text":"","category":"section"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"# Single point\nr, θ = 0.005, π/4\nEr, Eθ, Ez, Hr, Hθ, Hz = te_cwg_fields(r, θ, R, m, n, f, μᵣ, εᵣ)\n\n# Multiple points (vectorized)\nr_vec = range(0, R, length=100)\nθ_vec = fill(π/4, 100)\nfields = te_cwg_fields(r_vec, θ_vec, R, m, n, f, μᵣ, εᵣ)","category":"page"},{"location":"Usage/#Examples","page":"Usage Guide","title":"Examples","text":"","category":"section"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"For detailed examples with visualizations, see:","category":"page"},{"location":"Usage/","page":"Usage Guide","title":"Usage Guide","text":"Circular Waveguides\nCoaxial Waveguides\nRadial & Wedge\nRectangular Waveguides\nElliptic Waveguides","category":"page"},{"location":"theory/introduction/#Introduction","page":"Introduction","title":"Introduction","text":"","category":"section"},{"location":"theory/introduction/","page":"Introduction","title":"Introduction","text":"work in progress","category":"page"},{"location":"theory/em_solutions/#Electromagnetic-Modes-Theory","page":"Mode Theory","title":"Electromagnetic Modes Theory","text":"","category":"section"},{"location":"theory/em_solutions/#1.-What-are-Electromagnetic-Modes?","page":"Mode Theory","title":"1. What are Electromagnetic Modes?","text":"","category":"section"},{"location":"theory/em_solutions/","page":"Mode Theory","title":"Mode Theory","text":"In electromagnetic theory, many physical problems admit solutions that form distinct spatial field patterns satisfying both Maxwell's equations and specific boundary or radiation conditions.","category":"page"},{"location":"theory/em_solutions/","page":"Mode Theory","title":"Mode Theory","text":"These patterns are known as electromagnetic modes — self-consistent field configurations that can exist and evolve independently.","category":"page"},{"location":"theory/em_solutions/","page":"Mode Theory","title":"Mode Theory","text":"Mathematically, modes emerge as eigenfunctions of the vector Helmholtz equation under given constraints. Each mode is characterized by:","category":"page"},{"location":"theory/em_solutions/","page":"Mode Theory","title":"Mode Theory","text":"A unique field distribution in space\nA specific frequency characteristic (cutoff, resonant, or propagation)\nA defined propagation behavior (traveling, standing, or evanescent waves)\nOrthogonality properties allowing linear superposition without interference","category":"page"},{"location":"theory/em_solutions/#2.-Helmholtz-Equation-and-Modal-Solutions","page":"Mode Theory","title":"2. Helmholtz Equation and Modal Solutions","text":"","category":"section"},{"location":"theory/em_solutions/","page":"Mode Theory","title":"Mode Theory","text":"In source-free, linear, homogeneous regions, Maxwell’s equations can be reduced to a vector Helmholtz equation:","category":"page"},{"location":"theory/em_solutions/","page":"Mode Theory","title":"Mode Theory","text":"nabla^2 mathbfE + k^2 mathbfE = 0 quad\nnabla^2 mathbfH + k^2 mathbfH = 0","category":"page"},{"location":"theory/em_solutions/","page":"Mode Theory","title":"Mode Theory","text":"where","category":"page"},{"location":"theory/em_solutions/","page":"Mode Theory","title":"Mode Theory","text":"k = omega sqrtmu  varepsilon","category":"page"},{"location":"theory/em_solutions/","page":"Mode Theory","title":"Mode Theory","text":"is the wavenumber in the medium.","category":"page"},{"location":"theory/em_solutions/","page":"Mode Theory","title":"Mode Theory","text":"When the geometry allows separation of variables (e.g., in rectangular, circular, or other orthogonal coordinates),   each Cartesian or curvilinear component satisfies a scalar Helmholtz equation of the form:","category":"page"},{"location":"theory/em_solutions/","page":"Mode Theory","title":"Mode Theory","text":"nabla_t^2 psi + k_c^2 psi = 0","category":"page"},{"location":"theory/em_solutions/","page":"Mode Theory","title":"Mode Theory","text":"where psi is a potential function (often E_z or H_z),   and k_c is the cutoff wavenumber determined by the boundary conditions.  ","category":"page"},{"location":"theory/em_solutions/","page":"Mode Theory","title":"Mode Theory","text":"The remaining transverse field components (E_x, E_y, H_x, H_y) are then derived from psi using Maxwell’s curl relations.","category":"page"},{"location":"theory/em_solutions/#3.-Classification-of-Modes","page":"Mode Theory","title":"3. Classification of Modes","text":"","category":"section"},{"location":"theory/em_solutions/","page":"Mode Theory","title":"Mode Theory","text":"Depending on which longitudinal component is zero, three fundamental mode types exist:","category":"page"},{"location":"theory/em_solutions/","page":"Mode Theory","title":"Mode Theory","text":"Mode Type Condition Typical Example\nTE (Transverse Electric) ( E_z = 0 ) Waveguides\nTM (Transverse Magnetic) ( H_z = 0 ) Waveguides\nTEM (Transverse Electromagnetic) ( Ez = Hz = 0 ) Coaxial or parallel-plate line","category":"page"},{"location":"theory/em_solutions/","page":"Mode Theory","title":"Mode Theory","text":"TEM modes require two or more conductors (or open boundaries) to support a non-zero voltage and current pair.","category":"page"},{"location":"theory/em_solutions/","page":"Mode Theory","title":"Mode Theory","text":"These classifications reflect the physical symmetry of the problem and simplify the field representation, since only one scalar potential (either ( Hz ) or ( Ez )) needs to be solved.","category":"page"},{"location":"theory/em_solutions/","page":"Mode Theory","title":"Mode Theory","text":"Hybrid modes are electromagnetic solutions where both longitudinal field components (E_z and H_z) are non-zero, typically appearing in dielectric waveguides, inhomogeneous structures, etc. While important in many practical applications like optical fibers, hybrid modes are not the primary focus of this package, which concentrates on canonical structures with pure TE/TM analytical solutions.","category":"page"},{"location":"theory/em_solutions/#4.-Propagation-and-Cutoff","page":"Mode Theory","title":"4. Propagation and Cutoff","text":"","category":"section"},{"location":"theory/em_solutions/","page":"Mode Theory","title":"Mode Theory","text":"For a given mode, the propagation constant gamma determines the mode behavior:","category":"page"},{"location":"theory/em_solutions/","page":"Mode Theory","title":"Mode Theory","text":"gamma = sqrtk_c^2 - k^2 = begincases\njbeta = jsqrtk^2 - k_c^2  textfor  k  k_c text (propagating) \nalpha = sqrtk_c^2 - k^2  textfor  k  k_c text (evanescent)\nendcases","category":"page"},{"location":"theory/em_solutions/","page":"Mode Theory","title":"Mode Theory","text":"The cutoff frequency is defined as:","category":"page"},{"location":"theory/em_solutions/","page":"Mode Theory","title":"Mode Theory","text":"f_c = frack_c2 pi sqrtmu  varepsilon","category":"page"},{"location":"theory/em_solutions/","page":"Mode Theory","title":"Mode Theory","text":"Below cutoff, modes decay exponentially as e^-alpha z and carry no real power.","category":"page"},{"location":"theory/em_solutions/#5.-Power-Flow-and-the-Poynting-Vector","page":"Mode Theory","title":"5. Power Flow and the Poynting Vector","text":"","category":"section"},{"location":"theory/em_solutions/","page":"Mode Theory","title":"Mode Theory","text":"Once the modal electric and magnetic fields are known,   the instantaneous power density is given by the Poynting vector:","category":"page"},{"location":"theory/em_solutions/","page":"Mode Theory","title":"Mode Theory","text":"mathbfS = mathbfE times mathbfH^*","category":"page"},{"location":"theory/em_solutions/","page":"Mode Theory","title":"Mode Theory","text":"The time-averaged power flow through a surface is:","category":"page"},{"location":"theory/em_solutions/","page":"Mode Theory","title":"Mode Theory","text":"P = frac12  textRe int_S (mathbfE times mathbfH^*) cdot hatn  dS","category":"page"},{"location":"theory/em_solutions/","page":"Mode Theory","title":"Mode Theory","text":"In propagating modes, P is positive and represents transmitted energy.   In evanescent modes, P = 0: the fields store energy locally but do not transport it.","category":"page"},{"location":"theory/em_solutions/#6.-Orthogonality-and-Normalization","page":"Mode Theory","title":"6. Orthogonality and Normalization","text":"","category":"section"},{"location":"theory/em_solutions/","page":"Mode Theory","title":"Mode Theory","text":"Modal fields satisfy an orthogonality condition that makes them particulary useful in analytical and numerical analysis:","category":"page"},{"location":"theory/em_solutions/","page":"Mode Theory","title":"Mode Theory","text":"int_S (mathbfE_m times mathbfH_n^*) cdot hatmathbfn dmathbfS = 0 quad textfor quad m neq n\n\nThis means each mode can propagate independently and total fields can be expanded as a linear combination of modes\n","category":"page"},{"location":"theory/em_solutions/","page":"Mode Theory","title":"Mode Theory","text":"math mathbfE = sum_m a_m mathbfE_m quad mathbfH = sum_m a_m mathbfH_m ```","category":"page"},{"location":"theory/em_solutions/#References","page":"Mode Theory","title":"References","text":"","category":"section"},{"location":"Cylindrical/Radial/#Radial-Waveguide","page":"Radial & Wedge","title":"Radial Waveguide","text":"","category":"section"},{"location":"Cylindrical/Radial/","page":"Radial & Wedge","title":"Radial & Wedge","text":"Radial waveguides are structures that support radial wave propagation between parallel conducting plates. Unlike conventional waveguides where propagation is along the z-axis, radial guides exhibit wave propagation in the radial direction (ρ-direction). The field solutions involve Hankel functions of the radial coordinate, combined with sinusoidal variations in the azimuthal (φ) and vertical (z) directions.","category":"page"},{"location":"Cylindrical/Radial/","page":"Radial & Wedge","title":"Radial & Wedge","text":"Common examples include parallel-plate disk structures and sector-shaped geometries. For detailed mathematical derivations, see the Theory section.","category":"page"},{"location":"Cylindrical/Radial/#TE-Modes","page":"Radial & Wedge","title":"TE Modes","text":"","category":"section"},{"location":"Cylindrical/Radial/","page":"Radial & Wedge","title":"Radial & Wedge","text":"The following visualization shows the Hρ field for the first 12 TE modes, rendered on a 3D cylindrical sector:","category":"page"},{"location":"Cylindrical/Radial/","page":"Radial & Wedge","title":"Radial & Wedge","text":"\nH = 1\nR = 1\n\nname = \"../Assets/mesh/radial_wg1.msh\"\n#radialwg_mesh(H, R; dl = 0.4e-1, name = name)\n\ncoord, conn, _ = mesh_data_radial(name)\ncoords = coord[:, 1:maximum(conn)]\nxcoords = coords[1, :]\nycoords = coords[2, :]\nzcoords = coords[3, :]\nrcoords = map((x, y) -> hypot(x, y), xcoords, ycoords)\nϕcoords = map((x, y) -> atan(y, x), xcoords, ycoords)\n\nmodekind = [(0, 1), (1, 1), (2, 1), (3, 1), (0, 2), (1, 2),\n            (2, 2), (3, 2), (0, 3), (1, 3), (2, 3), (3, 3)]\n\nplot_ids = Iterators.product(1:4, 1:3) |> collect |> vec\n\nfig = Figure(size = (1200, 900))\nfor (idplot, (m, n)) in enumerate(modekind)\n    stitle = L\"TE_{%$m%$n}\"\n    ii, jj = plot_ids[idplot]\n    axi = Axis3(fig[jj,ii], title = stitle, titlesize = 20)\n    hidedecorations!(axi)\n    fields = te_radial_fields(rcoords, ϕcoords, zcoords, H, m, n, 0.0, 1.0, 100e9, 1, 1)\n    fz = getindex.(fields, 4)\n    mesh!(axi, coords, conn, color = abs.(fz), colormap = :jet, interpolate = false)\nend\nfig","category":"page"},{"location":"Cylindrical/Radial/","page":"Radial & Wedge","title":"Radial & Wedge","text":"The mode indices (m, n) determine the number of azimuthal and vertical variations, respectively. Notice how modes with m = 0 are axisymmetric, while modes with m > 0 exhibit azimuthal nodal planes.","category":"page"},{"location":"Cylindrical/Radial/#TM-Modes","page":"Radial & Wedge","title":"TM Modes","text":"","category":"section"},{"location":"Cylindrical/Radial/","page":"Radial & Wedge","title":"Radial & Wedge","text":"The following shows the Eρ field patterns for the first 12 TM modes:","category":"page"},{"location":"Cylindrical/Radial/","page":"Radial & Wedge","title":"Radial & Wedge","text":"\nfig = Figure(size = (1200, 900))\n\nmodekind = [(0, 1), (1, 1), (2, 1), (3, 1), \n            (0, 2), (1, 2), (2, 2), (3, 2), \n            (0, 3), (1, 3), (2, 3), (3, 3)]\n\nplot_ids = Iterators.product(1:4, 1:3) |> collect |> vec\nfor (idplot, (m, n)) in enumerate(modekind)\n    stitle = L\"TM_{%$m%$n}\"\n    ii, jj = plot_ids[idplot]\n    axi = Axis3(fig[jj,ii], title = stitle, titlesize = 20)\n    hidedecorations!(axi)\n    fields = tm_radial_fields(rcoords, ϕcoords, zcoords, H, m, n, 0.0, 1.0, 100e9, 1, 1)\n    fz = getindex.(fields, 1)\n    mesh!(axi, coords, conn, color = abs.(fz), colormap = :jet, interpolate = false)\nend\nfig","category":"page"},{"location":"Cylindrical/Radial/","page":"Radial & Wedge","title":"Radial & Wedge","text":"TM modes satisfy boundary conditions where Eρ = 0 at the top and bottom conducting plates (at z = 0 and z = H).","category":"page"},{"location":"Cylindrical/Radial/#Wedge-Waveguide","page":"Radial & Wedge","title":"Wedge Waveguide","text":"","category":"section"},{"location":"Cylindrical/Radial/","page":"Radial & Wedge","title":"Radial & Wedge","text":"Wedge waveguides are angular sectors bounded by two radial conducting walls at angles φ = 0 and φ = φ₀, along with top and bottom parallel plates. These structures support modes with quantized azimuthal variations determined by the wedge angle. The mode parameter m must satisfy m = nπ/φ₀ where n is an integer, ensuring proper boundary conditions at the angular walls.","category":"page"},{"location":"Cylindrical/Radial/","page":"Radial & Wedge","title":"Radial & Wedge","text":"The following visualization shows the Hz field (longitudinal magnetic component) for the first 12 TE modes in a wedge with angle φ₀ = π/3 (60 degrees):","category":"page"},{"location":"Cylindrical/Radial/","page":"Radial & Wedge","title":"Radial & Wedge","text":"\nH = 1\nR = 1\n\nname = \"../Assets/mesh/wedge_wg1.msh\"\n\nϕ0 = pi/3\n#wedgewg_mesh(H, R, ϕ0; dl = 0.3e-1, name = name)\ncoord, conn, connf = mesh_data_radial(name)\nc_ids = unique(conn)\ncoords = coord[:, c_ids]\nD = Dict(c_ids .=> eachindex(c_ids))\nnew_conn = map(x->D[x], conn)\nxcoords = coords[1, :]\nycoords = coords[2, :]\nzcoords = coords[3, :]\nrcoords = map((x, y) -> hypot(x, y), xcoords, ycoords)\nϕcoords = map((x, y) -> atan(y, x), xcoords, ycoords)\n\n\nmodekind = [(0, 1), (1, 1), (2, 1), (3, 1), \n            (0, 2), (1, 2), (2, 2), (3, 2), \n            (0, 3), (1, 3), (2, 3), (3, 3)]\n\nplot_ids = Iterators.product(1:4, 1:3) |> collect |> vec\n\nfig = Figure(size = (1200, 900))\nfor (idplot, (m, n)) in enumerate(modekind)\n    stitle = L\"TE_{%$m%$n}\"\n    ii, jj = plot_ids[idplot]\n    axi = Axis3(fig[jj,ii], title = stitle, titlesize = 20, azimuth = pi/5)\n    hidedecorations!(axi)\n    fields = te_wedge_fields(rcoords, ϕcoords, zcoords, H, ϕ0, m, n, 1.0, 0.0, 100e9, 1, 1)\n    fz = getindex.(fields, 6)\n    m1 = mesh!(axi, coord, connf, color = :gray)\n    m2 = mesh!(axi, coords, new_conn, color = abs.(fz), colormap = :jet)\nend\nfig","category":"page"},{"location":"api_reference/#API-Reference","page":"API Reference","title":"API Reference","text":"","category":"section"},{"location":"api_reference/","page":"API Reference","title":"API Reference","text":"Pages = [\"api_reference.md\"]\nDepth = 2:2","category":"page"},{"location":"api_reference/#Index","page":"API Reference","title":"Index","text":"","category":"section"},{"location":"api_reference/","page":"API Reference","title":"API Reference","text":"Pages = [\"api_reference.md\"]","category":"page"},{"location":"api_reference/#General-functions","page":"API Reference","title":"General functions","text":"","category":"section"},{"location":"api_reference/#AnalyticEMModes.wavenumber","page":"API Reference","title":"AnalyticEMModes.wavenumber","text":"wavenumber(f, μᵣ, εᵣ)\n\nComputes the wavenumber ω√(μ⋅ε).\n\nArguments\n\nf: Frequency in Hz\nμᵣ: Relative permeability\nεᵣ: Relative permittivity\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#AnalyticEMModes.phase_constant","page":"API Reference","title":"AnalyticEMModes.phase_constant","text":"phase_constant(kc, f, μᵣ, εᵣ)\n\nComputes β given the cutoff wavenumber kc.\n\nArguments\n\nkc: Cutoff wavenumber\nf: Frequency in Hz\nμᵣ: Relative permeability\nεᵣ: Relative permittivity\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#AnalyticEMModes.attenuation_factor","page":"API Reference","title":"AnalyticEMModes.attenuation_factor","text":"attenuation_factor(kc, f, μᵣ, εᵣ)\n\nComputes α, the attenuation constant of a given mode for frequencies below the cutoff.\n\nArguments\n\nkc: Cutoff wavenumber\nf: Frequency in Hz\nμᵣ: Relative permeability\nεᵣ: Relative permittivity\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#AnalyticEMModes.propagation_constant","page":"API Reference","title":"AnalyticEMModes.propagation_constant","text":"propagation_constant(kc, f, μᵣ, εᵣ)\n\nComputes γ = α + jβ given the cutoff wavenumber kc.\n\nArguments\n\nkc: Cutoff wavenumber\nf: Frequency in Hz\nμᵣ: Relative permeability\nεᵣ: Relative permittivity\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#AnalyticEMModes.cutoff_frequency","page":"API Reference","title":"AnalyticEMModes.cutoff_frequency","text":"cutoff_frequency(kc, μᵣ, εᵣ)\n\nComputes the cutoff frequency of a mode given the cutoff wavenumber kc.\n\nArguments\n\nkc: Cutoff wavenumber\nμᵣ: Relative permeability\nεᵣ: Relative permittivity\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#AnalyticEMModes.mode_wavelength","page":"API Reference","title":"AnalyticEMModes.mode_wavelength","text":"mode_wavelength(β)\n\nReturns the guided wavelength (mode wavelength) of the propagating mode given the phase constant β.\n\nArguments\n\nβ: Phase constant\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#AnalyticEMModes.mode_impedance","page":"API Reference","title":"AnalyticEMModes.mode_impedance","text":"mode_impedance(T, fcutoff, f, μᵣ, εᵣ)\n\nComputes the mode impedance of a T ∈ (:TE, :TM) mode given the cutoff frequency.\n\nArguments\n\nT: Mode type (:TE or :TM)\nfcutoff: Cutoff frequency\nf: Frequency in Hz\nμᵣ: Relative permeability\nεᵣ: Relative permittivity\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#Rectangular-waveguide","page":"API Reference","title":"Rectangular waveguide","text":"","category":"section"},{"location":"api_reference/#AnalyticEMModes.kc_rwg","page":"API Reference","title":"AnalyticEMModes.kc_rwg","text":"kc_rwg(a, b, m, n)\n\nCalculates the cutoff wave number of the m,n mode for a rectangular waveguide with dimensions a, b where a >= b.\n\nArguments\n\na: Width of the waveguide (larger dimension)\nb: Height of the waveguide (smaller dimension)\nm: Mode index in x-direction\nn: Mode index in y-direction\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#AnalyticEMModes.te_rwg_fields","page":"API Reference","title":"AnalyticEMModes.te_rwg_fields","text":"te_rwg_fields(x, y, a, b, m, n, c_e, c_h)\nte_rwg_fields(x, y, a, b, m, n, f, μᵣ, εᵣ)\n\nCalculate the electric and magnetic field components of a TE_{m,n} mode.\n\nArguments\n\nx, y: Coordinates where x ∈ [0, a] and y ∈ [0, b]\na: Width of the waveguide\nb: Height of the waveguide\nm, n: Mode indices\nc_e, c_h: Field coupling coefficients (from te_coefficients), or\nf: Frequency in Hz\nμᵣ: Relative permeability\nεᵣ: Relative permittivity\n\nReturns\n\n(Ex, Ey, Ez, Hx, Hy, Hz)\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#AnalyticEMModes.tm_rwg_fields","page":"API Reference","title":"AnalyticEMModes.tm_rwg_fields","text":"tm_rwg_fields(x, y, a, b, m, n, c_e, c_h)\ntm_rwg_fields(x, y, a, b, m, n, f, μᵣ, εᵣ)\n\nCompute the electric and magnetic field components of a TM_{m,n} mode.\n\nArguments\n\nx, y: Coordinates where x ∈ [0, a] and y ∈ [0, b]\na: Width of the waveguide\nb: Height of the waveguide\nm, n: Mode indices\nc_e, c_h: Field coupling coefficients (from tm_coefficients), or\nf: Frequency in Hz\nμᵣ: Relative permeability\nεᵣ: Relative permittivity\n\nReturns\n\n(Ex, Ey, Ez, Hx, Hy, Hz)\n\nExample\n\nc_e, c_h = tm_coefficients(kc, β, f, μᵣ, εᵣ)\ntm_rwg_fields(x, y, a, b, m, n, c_e, c_h)\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#AnalyticEMModes.te_normalization_rwg","page":"API Reference","title":"AnalyticEMModes.te_normalization_rwg","text":"te_normalization_rwg(a, b, m, n, kc, β, f, μᵣ, εᵣ)\n\nNormalization factor for TE modes to achieve unit power.\n\nThe normalization is derived from integrating the Poynting vector over the waveguide cross-section, giving the total transmitted power. In TE modes, Hₒ is normalized. δm, δn account for mode indices being 0 or non-zero.\n\nArguments\n\na: Width of the waveguide\nb: Height of the waveguide\nm, n: Mode indices\nkc: Cutoff wavenumber\nβ: Phase constant\nf: Frequency in Hz\nμᵣ: Relative permeability\nεᵣ: Relative permittivity\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#AnalyticEMModes.tm_normalization_rwg","page":"API Reference","title":"AnalyticEMModes.tm_normalization_rwg","text":"tm_normalization_rwg(a, b, m, n, kc, β, f, μᵣ, εᵣ)\n\nNormalization factor for TM modes to achieve unit power.\n\nThe normalization is derived from integrating the Poynting vector over the waveguide cross-section, giving the total transmitted power. In TM modes, Eₒ is normalized. In this case there is no δm, δn because m and n >= 1.\n\nArguments\n\na: Width of the waveguide\nb: Height of the waveguide\nm, n: Mode indices\nkc: Cutoff wavenumber\nβ: Phase constant\nf: Frequency in Hz\nμᵣ: Relative permeability\nεᵣ: Relative permittivity\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#Circular-waveguide","page":"API Reference","title":"Circular waveguide","text":"","category":"section"},{"location":"api_reference/#AnalyticEMModes.kc_cwg","page":"API Reference","title":"AnalyticEMModes.kc_cwg","text":"kc_cwg(r, m, n, T; tol = 1e-9, max_iters = 10)\n\nCalculates the cutoff wave number of the m,n mode for a circular waveguide with radius r. Uses tabulated data or asymptotic expansions of Bessel functions to calculate the zero.\n\nArguments\n\nr: Radius of the circular waveguide\nm: Azimuthal mode index\nn: Radial mode index\nT: Mode type (:TE or :TM)\ntol: Tolerance for zero-finding (default: 1e-9)\nmax_iters: Maximum iterations for Newton-Raphson (default: 10)\n\nExample\n\nkc_cwg(1.0, 2, 1, :TE)\nkc_cwg(1.0, 2, 1, :TM)\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#AnalyticEMModes.te_cwg_fields","page":"API Reference","title":"AnalyticEMModes.te_cwg_fields","text":"te_cwg_fields(r, θ, m, kc, c_e, c_h)\nte_cwg_fields(r, θ, a, m, n, f, μᵣ, εᵣ)\n\nComputes the electric and magnetic field components of a TE_{m,n} mode in a circular waveguide.\n\nArguments\n\nr: Radial coordinate\nθ: Angular coordinate\nm: Azimuthal mode index\nkc: Cutoff wavenumber, or\na: Radius of the waveguide\nn: Radial mode index\nf: Frequency in Hz\nμᵣ: Relative permeability\nεᵣ: Relative permittivity\nc_e, c_h: Field coupling coefficients (from te_coefficients)\n\nReturns\n\n(Er, Eθ, Ez, Hr, Hθ, Hz) in cylindrical coordinates centered at (0,0).\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#AnalyticEMModes.tm_cwg_fields","page":"API Reference","title":"AnalyticEMModes.tm_cwg_fields","text":"tm_cwg_fields(r, θ, m, kc, c_e, c_h)\ntm_cwg_fields(r, θ, a, m, n, f, μᵣ, εᵣ)\n\nComputes the electric and magnetic field components of a TM_{m,n} mode in a circular waveguide.\n\nArguments\n\nr: Radial coordinate\nθ: Angular coordinate\nm: Azimuthal mode index\nkc: Cutoff wavenumber, or\na: Radius of the waveguide\nn: Radial mode index\nf: Frequency in Hz\nμᵣ: Relative permeability\nεᵣ: Relative permittivity\nc_e, c_h: Field coupling coefficients (from tm_coefficients)\n\nReturns\n\n(Er, Eθ, Ez, Hr, Hθ, Hz) in cylindrical coordinates centered at (0,0).\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#AnalyticEMModes.te_normalization_cwg","page":"API Reference","title":"AnalyticEMModes.te_normalization_cwg","text":"te_normalization_cwg(a, m, kc, β, f, μᵣ, εᵣ)\n\nNormalization factor for TE modes to achieve unit power.\n\nThe expression can be derived by integrating the Poynting vector over the cross-section of the guide.\n\nArguments\n\na: Radius of the waveguide\nm: Azimuthal mode index\nkc: Cutoff wavenumber\nβ: Phase constant\nf: Frequency in Hz\nμᵣ: Relative permeability\nεᵣ: Relative permittivity\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#AnalyticEMModes.tm_normalization_cwg","page":"API Reference","title":"AnalyticEMModes.tm_normalization_cwg","text":"tm_normalization_cwg(a, m, kc, β, f, μᵣ, εᵣ)\n\nNormalization factor for TM modes to achieve unit power.\n\nThe expression can be derived by integrating the Poynting vector over the cross-section of the guide.\n\nArguments\n\na: Radius of the waveguide\nm: Azimuthal mode index\nkc: Cutoff wavenumber\nβ: Phase constant\nf: Frequency in Hz\nμᵣ: Relative permeability\nεᵣ: Relative permittivity\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#AnalyticEMModes.metric_and_unit_cylindrical","page":"API Reference","title":"AnalyticEMModes.metric_and_unit_cylindrical","text":"metric_and_unit_cylindrical(r, ϕ)\n\nComputes the metric coefficients (scale factors) and the Cartesian components of the unit vectors (êᵣ, êᵩ) for the 2D cylindrical (polar) coordinate system (r, ϕ).\n\nThis function is used for transforming differential operators (like the gradient or Laplacian) and vectors between the cylindrical and Cartesian systems.\n\nArguments\n\nr: The radial coordinate (distance from the z-axis).\nϕ: The azimuthal coordinate (angle with respect to the positive x-axis, in radians).\n\nReturns\n\nA tuple containing the six components:\n\nh_r: Metric coefficient in the radial direction . Always 1.0.\nh_ϕ: Metric coefficient in the azimuthal direction . Equal to r.\ne_r_x: X-component of the radial unit vector \ne_r_y: Y-component of the radial unit vector \ne_ϕ_x: X-component of the azimuthal unit vector \ne_ϕ_y: Y-component of the azimuthal unit vector\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#Coaxial-waveguide","page":"API Reference","title":"Coaxial waveguide","text":"","category":"section"},{"location":"api_reference/#AnalyticEMModes.kc_coax","page":"API Reference","title":"AnalyticEMModes.kc_coax","text":"kc_coax(a, b, m, n, T)\n\nCompute the cutoff wave number for a coaxial waveguide.\n\nArguments\n\na: Outer radius\nb: Inner radius\nm: Azimuthal mode index\nn: Radial mode index\nT: Mode type (:TE, :TM, or :TEM)\n\nNote\n\nFor TEM mode, returns 0.0 (no cutoff).\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#AnalyticEMModes.te_coax_fields","page":"API Reference","title":"AnalyticEMModes.te_coax_fields","text":"te_coax_fields(r, θ, Am, Bm, m, kc, c_e, c_h)\nte_coax_fields(r, θ, a, b, m, n, f, μᵣ, εᵣ)\n\nArguments\n\nr: r polar coordinate.\nθ: angle in polar coordinates.\nAm: First value returned by coax_boundary_coeff_te. Is always 1.0\nBm: Second value retuened by coax_boundary_coeff_te.\nm:  The azimuthal mode number.\nn: radial mode number.\nkc: cutoff wavenumber.\nc_e: imωμ/kc^2\nc_h: -im*β/kc^2\na: outer radius.\nb: inner radius\nf: frequency.\nμᵣ: relative permeability\nεᵣ: relative permittivity\n\nReturns\n\n(Er, Eθ, Ez, Hr, Hθ, Hz)\n\nCalculate the electric and magnetic field components in polar coordinates of a TE_{m,n} mode given the dimensions of the circular section with radius r.  It is assumed that the center of the circular section is at (0,0).\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#AnalyticEMModes.tm_coax_fields","page":"API Reference","title":"AnalyticEMModes.tm_coax_fields","text":"tm_coax_fields(r, θ, Am, Bm, m, kc, c_e, c_h)\n\nArguments\n\nr: r polar coordinate.\nθ: angle in polar coordinates.\nAm: First value returned by coax_boundary_coeff_te. Is always 1.0\nBm: Second value retuened by coax_boundary_coeff_te.\nm:  The azimuthal mode number.\nn: radial mode number.\nkc: cutoff wavenumber.\nc_e: imωμ/kc^2\nc_h: -im*β/kc^2\na: outer radius.\nb: inner radius\nf: frequency.\nμᵣ: relative permeability\nεᵣ: relative permittivity\n\nReturns\n\n(Er, Eθ, Ez, Hr, Hθ, Hz)\n\nCalculate the electric and magnetic field components in polar coordinates of a TM_{m,n} mode given the dimensions of the circular section with radius r.  It is assumed that the center of the circular section is at (0,0).\n\n\n\n\n\ntm_coax_fields(r, θ, a, b, m, n, f, μᵣ, εᵣ)\n\nArguments\n\nr: r polar coordinate.\nθ: angle in polar coordinates.\na: outer radius.\nb: inner radius\nm: azimuthal mode number.\nn: radial mode number.\nf: frequency.\nμᵣ: relative permeability\nεᵣ: relative permittivity\n\nReturns\n\n(Er, Eθ, Ez, Hr, Hθ, Hz)\n\nCalculate the electric and magnetic field components in polar coordinates of a TM_{m,n} mode given the dimensions of the circular section with radius r.  It is assumed that the center of the circular section is at (0,0).\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#AnalyticEMModes.tem_coax_fields","page":"API Reference","title":"AnalyticEMModes.tem_coax_fields","text":"tem_coax_fields(r, a, b, μᵣ, εᵣ)\n\nCalculate the electric and magnetic field components of the TEM mode in a coaxial waveguide.\n\nArguments\n\nr: Radial coordinate\na: Outer radius\nb: Inner radius\nμᵣ: Relative permeability\nεᵣ: Relative permittivity\n\nReturns\n\n(Er, Eθ, Ez, Hr, Hθ, Hz)\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#AnalyticEMModes.te_normalization_coax","page":"API Reference","title":"AnalyticEMModes.te_normalization_coax","text":"te_normalization_coax(a, b, m, kc, β, f, μᵣ, εᵣ)\n\nNormalization factor for TE modes to achieve unit power.\n\nThe expression can be derived by integrating the Poynting vector over the cross-section of the guide.\n\nArguments\n\na: Outer radius\nb: Inner radius\nm: Azimuthal mode index\nkc: Cutoff wavenumber\nβ: Phase constant\nf: Frequency in Hz\nμᵣ: Relative permeability\nεᵣ: Relative permittivity\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#AnalyticEMModes.tm_normalization_coax","page":"API Reference","title":"AnalyticEMModes.tm_normalization_coax","text":"tm_normalization_coax(a, b, m, kc, β, f, μᵣ, εᵣ)\n\nNormalization factor for TM modes to achieve unit power.\n\nThe expression can be derived by integrating the Poynting vector over the cross-section of the guide.\n\nArguments\n\na: Outer radius\nb: Inner radius\nm: Azimuthal mode index\nkc: Cutoff wavenumber\nβ: Phase constant\nf: Frequency in Hz\nμᵣ: Relative permeability\nεᵣ: Relative permittivity\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#AnalyticEMModes.characteristic_coax_equation_te","page":"API Reference","title":"AnalyticEMModes.characteristic_coax_equation_te","text":"characteristic_coax_equation_te(m, kc, a, b)\n\nThe zeros of this function correspond to the cutoff wave number of the TE modes.\n\nArguments\n\nm: Azimuthal mode index\nkc: Cutoff wavenumber\na: Outer radius\nb: Inner radius\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#AnalyticEMModes.characteristic_coax_equation_tm","page":"API Reference","title":"AnalyticEMModes.characteristic_coax_equation_tm","text":"characteristic_coax_equation_tm(m, kc, a, b)\n\nThe zeros of this function correspond to the cutoff wave number of the TM modes.\n\nArguments\n\nm: Azimuthal mode index\nkc: Cutoff wavenumber\na: Outer radius\nb: Inner radius\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#Radial-waveguide","page":"API Reference","title":"Radial waveguide","text":"","category":"section"},{"location":"api_reference/#AnalyticEMModes.kc_radial","page":"API Reference","title":"AnalyticEMModes.kc_radial","text":"kc_radial(βz, f, μᵣ, εᵣ)\n\nComputes the radial propagation constant kᵨ (analogous to kc in other geometries) for a radial waveguide.\n\nArguments\n\nβz: Axial phase constant\nf: Frequency in Hz\nμᵣ: Relative permeability\nεᵣ: Relative permittivity\n\nReference\n\nAdvanced engineering electromagnetics by Constatine A. Balanis. Chapter 9.5.1\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#AnalyticEMModes.phase_constant_radial","page":"API Reference","title":"AnalyticEMModes.phase_constant_radial","text":"phase_constant_radial(h, n)\n\nPhase constant (βᶻ) of the axial component of the wavenumber in a radial waveguide.\n\nThis constant arises from the PEC boundary conditions imposed at z = 0 and z = h, which constrain the field variation along the axial direction as:\n\nEρ(0 <= ρ <= ∞, 0 <= ϕ <= 2π, z = 0) = Eρ(0 <= ρ <= ∞, 0 <= ϕ <= 2π, z = h) = 0 Eϕ(0 <= ρ <= ∞, 0 <= ϕ <= 2π, z = 0) = Eϕ(0 <= ρ <= ∞, 0 <= ϕ <= 2π, z = h) = 0\n\nArguments\n\nh: Height of the radial waveguide\nn: Axial mode index\n\nReference\n\nAdvanced engineering electromagnetics by Constatine A. Balanis. Chapter 9.5.1\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#AnalyticEMModes.cutoff_frequency_radial","page":"API Reference","title":"AnalyticEMModes.cutoff_frequency_radial","text":"cutoff_frequency_radial(βz, μᵣ, εᵣ)\n\nLike cutoff_frequency(kc, μᵣ, εᵣ) but using βz instead of kc for the particular case of the radial waveguide.\n\nArguments\n\nβz: Axial phase constant\nμᵣ: Relative permeability\nεᵣ: Relative permittivity\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#AnalyticEMModes.te_radial_fields","page":"API Reference","title":"AnalyticEMModes.te_radial_fields","text":"te_radial_fields(r, ϕ, z, m, Amn, Bmn, kc, β, c_e, c_h)\nte_radial_fields(r, ϕ, z, h, m, n, Amn, Bmn, f, μᵣ, εᵣ)\n\nCompute the electric and magnetic field components of a TE_{m,n} mode in a radial waveguide.\n\nArguments\n\nr: Radial coordinate\nϕ: Angular coordinate\nz: Axial coordinate where z ∈ [0, h]\nm: Azimuthal mode index\nAmn, Bmn: Wave amplitudes (outgoing/incoming)\nkc: Radial propagation constant, or\nh: Height of the waveguide\nn: Axial mode index\nf: Frequency in Hz\nμᵣ: Relative permeability\nεᵣ: Relative permittivity\nβ: Axial phase constant\nc_e, c_h: Field coupling coefficients\n\nReturns\n\n(Er, Eϕ, Ez, Hr, Hϕ, Hz)\n\nNotes\n\nOutgoing: Amn = 1, Bmn = 0; Incoming: Amn = 0, Bmn = 1\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#AnalyticEMModes.tm_radial_fields","page":"API Reference","title":"AnalyticEMModes.tm_radial_fields","text":"tm_radial_fields(r, ϕ, z, m, Amn, Bmn, kc, β, c_e, c_h)\ntm_radial_fields(r, ϕ, z, h, m, n, Amn, Bmn, f,  μᵣ, εᵣ )\n\nCompute the electric and magnetic field components of a TM_{m,n} mode given the dimensions radial waveguide. It is assumed that the radial section is centered at (0, 0, z) with height z ∈ [0, h].\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#AnalyticEMModes.te_zw","page":"API Reference","title":"AnalyticEMModes.te_zw","text":"te_zw(m, r, kc, Amn, Bmn, f, μᵣ)\n\nImpedance of the wave in the ρ direction for a TE mode.\n\nArguments\n\nm: Azimuthal mode index\nr: Radial coordinate\nkc: Radial propagation constant\nAmn, Bmn: Wave amplitudes\nf: Frequency in Hz\nμᵣ: Relative permeability\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#AnalyticEMModes.tm_zw","page":"API Reference","title":"AnalyticEMModes.tm_zw","text":"tm_zw(m, r, kc, Amn, Bmn, f, μᵣ)\n\nImpedance of the wave in the ρ direction for a TM mode.\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#AnalyticEMModes.te_normalization_radial","page":"API Reference","title":"AnalyticEMModes.te_normalization_radial","text":"te_normalization_radial(r, h, m, Amn, Bmn, kc, f, μᵣ, εᵣ)\n\nNormalization factor for TE modes to achieve unit power.\n\nThe expression can be derived by integrating the Poynting vector over the cross-section of the guide.\n\nArguments\n\nr: Radial coordinate\nh: Height of the waveguide\nm: Azimuthal mode index\nAmn, Bmn: Wave amplitudes\nkc: Radial propagation constant\nf: Frequency in Hz\nμᵣ: Relative permeability\nεᵣ: Relative permittivity\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#AnalyticEMModes.tm_normalization_radial","page":"API Reference","title":"AnalyticEMModes.tm_normalization_radial","text":"tm_normalization_radial(r, h, m, Amn, Bmn, kc, f, μᵣ, εᵣ)\n\nNormalization factor for TM modes to achieve unit power.\n\nThe expression can be derived by integrating the Poynting vector over the cross-section of the guide.\n\nArguments\n\nr: Radial coordinate\nh: Height of the waveguide\nm: Azimuthal mode index\nAmn, Bmn: Wave amplitudes\nkc: Radial propagation constant\nf: Frequency in Hz\nμᵣ: Relative permeability\nεᵣ: Relative permittivity\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#Wedge-waveguide","page":"API Reference","title":"Wedge waveguide","text":"","category":"section"},{"location":"api_reference/#AnalyticEMModes.kc_wedge","page":"API Reference","title":"AnalyticEMModes.kc_wedge","text":"kc_wedge(βz, f, μᵣ, εᵣ)\n\nComputes the radial propagation constant for a wedge waveguide (same as kc_radial).\n\nArguments\n\nβz: Axial phase constant\nf: Frequency in Hz\nμᵣ: Relative permeability\nεᵣ: Relative permittivity\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#AnalyticEMModes.te_wedge_fields","page":"API Reference","title":"AnalyticEMModes.te_wedge_fields","text":"te_wedge_fields(r, ϕ, z, ϕ0, p, Amn, Bmn, kc, β, c_e, c_h)\nte_wedge_fields(r, ϕ, z, h, ϕ0, p, n, Amn, Bmn, f, μᵣ, εᵣ)\n\nCompute the electric and magnetic field components of a TE_{p,n} mode in a wedge waveguide.\n\nArguments\n\nr: Radial coordinate\nϕ: Angular coordinate where ϕ ∈ [0, ϕ0]\nz: Axial coordinate where z ∈ [0, h]\nϕ0: Wedge angle\np: Angular mode index\nAmn, Bmn: Wave amplitudes\nkc: Radial propagation constant, or\nh: Height of the waveguide\nn: Axial mode index\nf: Frequency in Hz\nμᵣ: Relative permeability\nεᵣ: Relative permittivity\nβ: Axial phase constant\nc_e, c_h: Field coupling coefficients\n\nReturns\n\n(Er, Eϕ, Ez, Hr, Hϕ, Hz)\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#AnalyticEMModes.tm_wedge_fields","page":"API Reference","title":"AnalyticEMModes.tm_wedge_fields","text":"tm_wedge_fields(r, ϕ, z, ϕ0, p, Amn, Bmn, kc, β, c_e, c_h)\ntm_wedge_fields(r, ϕ, z, h, ϕ0, p, n, Amn, Bmn, f, μᵣ, εᵣ)\n\nCompute the electric and magnetic field components of a TM_{p,n} mode in a wedge waveguide.\n\nArguments\n\nr: Radial coordinate\nϕ: Angular coordinate where ϕ ∈ [0, ϕ0]\nz: Axial coordinate where z ∈ [0, h]\nϕ0: Wedge angle\np: Angular mode index\nAmn, Bmn: Wave amplitudes\nkc: Radial propagation constant, or\nh: Height of the waveguide\nn: Axial mode index\nf: Frequency in Hz\nμᵣ: Relative permeability\nεᵣ: Relative permittivity\nβ: Axial phase constant\nc_e, c_h: Field coupling coefficients\n\nReturns\n\n(Er, Eϕ, Ez, Hr, Hϕ, Hz)\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#AnalyticEMModes.te_normalization_wedge","page":"API Reference","title":"AnalyticEMModes.te_normalization_wedge","text":"te_normalization_wedge(r, h, ϕ0, p, Amn, Bmn, kc, f, μᵣ, εᵣ)\n\nNormalization factor for TE modes to achieve unit power.\n\nThe expression can be derived by integrating the Poynting vector over the cross-section of the guide.\n\nArguments\n\nr: Radial coordinate\nh: Height of the waveguide\nϕ0: Wedge angle\np: Angular mode index\nAmn, Bmn: Wave amplitudes\nkc: Radial propagation constant\nf: Frequency in Hz\nμᵣ: Relative permeability\nεᵣ: Relative permittivity\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#AnalyticEMModes.tm_normalization_wedge","page":"API Reference","title":"AnalyticEMModes.tm_normalization_wedge","text":"tm_normalization_wedge(r, h, ϕ0, p, Amn, Bmn, kc, f, μᵣ, εᵣ)\n\nNormalization factor for TM modes to achieve unit power.\n\nThe expression can be derived by integrating the Poynting vector over the cross-section of the guide.\n\nArguments\n\nr: Radial coordinate\nh: Height of the waveguide\nϕ0: Wedge angle\np: Angular mode index\nAmn, Bmn: Wave amplitudes\nkc: Radial propagation constant\nf: Frequency in Hz\nμᵣ: Relative permeability\nεᵣ: Relative permittivity\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#Elliptical-waveguide","page":"API Reference","title":"Elliptical waveguide","text":"","category":"section"},{"location":"api_reference/#AnalyticEMModes.kc_ewg","page":"API Reference","title":"AnalyticEMModes.kc_ewg","text":"kc_ewg(a, b, m, n, even, T)\n\nComputes the cutoff wavenumber k_c for the (m, n)-th mode in an elliptical waveguide (EWG).\n\nThis function determines the characteristic values of the Mathieu functions corresponding to the given mode symmetry (even) and type (T = :TE or :TM).   The cutoff wavenumber is derived from the eigenvalues qₘₙ obtained by locating the zeros of the appropriate Mathieu function or its derivative.\n\nArguments\n\na, b: Semi-major and semi-minor axes of the ellipse.  \nm, n: Mode indices.  \neven::Bool: Whether the mode is even (true) or odd (false).  \nT::Symbol: Mode type. Either :TE or :TM.\n\nReturns\n\nkc::Float64: Cutoff wavenumber for the specified mode.\n\nNotes\n\nFor TM modes, the zeros of the Mathieu functions Ceₘ or Seₘ are used.\nFor TE modes, the zeros of their derivatives Ceₘ′ or Seₘ′ are used.\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#AnalyticEMModes.te_ewg_fields","page":"API Reference","title":"AnalyticEMModes.te_ewg_fields","text":"te_ewg_fields(ξ, η, ρ, m, even, coeff, q, c_e, c_h)\nte_ewg_fields(ξ, η, a, b, m, n, even, f, μᵣ, εᵣ)\n\nComputes the electric and magnetic field components of a TE_{c/s,m,n} mode in an elliptical waveguide.\n\nArguments\n\nξ: Radial elliptical coordinate\nη: Angular elliptical coordinate\nρ: Focal distance √(a²-b²), or\na: Semi-major axis\nb: Semi-minor axis\nm: Mode order\nn: Radial mode index (used with a, b)\neven: true for even modes (c), false for odd modes (s)\ncoeff: Mathieu function coefficients\nq: Parameter q = (kc*ρ)²/4\nf: Frequency in Hz\nμᵣ: Relative permeability\nεᵣ: Relative permittivity\nc_e, c_h: Field coupling coefficients\n\nReturns\n\n(Eξ, Eη, Ez, Hξ, Hη, Hz) in elliptical coordinates centered at (0,0).\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#AnalyticEMModes.tm_ewg_fields","page":"API Reference","title":"AnalyticEMModes.tm_ewg_fields","text":"tm_ewg_fields(ξ, η, ρ, m, even, coeff, q, c_e, c_h)\ntm_ewg_fields(ξ, η, a, b, m, n, even, f, μᵣ, εᵣ)\n\nComputes the electric and magnetic field components of a TM_{c/s,m,n} mode in an elliptical waveguide.\n\nArguments\n\nξ: Radial elliptical coordinate\nη: Angular elliptical coordinate\nρ: Focal distance √(a²-b²), or\na: Semi-major axis\nb: Semi-minor axis\nm: Mode order\nn: Radial mode index (used with a, b)\neven: true for even modes (c), false for odd modes (s)\ncoeff: Mathieu function coefficients\nq: Parameter q = (kc*ρ)²/4\nf: Frequency in Hz\nμᵣ: Relative permeability\nεᵣ: Relative permittivity\nc_e, c_h: Field coupling coefficients\n\nReturns\n\n(Eξ, Eη, Ez, Hξ, Hη, Hz) in elliptical coordinates centered at (0,0).\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#AnalyticEMModes.cart2elliptic","page":"API Reference","title":"AnalyticEMModes.cart2elliptic","text":"cart2elliptic(x, y, a, b)\n\nTransform from cartesian coordinates to elliptic coordinates.\n\nArguments\n\nx, y: Cartesian coordinates\na: Semi-major axis of the ellipse\nb: Semi-minor axis of the ellipse\n\nReturns\n\n(ξ, η) elliptic coordinates\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#AnalyticEMModes.metric_and_unit_elliptic","page":"API Reference","title":"AnalyticEMModes.metric_and_unit_elliptic","text":"metric_and_unit_elliptic(ρ, ξ, η)\n\nComputes the metric factor and unit vectors for the 2D elliptic coordinate system.\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#AnalyticEMModes.ce_m","page":"API Reference","title":"AnalyticEMModes.ce_m","text":"ce_m(m, q, z)\n\nEven angular Mathieu function of order m with parameter q evaluated at z and its derivative.\n\nArguments\n\nm: Order of the Mathieu function\nq: Parameter related to the geometry (q = (kc*ρ)²/4)\nz: Coordinate (typically η)\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#AnalyticEMModes.se_m","page":"API Reference","title":"AnalyticEMModes.se_m","text":"se_m(m, q, z)\n\nOdd angular Mathieu function of order m with parameter q evaluated at z and its derivative.\n\nArguments\n\nm: Order of the Mathieu function\nq: Parameter related to the geometry (q = (kc*ρ)²/4)\nz: Coordinate (typically η)\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#AnalyticEMModes.Ce_m","page":"API Reference","title":"AnalyticEMModes.Ce_m","text":"Ce_m(m, q, z)\n\nEven Radial Mathieu function and its derivative. It's equivalent to the Modified Mathieu Function of first kind of order m with parameter q evaluated at z.\n\nArguments\n\nm: Order of the Mathieu function\nq: Parameter related to the geometry (q = (kc*ρ)²/4)\nz: Coordinate (typically ξ)\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#AnalyticEMModes.Se_m","page":"API Reference","title":"AnalyticEMModes.Se_m","text":"Se_m(m, q, z)\n\nOdd Radial Mathieu function and its derivative. It's equivalent to the Modified Mathieu Function of first kind of order m with parameter q evaluated at z.\n\nArguments\n\nm: Order of the Mathieu function\nq: Parameter related to the geometry (q = (kc*ρ)²/4)\nz: Coordinate (typically ξ)\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#Sort-Modes","page":"API Reference","title":"Sort Modes","text":"","category":"section"},{"location":"api_reference/#AnalyticEMModes.first_n_modes_rwg","page":"API Reference","title":"AnalyticEMModes.first_n_modes_rwg","text":"first_n_modes_rwg(N, a, b)\n\nReturns the first N modes for a rectangular waveguide with width a and height b.\n\nReturns\n\nA vector of tuples (kind, m, n, kc) where:\n\nkind: Mode type (:TE or :TM)\nm, n: Mode indices (number of half-wavelength variations in x and y directions)\nkc: Cutoff wavenumber\n\nMode restrictions\n\nTE modes: m + n > 0 (at least one index must be non-zero)\nTM modes: m ≥ 1 and n ≥ 1 (both indices must be positive)\n\nThe dominant mode is TE₁₀ (or TE₀₁ if b > a).\n\nPerformance\n\nThis implementation uses a heap-based algorithm and is much faster than brute-force sorting over all possible (m,n) combinations, especially for large N.\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#AnalyticEMModes.first_n_modes_cwg","page":"API Reference","title":"AnalyticEMModes.first_n_modes_cwg","text":"first_n_modes_cwg(N, r)\n\nReturns the first N modes for a circular waveguide of radius r.\n\nReturns\n\nA vector of (kind, m, n, kc) where:\n\nkind: Mode type (:TE, :TM, :TEc, :TEs, :TMc, :TMs)\nm, n: Mode indices\nkc: Cutoff wavenumber\n\nMode notation\n\nFor m > 0, there are two degenerate polarizations with the same cutoff frequency:\n\n:TEc, :TMc: Cosine modes (cos(mθ) variation)\n:TEs, :TMs: Sine modes (sin(mθ) variation)\n\nFor m = 0, only :TE and :TM are returned (no polarization degeneracy).\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#AnalyticEMModes.first_n_modes_coax","page":"API Reference","title":"AnalyticEMModes.first_n_modes_coax","text":"first_n_modes_coax(N, r1, r2)\n\nReturns the first N modes for a coaxial waveguide with inner radius r2 and outer radius r1.\n\nReturns\n\nA vector of(kind, m, n, kc) where:\n\nkind: Mode type (:TEM, :TE, :TM, :TEc, :TEs, :TMc, :TMs)\nm, n: Mode indices\nkc: Cutoff wavenumber\n\nMode notation\n\nThe TEM mode (:TEM) has zero cutoff frequency and is the dominant mode.\n\nFor m > 0, there are two degenerate polarizations with the same cutoff frequency:\n\n:TEc, :TMc: Cosine modes (cos(mθ) variation)\n:TEs, :TMs: Sine modes (sin(mθ) variation)\n\nFor m = 0, only :TE and :TM are returned (no polarization degeneracy).\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#AnalyticEMModes.first_n_modes_radial","page":"API Reference","title":"AnalyticEMModes.first_n_modes_radial","text":"first_n_modes_radial(N, h)\n\nReturns the first N modes for a radial waveguide with height h between parallel plates.\n\nReturns\n\nA vector of (kind, m, n, kc) where:\n\nkind: Mode type (:TEM, :TE, :TM)\nm: Azimuthal mode index\nn: Vertical mode index\nkc: Cutoff wavenumber (radial propagation constant)\n\nNote\n\nThe TEM mode (m=0, n=0) has zero cutoff frequency and corresponds to radial propagation between parallel plates.\n\n\n\n\n\n","category":"function"},{"location":"api_reference/#AnalyticEMModes.first_n_modes_ewg","page":"API Reference","title":"AnalyticEMModes.first_n_modes_ewg","text":"first_n_modes_ewg(N, a, b)\n\nReturns the first N modes for an elliptic waveguide with semi-major axis a and semi-minor axis b.\n\nReturns\n\nA vector of (kind, m, n, kc) where:\n\nkind: Mode type (:TEe, :TEo, :TMe, :TMo)\nm, n: Mode indices\nkc: Cutoff wavenumber\n\nMode notation\n\nUnlike circular or coaxial waveguides, elliptic waveguides have even and odd modes that are not degenerate (they have different cutoff frequencies):\n\n:TEe, :TMe: Even modes (using even Mathieu functions, cosine-elliptic)\n:TEo, :TMo: Odd modes (using odd Mathieu functions, sine-elliptic)\n\nFor m = 0, only even modes exist (:TEe, :TMe). For m > 0, both even and odd modes exist with different cutoff frequencies.\n\n\n\n\n\n","category":"function"},{"location":"theory/theory_cylindrical/#Cylindrical-Coordinate-System","page":"Cylindrical Coordinate System","title":"Cylindrical Coordinate System","text":"","category":"section"},{"location":"theory/theory_cylindrical/#Metric-and-Coordinate-Description","page":"Cylindrical Coordinate System","title":"Metric and Coordinate Description","text":"","category":"section"},{"location":"theory/theory_cylindrical/","page":"Cylindrical Coordinate System","title":"Cylindrical Coordinate System","text":"The cylindrical coordinate system (r theta z) is characterized by the metric:","category":"page"},{"location":"theory/theory_cylindrical/","page":"Cylindrical Coordinate System","title":"Cylindrical Coordinate System","text":"ds^2 = dr^2 + r^2 dtheta^2 + dz^2","category":"page"},{"location":"theory/theory_cylindrical/","page":"Cylindrical Coordinate System","title":"Cylindrical Coordinate System","text":"with scale factors:","category":"page"},{"location":"theory/theory_cylindrical/","page":"Cylindrical Coordinate System","title":"Cylindrical Coordinate System","text":"h_r = 1 quad h_theta = r quad h_z = 1","category":"page"},{"location":"theory/theory_cylindrical/#Scalar-Helmholtz-Equation","page":"Cylindrical Coordinate System","title":"Scalar Helmholtz Equation","text":"","category":"section"},{"location":"theory/theory_cylindrical/","page":"Cylindrical Coordinate System","title":"Cylindrical Coordinate System","text":"The scalar Helmholtz equation in cylindrical coordinates:","category":"page"},{"location":"theory/theory_cylindrical/","page":"Cylindrical Coordinate System","title":"Cylindrical Coordinate System","text":"frac1rfracpartialpartial rleft(rfracpartial psipartial rright) + frac1r^2fracpartial^2 psipartial theta^2 + fracpartial^2 psipartial z^2 + k^2 psi = 0","category":"page"},{"location":"theory/theory_cylindrical/#Separation-of-Variables-and-Bessel-Functions","page":"Cylindrical Coordinate System","title":"Separation of Variables and Bessel Functions","text":"","category":"section"},{"location":"theory/theory_cylindrical/","page":"Cylindrical Coordinate System","title":"Cylindrical Coordinate System","text":"Assuming a solution of the form psi(r theta z) = R(r)Theta(theta)Z(z), we obtain:","category":"page"},{"location":"theory/theory_cylindrical/","page":"Cylindrical Coordinate System","title":"Cylindrical Coordinate System","text":"frac1rRfracddrleft(rfracdRdrright) + frac1r^2Thetafracd^2Thetadtheta^2 + frac1Zfracd^2Zdz^2 + k^2 = 0","category":"page"},{"location":"theory/theory_cylindrical/","page":"Cylindrical Coordinate System","title":"Cylindrical Coordinate System","text":"This leads to the separation equations:","category":"page"},{"location":"theory/theory_cylindrical/","page":"Cylindrical Coordinate System","title":"Cylindrical Coordinate System","text":"Angular equation:","category":"page"},{"location":"theory/theory_cylindrical/","page":"Cylindrical Coordinate System","title":"Cylindrical Coordinate System","text":"fracd^2Thetadtheta^2 + m^2 Theta = 0 quad Rightarrow quad Theta(theta) = e^pm j mtheta","category":"page"},{"location":"theory/theory_cylindrical/","page":"Cylindrical Coordinate System","title":"Cylindrical Coordinate System","text":"where m = 0 1 2 dots for single-valuedness.","category":"page"},{"location":"theory/theory_cylindrical/","page":"Cylindrical Coordinate System","title":"Cylindrical Coordinate System","text":"Radial equation (Bessel's equation):","category":"page"},{"location":"theory/theory_cylindrical/","page":"Cylindrical Coordinate System","title":"Cylindrical Coordinate System","text":"r^2 fracd^2Rdr^2 + r fracdRdr + (k_c^2 r^2 - m^2)R = 0","category":"page"},{"location":"theory/theory_cylindrical/","page":"Cylindrical Coordinate System","title":"Cylindrical Coordinate System","text":"where k_c^2 = k^2 + gamma^2.","category":"page"},{"location":"theory/theory_cylindrical/","page":"Cylindrical Coordinate System","title":"Cylindrical Coordinate System","text":"The solutions are Bessel functions:","category":"page"},{"location":"theory/theory_cylindrical/","page":"Cylindrical Coordinate System","title":"Cylindrical Coordinate System","text":"R(r) = A J_m(k_c r) + B Y_m(k_c r)","category":"page"},{"location":"theory/theory_cylindrical/","page":"Cylindrical Coordinate System","title":"Cylindrical Coordinate System","text":"J_m(k_c r)\n: Bessel function of first kind (finite at r=0)\nY_m(k_c r)\n: Bessel function of second kind (singular at r=0)","category":"page"},{"location":"theory/theory_cylindrical/#Potential-Functions-and-Field-Relations","page":"Cylindrical Coordinate System","title":"Potential Functions and Field Relations","text":"","category":"section"},{"location":"theory/theory_cylindrical/#TM-Modes-(E-modes)-Electric-Vector-Potential","page":"Cylindrical Coordinate System","title":"TM Modes (E-modes) - Electric Vector Potential","text":"","category":"section"},{"location":"theory/theory_cylindrical/","page":"Cylindrical Coordinate System","title":"Cylindrical Coordinate System","text":"Let mathbfF = mathbfhatz F_z(r theta)e^-gamma z, where F_z satisfies:","category":"page"},{"location":"theory/theory_cylindrical/","page":"Cylindrical Coordinate System","title":"Cylindrical Coordinate System","text":"nabla_t^2 F_z + k_c^2 F_z = 0","category":"page"},{"location":"theory/theory_cylindrical/","page":"Cylindrical Coordinate System","title":"Cylindrical Coordinate System","text":"The field components are:","category":"page"},{"location":"theory/theory_cylindrical/","page":"Cylindrical Coordinate System","title":"Cylindrical Coordinate System","text":"E_r = -frac1epsilon frac1r fracpartial F_zpartial theta quad\nE_theta = frac1epsilon fracpartial F_zpartial r quad\nE_z = 0","category":"page"},{"location":"theory/theory_cylindrical/","page":"Cylindrical Coordinate System","title":"Cylindrical Coordinate System","text":"H_r = -fracgammajomegamuepsilon fracpartial F_zpartial r quad\nH_theta = -fracgammajomegamuepsilon frac1r fracpartial F_zpartial theta quad\nH_z = frack_c^2jomegamuepsilon F_z","category":"page"},{"location":"theory/coordinate/#Introduction-to-Orthogonal-Coordinate-Systems","page":"Coordinate Systems","title":"Introduction to Orthogonal Coordinate Systems","text":"","category":"section"},{"location":"theory/coordinate/#Mathematical-Foundation","page":"Coordinate Systems","title":"Mathematical Foundation","text":"","category":"section"},{"location":"theory/coordinate/","page":"Coordinate Systems","title":"Coordinate Systems","text":"Analytic electromagnetic solutions rely on orthogonal coordinate systems where the vector Helmholtz equation is separable. In such systems, the wave equation admits solutions through the method of separation of variables.","category":"page"},{"location":"theory/coordinate/#General-Formulation","page":"Coordinate Systems","title":"General Formulation","text":"","category":"section"},{"location":"theory/coordinate/","page":"Coordinate Systems","title":"Coordinate Systems","text":"For any orthogonal coordinate system (u_1 u_2 u_3) with scale factors (h_1 h_2 h_3), the differential operators take the form:","category":"page"},{"location":"theory/coordinate/#Gradient","page":"Coordinate Systems","title":"Gradient","text":"","category":"section"},{"location":"theory/coordinate/","page":"Coordinate Systems","title":"Coordinate Systems","text":"nabla psi = frac1h_1 fracpartial psipartial u_1 mathbfhatu_1 + \nfrac1h_2 fracpartial psipartial u_2 mathbfhatu_2 + \nfrac1h_3 fracpartial psipartial u_3 mathbfhatu_3","category":"page"},{"location":"theory/coordinate/#Divergence","page":"Coordinate Systems","title":"Divergence","text":"","category":"section"},{"location":"theory/coordinate/","page":"Coordinate Systems","title":"Coordinate Systems","text":"nabla cdot mathbfA = frac1h_1 h_2 h_3 left\nfracpartialpartial u_1 (h_2 h_3 A_1) +\nfracpartialpartial u_2 (h_3 h_1 A_2) +\nfracpartialpartial u_3 (h_1 h_2 A_3)\nright","category":"page"},{"location":"theory/coordinate/#Curl","page":"Coordinate Systems","title":"Curl","text":"","category":"section"},{"location":"theory/coordinate/","page":"Coordinate Systems","title":"Coordinate Systems","text":"nabla times mathbfA = frac1h_1 h_2 h_3 beginvmatrix\nh_1 mathbfhatu_1  h_2 mathbfhatu_2  h_3 mathbfhatu_3 \nfracpartialpartial u_1  fracpartialpartial u_2  fracpartialpartial u_3 \nh_1 A_1  h_2 A_2  h_3 A_3\nendvmatrix","category":"page"},{"location":"theory/coordinate/#Laplacian","page":"Coordinate Systems","title":"Laplacian","text":"","category":"section"},{"location":"theory/coordinate/","page":"Coordinate Systems","title":"Coordinate Systems","text":"nabla^2 psi = frac1h_1 h_2 h_3 left \nfracpartialpartial u_1 left( frach_2 h_3h_1 fracpartial psipartial u_1 right) +\nfracpartialpartial u_2 left( frach_3 h_1h_2 fracpartial psipartial u_2 right) +\nfracpartialpartial u_3 left( frach_1 h_2h_3 fracpartial psipartial u_3 right)\nright","category":"page"},{"location":"theory/coordinate/","page":"Coordinate Systems","title":"Coordinate Systems","text":"The vector Helmholtz equation for electromagnetic fields:","category":"page"},{"location":"theory/coordinate/","page":"Coordinate Systems","title":"Coordinate Systems","text":"nabla^2 mathbfE + k^2 mathbfE = 0 quad nabla^2 mathbfH + k^2 mathbfH = 0","category":"page"},{"location":"theory/coordinate/","page":"Coordinate Systems","title":"Coordinate Systems","text":"can be solved by assuming separable solutions of the form:","category":"page"},{"location":"theory/coordinate/","page":"Coordinate Systems","title":"Coordinate Systems","text":"psi(u_1 u_2 u_3) = U_1(u_1) U_2(u_2) U_3(u_3)","category":"page"},{"location":"theory/coordinate/#Coordinate-Systems-implemented","page":"Coordinate Systems","title":"Coordinate Systems implemented","text":"","category":"section"},{"location":"theory/coordinate/","page":"Coordinate Systems","title":"Coordinate Systems","text":"This package supports solutions in the following orthogonal coordinate systems:","category":"page"},{"location":"theory/coordinate/","page":"Coordinate Systems","title":"Coordinate Systems","text":"Cartesian: (x y z) - for rectangular geometries\nCylindrical: (r theta z) - for circular, coaxial, and wedge geometries\nElliptical: (xi eta z) - for elliptical waveguides\nSpherical: (r theta phi) - for spherical radiators","category":"page"},{"location":"theory/coordinate/","page":"Coordinate Systems","title":"Coordinate Systems","text":"Each coordinate system is particularly suited for specific geometries where boundary conditions align naturally with constant coordinate surfaces.","category":"page"},{"location":"theory/coordinate/#Reference","page":"Coordinate Systems","title":"Reference","text":"","category":"section"},{"location":"theory/coordinate/","page":"Coordinate Systems","title":"Coordinate Systems","text":"Stratton, J. A. (1941). Electromagnetic Theory, Chapter 1. McGraw-Hill.","category":"page"},{"location":"theory/theory_rectangular/#Cartesian-Coordinate-System","page":"Rectangular","title":"Cartesian Coordinate System","text":"","category":"section"},{"location":"theory/theory_rectangular/#Metric-and-Coordinate-Description","page":"Rectangular","title":"Metric and Coordinate Description","text":"","category":"section"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"The Cartesian coordinate system (x y z) is characterized by the metric:","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"ds^2 = dx^2 + dy^2 + dz^2","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"with scale factors:","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"h_x = 1 quad h_y = 1 quad h_z = 1","category":"page"},{"location":"theory/theory_rectangular/#Scalar-Helmholtz-Equation","page":"Rectangular","title":"Scalar Helmholtz Equation","text":"","category":"section"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"The scalar Helmholtz equation in Cartesian coordinates:","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"fracpartial^2 psipartial x^2 + fracpartial^2 psipartial y^2 + fracpartial^2 psipartial z^2 + k^2 psi = 0","category":"page"},{"location":"theory/theory_rectangular/#Separation-of-Variables","page":"Rectangular","title":"Separation of Variables","text":"","category":"section"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"Assuming a solution of the form psi(x y z) = X(x)Y(y)Z(z), we obtain:","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"frac1Xfracd^2Xdx^2 + frac1Yfracd^2Ydy^2 + frac1Zfracd^2Zdz^2 + k^2 = 0","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"This leads to the separation equations:","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"fracd^2Xdx^2 + k_x^2 X = 0 quad\nfracd^2Ydy^2 + k_y^2 Y = 0 quad\nfracd^2Zdz^2 + k_z^2 Z = 0","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"with the constraint:","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"k_x^2 + k_y^2 + k_z^2 = k^2","category":"page"},{"location":"theory/theory_rectangular/#Potential-Functions-and-Field-Solutions","page":"Rectangular","title":"Potential Functions and Field Solutions","text":"","category":"section"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"We define vector potentials:","category":"page"},{"location":"theory/theory_rectangular/#TM-Modes-Electric-Vector-Potential","page":"Rectangular","title":"TM Modes - Electric Vector Potential","text":"","category":"section"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"Let (mathbfF = mathbfhatz F_z(x y)e^-gamma z), where (F_z) satisfies:","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"nabla_t^2 F_z + k_c^2 F_z = 0","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"with (k_c^2 = k_x^2 + k_y^2).","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"The field components are:","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"E_x = -frac1epsilon fracpartial F_zpartial y quad\nE_y = frac1epsilon fracpartial F_zpartial x quad\nE_z = 0","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"H_x = -frac1jomegamuepsilon fracpartial^2 F_zpartial x partial z quad\nH_y = -frac1jomegamuepsilon fracpartial^2 F_zpartial y partial z quad\nH_z = frac1jomegamuepsilon (k^2 + fracpartial^2partial z^2) F_z","category":"page"},{"location":"theory/theory_rectangular/#TE-Modes-Magnetic-Vector-Potential","page":"Rectangular","title":"TE Modes - Magnetic Vector Potential","text":"","category":"section"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"Let (mathbfA = mathbfhatz A_z(x y)e^-gamma z), where (A_z) satisfies:","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"nabla_t^2 A_z + k_c^2 A_z = 0","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"The field components are:","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"E_x = -frac1jomegamuepsilon fracpartial^2 A_zpartial x partial z quad\nE_y = -frac1jomegamuepsilon fracpartial^2 A_zpartial y partial z quad\nE_z = frac1jomegamuepsilon (k^2 + fracpartial^2partial z^2) A_z","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"H_x = frac1mu fracpartial A_zpartial y quad\nH_y = -frac1mu fracpartial A_zpartial x quad\nH_z = 0","category":"page"},{"location":"theory/theory_rectangular/#Rectangular-Waveguide-Solutions","page":"Rectangular","title":"Rectangular Waveguide Solutions","text":"","category":"section"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"For a rectangular waveguide with PEC walls at (x = 0, a) and (y = 0, b), the general solution to the Helmholtz equation is:","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"psi(x y) = Acos(k_x x) + Bsin(k_x x) cdot Ccos(k_y y) + Dsin(k_y y)","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"Applying the PEC boundary conditions:","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"TM modes: Require (psi = 0) on all boundaries, leading to sine functions in both directions\nTE modes: Require normal derivatives vanishing on boundaries, leading to cosine functions","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"This yields the well-known modal solutions:","category":"page"},{"location":"theory/theory_rectangular/#TM-Modes","page":"Rectangular","title":"TM Modes","text":"","category":"section"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"F_z(x y) = sinleft(fracmpi xaright) sinleft(fracnpi ybright) quad m n = 1 2 3 dots","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"Cutoff wavenumber:","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"k_c = sqrtleft(fracmpiaright)^2 + left(fracnpibright)^2","category":"page"},{"location":"theory/theory_rectangular/#TE-Modes","page":"Rectangular","title":"TE Modes","text":"","category":"section"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"A_z(x y) = cosleft(fracmpi xaright) cosleft(fracnpi ybright) quad m n = 0 1 2 dots","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"but not m = n = 0.","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"Cutoff wavenumber:","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"k_c = sqrtleft(fracmpiaright)^2 + left(fracnpibright)^2","category":"page"},{"location":"theory/theory_rectangular/#Power-Normalization","page":"Rectangular","title":"Power Normalization","text":"","category":"section"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"The normalization constant is derived from the power flow condition:","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"P = frac12 textRe int_0^a int_0^b (mathbfE times mathbfH^*) cdot mathbfhatz  dx dy = 1 text Watt","category":"page"},{"location":"theory/theory_rectangular/#For-TE-Modes","page":"Rectangular","title":"For TE Modes","text":"","category":"section"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"Using the field components (with the factors implemented in the package):","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"\tE_x = F_0 fracomegamuk_c^2fracmxasin left(fracmxaright) cosleft(fracnybright) quad\n\tE_y = -F_0 fracomegamuk_c^2fracnybepsilon F_0 cosleft(fracmxaright)sinleft(fracnybright)","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"\tH_x = -F_0 fracbetak_c^2fracnybepsilon F_0 cosleft(fracmxaright)sinleft(fracnybright) quad\n\tH_y = F_0 fracbetak_c^2fracmxasin left(fracmxaright) cosleft(fracnybright)","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"The z-component of the Poynting vector is:","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"S_z = frac12 (E_x H_y^* - E_y H_x^*)","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"Substituting and simplifying:","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"S_z = frac12 fracbeta F_0^2 omega muk_c^4 leftk_y^2 sin^2(k_y y)cos^2(k_x x) + k_x^2 cos^2(k_y y)sin^2(k_x x)right","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"The power is","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"P_z = int_0^aint_0^b frac12 fracbeta F_0^2 omega muk_c^4 leftk_y^2 sin^2(k_y y)cos^2(k_x x) + k_x^2 cos^2(k_y y)sin^2(k_x x)right","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"Integrating over the cross-section and using the orthogonality of trigonometric functions:","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"int_0^a sin^2(k_x x) dx = fraca2 quad int_0^a cos^2(k_x x) dx = fraca2","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"int_0^b cos^2(k_y y) dy = fracb2 quad int_0^b sin^2(k_y y) dy = fracb2","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"Defining:","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"delta_m = begincases 1  textif  n geq 1  2  textif  n = 0 endcases quad\ndelta_n = begincases 1  textif  m geq 1  2  textif  m = 0 endcases","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"We get:","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"P_z = frac12 fracbeta F_0^2 omega muk_c^4 left( int_0^aint_0^b k_y^2 sin^2(k_y y)cos^2(k_x x) +  int_0^aint_0^b k_x^2 cos^2(k_y y)sin^2(k_x x) right)","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"P_z = frac12 fracbeta F_0^2 omega muk_c^4 left( delta_m k_y^2fracab4 +  delta_n k_x^2 fracab4right) = = frac12 fracbeta F_0^2 omega muk_c^4 left( delta_m fracn^2pi^2b^2 fracab4 + delta_n fracm^2pi^2a^2fracab4 right)","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"P_z = frac12 fracbeta F_0^2 omega mu pi^24k_c^4 left( delta_m n^2 fracab +  delta_n m^2fracba right)","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"Setting P = 1 and solving for F_0:","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"F_0 = sqrtfrac8k_c^4beta omega mu pi^2 left( delta_m n^2 fracab +  delta_n m^2fracba right)","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"For TM modes:","category":"page"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"F_0 = sqrtfrac8k_c^4beta omega varepsilon pi^2 left( delta_m n^2 fracab +  delta_n m^2fracba right)","category":"page"},{"location":"theory/theory_rectangular/#References","page":"Rectangular","title":"References","text":"","category":"section"},{"location":"theory/theory_rectangular/","page":"Rectangular","title":"Rectangular","text":"Harrington, R. F. (1961). Time-Harmonic Electromagnetic Fields, Chapter 3.   Stratton, J. A. (1941). Electromagnetic Theory, Chapter 5.   Balanis, C. A. (2012). Advanced Engineering Electromagnetics, Chapter 8.","category":"page"},{"location":"Elliptic/elliptic/#Elliptic-Waveguide","page":"Elliptic","title":"Elliptic Waveguide","text":"","category":"section"},{"location":"Elliptic/elliptic/","page":"Elliptic","title":"Elliptic","text":"Elliptic waveguides are less common than the rectangular and circular geometries. Like other waveguide types, they support both TE and TM modes. Their distinctive characteristic is that they admit even and odd solution pairs formed using even and odd Mathieu functions. Consequently, except for m = 0, each mode designation (m, n) corresponds to two distinct modes with different cutoff frequencies.","category":"page"},{"location":"Elliptic/elliptic/#Numerical-Example","page":"Elliptic","title":"Numerical Example","text":"","category":"section"},{"location":"Elliptic/elliptic/","page":"Elliptic","title":"Elliptic","text":"As in previous sections, we first present numerical solutions obtained with Gridap.jl to serve as validation references for the analytical expressions.","category":"page"},{"location":"Elliptic/elliptic/","page":"Elliptic","title":"Elliptic","text":"Mesh files (.msh) can be found in \\src\\Assets\\mesh and are generated with Gmsh.jl using functions in \\src\\Assets\\example_mesh.jl.","category":"page"},{"location":"Elliptic/elliptic/","page":"Elliptic","title":"Elliptic","text":"The Hz field (longitudinal magnetic component) for the first TE modes computed numerically:","category":"page"},{"location":"Elliptic/elliptic/","page":"Elliptic","title":"Elliptic","text":"\nusing GLMakie\n\nname = \"../Assets/mesh/elliptic_wg1.msh\"\na = 1\nb = 0.7\nellipticwg_mesh(a, b; dl = 0.05, name)\nmodel = GmshDiscreteModel(name, renumber = false)\n\n\nA_te, B_te, U_te, V_te = engeimode_gridap(model, :TE, order = 2)\nA_tm, B_tm, U_tm, V_tm = engeimode_gridap(model, :TM, order = 2)\n\nnev = 24\nλ_te, ϕ_te = eigs(A_te, B_te; nev=nev, which=:SM, maxiter=5300)\nλ_tm, ϕ_tm = eigs(A_tm, B_tm; nev=nev, which=:SM, maxiter=5300)\n\n\nt = range(0, 2*pi, length=100)\nellip_x_r = @. b * sin(t)\nellip_y_r = @. a * cos(t)\n\ntria = Triangulation(model)\ngridap_coords = get_node_coordinates(model)\nmakie_coords = map(x->Point2f(x.data), gridap_coords)\nface_to_nodes = stack(map(x->x, get_cell_node_ids(model)))'\n\nfig = Figure(size = (1300, 910))\nplot_ids = Iterators.product(1:5, 1:4) |> collect |> vec\nfor (idp, (ii, jj)) in enumerate(plot_ids)\n    uh = FEFunction(V_te, real.(ϕ_te[:, idp+1]), get_dirichlet_dof_values(V_te))\n    gridap_values = evaluate(uh, gridap_coords)\n    fz_num = abs.(gridap_values)\n    fz_num = fz_num / maximum(fz_num)\n    coord2 = makie_coords[argmin(fz_num)]\n    axi = Axis(fig[jj,ii])\n    t = lines!(axi, ellip_y_r, ellip_x_r, linewidth = 3.5, color = :black)\n    translate!(t, (0, 0, 2))\n    xlims!(-a*1.1, a*1.1)\n    ylims!(-a, a)\n    mesh!(axi, makie_coords, face_to_nodes, color = fz_num, colormap = :jet)\n    hidedecorations!(axi)\nend\nLabel(fig[0, 2:4], \"Numeric TE Modes\", fontsize = 20)\nfig","category":"page"},{"location":"Elliptic/elliptic/","page":"Elliptic","title":"Elliptic","text":"(Image: Image 5)","category":"page"},{"location":"Elliptic/elliptic/","page":"Elliptic","title":"Elliptic","text":"The numerical eigenmode solution reveals the complex field patterns characteristic of elliptic geometries. ","category":"page"},{"location":"Elliptic/elliptic/","page":"Elliptic","title":"Elliptic","text":"The Ez field (longitudinal electric component) for the first TM modes:","category":"page"},{"location":"Elliptic/elliptic/","page":"Elliptic","title":"Elliptic","text":"fig = Figure(size = (1300, 910))\nplot_ids = Iterators.product(1:5, 1:4) |> collect |> vec\nfor (idp, (ii, jj)) in enumerate(plot_ids)\n    uh = FEFunction(V_tm, real.(ϕ_tm[:, idp]), get_dirichlet_dof_values(V_tm))\n    gridap_values = evaluate(uh, gridap_coords)\n    fz_num = abs.(gridap_values)\n    fz_num = fz_num / maximum(fz_num)\n    coord2 = makie_coords[argmin(fz_num)]\n    axi = Axis(fig[jj,ii])\n    t = lines!(axi, ellip_y_r, ellip_x_r, linewidth = 3.5, color = :black)\n    translate!(t, (0, 0, 2))\n    xlims!(-a*1.1, a*1.1)\n    ylims!(-a, a)\n    mesh!(axi, makie_coords, face_to_nodes, color = fz_num, colormap = :jet)\n    hidedecorations!(axi)\nend\nLabel(fig[0, 2:4], \"Numeric TM Modes\", fontsize = 20)\nfig","category":"page"},{"location":"Elliptic/elliptic/","page":"Elliptic","title":"Elliptic","text":"(Image: Image 6)","category":"page"},{"location":"Elliptic/elliptic/","page":"Elliptic","title":"Elliptic","text":"TM modes in elliptical waveguides exhibit similar complexity, with field patterns governed by the interplay of Mathieu functions in both coordinate directions.","category":"page"},{"location":"Elliptic/elliptic/#Analytical-Solutions","page":"Elliptic","title":"Analytical Solutions","text":"","category":"section"},{"location":"Elliptic/elliptic/","page":"Elliptic","title":"Elliptic","text":"The analytical evaluation of elliptic waveguide modes uses Mathieu functions, which are more computationally intensive than Bessel or trigonometric functions. The field solutions require evaluating both angular Mathieu functions (ceₘ, seₘ for even/odd) and radial Mathieu functions (Ceₘ, Seₘ). To improve computational efficiency, the Mathieu function coefficients can be pre-computed outside the field evaluation calls.","category":"page"},{"location":"Elliptic/elliptic/","page":"Elliptic","title":"Elliptic","text":"The following code evaluates the analytical TE mode fields using te_ewg_fields. The parameter even determines whether even (true) or odd (false) Mathieu functions are used, corresponding to different mode symmetries and cutoff frequencies.","category":"page"},{"location":"Elliptic/elliptic/","page":"Elliptic","title":"Elliptic","text":"\nusing GLMakie\n\nname = \"../Assets/mesh/elliptic_wg1.msh\"\na = 1\nb = 0.7\n#ellipticwg_mesh(a, b; dl = 0.05, name)\n\ncoord, conn = mesh_data(name)\ncoords = coord[:, 1:maximum(conn)]\nxcoords = coords[1, :]\nycoords = coords[2, :]\n\nellipcoords = map((x, y) -> cart2elliptic(x, y, a, b), xcoords, ycoords)\nξcoords = getindex.(ellipcoords, 1)\nηcoords = getindex.(ellipcoords, 2)\n\nt = range(0, 2*pi, length=100)\nellip_x_r = @. b * sin(t)\nellip_y_r = @. a * cos(t)\n\nmodekind = [(1, 1, true), (1, 1, false), (2, 1, true), (2, 1, false), (3, 1, true), \n            (3, 1, false), (0, 1, true), (4, 1, true), (4, 1, false),  (1, 2, true), (1, 2, false), \n            (5, 1, true), (5, 1, false), (2, 2, true), (2, 2, false), (6, 1, true), (6, 1, false), \n            (3, 2, true), (0, 2, true), (3, 2, false)]\n\nplot_ids = Iterators.product(1:5, 1:4) |> collect |> vec\n\nfig = Figure(size = (1300, 910))   \nfor (idplot, (m, n, even)) in enumerate(modekind)\n    ii,jj = plot_ids[idplot]\n\n    fields = te_ewg_fields(ξcoords, ηcoords, a, b, m, n, even, 100e9, 1.0, 1.0)\n    fz = getindex.(fields, 6)\n\n    stitle = even ? L\"TE_{c%$m%$n}\" : L\"TE_{e%$m%$n}\"\n    axi = Axis(fig[jj,ii], title = stitle, titlesize = 20)\n    hidedecorations!(axi)\n\n    t = lines!(axi, ellip_y_r, ellip_x_r, linewidth = 3.5, color = :black)\n        translate!(t, (0, 0, 2))\n\n    mesh!(axi, coords, conn, color = abs.(fz), colormap = :jet)\n    xlims!(-a*1.1, a*1.1)\n    ylims!(-a, a)\nend\nfig","category":"page"},{"location":"Elliptic/elliptic/","page":"Elliptic","title":"Elliptic","text":"The visualization shows 20 TE modes with labels indicating even (c) or odd (e) character. Note that for m > 0, both even and odd modes exist with different cutoff frequencies and patterns.","category":"page"},{"location":"Elliptic/elliptic/","page":"Elliptic","title":"Elliptic","text":"TM modes for the same elliptic geometry:","category":"page"},{"location":"Elliptic/elliptic/","page":"Elliptic","title":"Elliptic","text":"\n     \nmodekind = [(0, 1, true),(1, 1, true),(1, 1, false),(2, 1, true),(2, 1, false),(3, 1, true),\n            (0, 2, true),(3, 1, false),(1, 2, true),(4, 1, true),(4, 1, false),(1, 2, false),\n            (2, 2, true),(5, 1, true),(5, 1, false),(2, 2, false),(3, 2, true),(6, 1, true),\n            (6, 1, false),(0, 3, true)]\n\nfig = Figure(size = (1300, 910))\nfor (idplot, (m, n, even)) in enumerate(modekind)\n    ii,jj = plot_ids[idplot]\n\n    fields = tm_ewg_fields(ξcoords, ηcoords, a, b, m, n, even, 100e9, 1.0, 1.0)\n    fz = getindex.(fields, 3)\n\n    stitle = even ? L\"TM_{c%$m%$n}\" : L\"TM_{e%$m%$n}\"\n    axi = Axis(fig[jj,ii], title = stitle, titlesize = 20)\n    hidedecorations!(axi)\n\n    t = lines!(axi, ellip_y_r, ellip_x_r, linewidth = 3.5, color = :black)\n    translate!(t, (0, 0, 2))\n\n    mesh!(axi, coords, conn, color = abs.(fz), colormap = :jet)\n    xlims!(-a*1.1, a*1.1)\n    ylims!(-a, a)\nend\nfig","category":"page"},{"location":"Elliptic/elliptic/","page":"Elliptic","title":"Elliptic","text":"The even/odd distinction is clearly visible in the field symmetries.","category":"page"},{"location":"Elliptic/elliptic/#Transverse-Field-Components","page":"Elliptic","title":"Transverse Field Components","text":"","category":"section"},{"location":"Elliptic/elliptic/","page":"Elliptic","title":"Elliptic","text":"For elliptic coordinates, the transverse field components require coordinate transformation from the native elliptic system (ξ, η) to Cartesian coordinates (x, y). The metric_and_unit_elliptic function provides the necessary metric coefficients and unit vector components for this transformation.","category":"page"},{"location":"Elliptic/elliptic/","page":"Elliptic","title":"Elliptic","text":"The following example visualizes the transverse magnetic field for selected TM modes:","category":"page"},{"location":"Elliptic/elliptic/","page":"Elliptic","title":"Elliptic","text":"\nρ = sqrt(a^2-b^2)\n\nmodekind = [(0, 1, true),(1, 1, true),(1, 1, false),(2, 1, true),(2, 1, false),(3, 1, true)]\nplot_ids = Iterators.product(1:3, 1:2) |> collect |> vec\n\nfig = Figure(size = (1300, 910))\nfor (idplot, (m, n, even)) in enumerate(modekind)\n    ii,jj = plot_ids[idplot]\n  \n    fields = tm_ewg_fields(ξcoords, ηcoords, a, b, m, n, even, 100e9, 1.0, 1.0)\n\n    fz = map(fields, ξcoords, ηcoords) do ehfields, ξi, ηi\n        h, exi_x, exi_y, eeta_x, eeta_y = metric_and_unit_elliptic(ρ, ξi, ηi)\n        Fx = ehfields[4] * exi_x + ehfields[5] * eeta_x\n        Fy = ehfields[4] * exi_y + ehfields[5] * eeta_y\n        return (Fx, Fy)\n    end\n\n    stitle = even ? L\"TM_{c%$m%$n}\" : L\"TM_{e%$m%$n}\"\n    axi = Axis(fig[jj,ii], title = stitle, titlesize = 20)\n    hidedecorations!(axi)\n\n    t = lines!(axi, ellip_y_r, ellip_x_r, linewidth = 3.5, color = :black)\n        translate!(t, (0, 0, 2))\n\n    fu = real.(getindex.(fz, 1))\n    fv = real.(getindex.(fz, 2))\n    ft = map(x->hypot(x...), fz) * 35\n    vm = maximum(ft)*10\n    fu = fu ./ ft\n    fv = fv ./ ft\n\n    arrows2d!(axi, xcoords, ycoords, fu, fv, color = ft, colormap = :jet)\n\n    xlims!(-a*1.1, a*1.1)\n    ylims!(-a, a)\nend\nfig","category":"page"},{"location":"#AnalyticEMModes.jl","page":"AnalyticEMModes.jl","title":"AnalyticEMModes.jl","text":"","category":"section"},{"location":"","page":"AnalyticEMModes.jl","title":"AnalyticEMModes.jl","text":"AnalyticEMModes.jl is a Julia package for computing analytical electromagnetic field solutions for canonical boundary value problems in various geometries (such as waveguides, spherical modes, or radial propagation). All bounded geometries assume perfect electric conductor (PEC) boundary conditions.","category":"page"},{"location":"#Installation","page":"AnalyticEMModes.jl","title":"Installation","text":"","category":"section"},{"location":"","page":"AnalyticEMModes.jl","title":"AnalyticEMModes.jl","text":"From the Julia REPL:","category":"page"},{"location":"","page":"AnalyticEMModes.jl","title":"AnalyticEMModes.jl","text":"using Pkg\nPkg.add(url=\"https://github.com/uvegege/AnalyticEMModes.jl\")","category":"page"},{"location":"","page":"AnalyticEMModes.jl","title":"AnalyticEMModes.jl","text":"Or in package mode (type ]):","category":"page"},{"location":"","page":"AnalyticEMModes.jl","title":"AnalyticEMModes.jl","text":"pkg> add https://github.com/uvegege/AnalyticEMModes.jl","category":"page"},{"location":"#Overview","page":"AnalyticEMModes.jl","title":"Overview","text":"","category":"section"},{"location":"","page":"AnalyticEMModes.jl","title":"AnalyticEMModes.jl","text":"This package provides closed-form solutions for electric and magnetic field distributions in waveguides, enabling fast and accurate computation of mode patterns, cutoff frequencies, and propagation characteristics. Unlike numerical methods (FEM, FDTD), analytical solutions offer:","category":"page"},{"location":"","page":"AnalyticEMModes.jl","title":"AnalyticEMModes.jl","text":"Exact results (within numerical precision of special function evaluation)\nPhysical insight through explicit functional forms\nBenchmarking for validating numerical solvers\nIntegration with numerical methods, e.g. using analytical modes to excite ports, impose boundary conditions, etc.","category":"page"},{"location":"#Supported-Geometries","page":"AnalyticEMModes.jl","title":"Supported Geometries","text":"","category":"section"},{"location":"","page":"AnalyticEMModes.jl","title":"AnalyticEMModes.jl","text":"Waveguide Type Alias Coordinate System Power Normalization\nRectangular rwg (x, y) Yes\nCircular cwg (r, θ) Yes\nCoaxial coax (r, θ) Yes\nRadial radial (ρ, φ, z) Yes\nWedge wedge (ρ, φ, z) Yes\nElliptical ewg (ξ, η) No\nSpherical — (r, θ, φ) Under development","category":"page"},{"location":"#Features","page":"AnalyticEMModes.jl","title":"Features","text":"","category":"section"},{"location":"","page":"AnalyticEMModes.jl","title":"AnalyticEMModes.jl","text":"Field Components: Complete 6-component electromagnetic field vectors (Er, Eθ, Ez, Hr, Hθ, Hz)\nCutoff Analysis: Cutoff wavenumbers, frequencies, and wavelengths\nPropagation Parameters: Phase constant, attenuation, impedance\nMode Sorting: Efficient algorithms to find first N modes ordered by cutoff frequency\nCoordinate Transformations: Conversion between Cartesian and curvilinear coordinates\nHigh Accuracy: Uses Bessels.jl for reliable special function evaluation","category":"page"},{"location":"#Quick-Start","page":"AnalyticEMModes.jl","title":"Quick Start","text":"","category":"section"},{"location":"#Example-1:-TE-Mode-in-Circular-Waveguide","page":"AnalyticEMModes.jl","title":"Example 1: TE₁₁ Mode in Circular Waveguide","text":"","category":"section"},{"location":"","page":"AnalyticEMModes.jl","title":"AnalyticEMModes.jl","text":"using AnalyticEMModes\n\n# Waveguide parameters\na = 0.01         # Radius in meters\nm, n = 1, 1      # Mode indices (TE₁₁)\nf = 10e9         # Frequency in Hz\nμᵣ, εᵣ = 1.0, 1.0  # Relative permeability and permittivity\n\n# Compute cutoff frequency\nkc = kc_cwg(a, m, n, :TE)\nfc = cutoff_frequency(kc, μᵣ, εᵣ)\nprintln(\"TE₁₁ cutoff frequency: $(fc/1e9) GHz\")\n\n# Evaluate fields at point (r, θ)\nr, θ = 0.005, π/4\nEr, Eθ, Ez, Hr, Hθ, Hz = te_cwg_fields(r, θ, a, m, n, f, μᵣ, εᵣ)\n\nprintln(\"Magnetic field Hz: $Hz\")","category":"page"},{"location":"#Example-2:-Finding-First-N-Modes","page":"AnalyticEMModes.jl","title":"Example 2: Finding First N Modes","text":"","category":"section"},{"location":"","page":"AnalyticEMModes.jl","title":"AnalyticEMModes.jl","text":"using AnalyticEMModes\n\n# Find first 10 modes in rectangular waveguide\na, b = 0.02286, 0.01016  # WR-90 dimensions (m)\nmodes = first_n_modes_rwg(10, a, b)\nfor (i, (kind, m, n, kc)) in enumerate(modes)\n    fc = cutoff_frequency(kc, 1.0, 1.0)\n    println(\"Mode $i: $kind($m,$n), fc = $(fc/1e9) GHz\")\nend","category":"page"},{"location":"#Documentation-Structure","page":"AnalyticEMModes.jl","title":"Documentation Structure","text":"","category":"section"},{"location":"","page":"AnalyticEMModes.jl","title":"AnalyticEMModes.jl","text":"This documentation is organized as follows:","category":"page"},{"location":"#User-Guide","page":"AnalyticEMModes.jl","title":"User Guide","text":"","category":"section"},{"location":"","page":"AnalyticEMModes.jl","title":"AnalyticEMModes.jl","text":"Usage: Detailed function reference and conventions\nExamples: Gallery of mode visualizations and comparisons","category":"page"},{"location":"#Examples-by-Geometry","page":"AnalyticEMModes.jl","title":"Examples by Geometry","text":"","category":"section"},{"location":"","page":"AnalyticEMModes.jl","title":"AnalyticEMModes.jl","text":"Circular Waveguides: TE and TM modes in circular guides\nCoaxial Waveguides: Including TEM mode\nRadial & Wedge: Radial propagation geometries\nRectangular Waveguides: Standard rectangular guides\nElliptic Waveguides: Mathieu function solutions","category":"page"},{"location":"#Theory-(Recommended-Reading)","page":"AnalyticEMModes.jl","title":"Theory (Recommended Reading)","text":"","category":"section"},{"location":"","page":"AnalyticEMModes.jl","title":"AnalyticEMModes.jl","text":"For users interested in the mathematical foundations:","category":"page"},{"location":"","page":"AnalyticEMModes.jl","title":"AnalyticEMModes.jl","text":"Coordinate systems and transformations\nPotential formulations (Hertzian potentials)\nBoundary value problems and separation of variables\nSpecial functions (Bessel, Mathieu)\nReferences to classic textbooks","category":"page"},{"location":"#API-Conventions","page":"AnalyticEMModes.jl","title":"API Conventions","text":"","category":"section"},{"location":"#Naming-Conventions","page":"AnalyticEMModes.jl","title":"Naming Conventions","text":"","category":"section"},{"location":"","page":"AnalyticEMModes.jl","title":"AnalyticEMModes.jl","text":"Functions use lowercase with underscores: te_cwg_fields, kc_rwg\nMode types are symbols: :TE, :TM, :TEM\nCoordinate parameters follow physics notation: r, θ, z for cylindrical","category":"page"},{"location":"#Return-Values","page":"AnalyticEMModes.jl","title":"Return Values","text":"","category":"section"},{"location":"","page":"AnalyticEMModes.jl","title":"AnalyticEMModes.jl","text":"Field functions return 6-tuple: (Er, Eθ, Ez, Hr, Hθ, Hz) or (Ex, Ey, Ez, Hx, Hy, Hz)\nAll fields are complex-valued (phasor notation)\nUnits follow SI: meters, Hz, A/m, V/m","category":"page"},{"location":"#Mode-Indexing","page":"AnalyticEMModes.jl","title":"Mode Indexing","text":"","category":"section"},{"location":"","page":"AnalyticEMModes.jl","title":"AnalyticEMModes.jl","text":"(m, n): m = azimuthal/angular index, n = radial/vertical index\nMode types with polarization:\n:TEc, :TEs: Cosine/sine polarizations (circular/coaxial, same cutoff)\n:TEe, :TEo: Even/odd modes (elliptic, different cutoffs)","category":"page"},{"location":"#Validation","page":"AnalyticEMModes.jl","title":"Validation","text":"","category":"section"},{"location":"","page":"AnalyticEMModes.jl","title":"AnalyticEMModes.jl","text":"Analytical results can be validated against numerical solvers.","category":"page"},{"location":"","page":"AnalyticEMModes.jl","title":"AnalyticEMModes.jl","text":"Example comparison code is provided in the documentation for each geometry.","category":"page"},{"location":"#Contributing","page":"AnalyticEMModes.jl","title":"Contributing","text":"","category":"section"},{"location":"","page":"AnalyticEMModes.jl","title":"AnalyticEMModes.jl","text":"Contributions are welcome! Areas for expansion:","category":"page"},{"location":"","page":"AnalyticEMModes.jl","title":"AnalyticEMModes.jl","text":"Additional geometries (spherical, etc.) with analytical solutions.\nAdditional visualization utilities, like field line plotting.\nAnd anything else you think might fit in AnalyticEMMode.jl","category":"page"},{"location":"#Acknowledgments","page":"AnalyticEMModes.jl","title":"Acknowledgments","text":"","category":"section"},{"location":"","page":"AnalyticEMModes.jl","title":"AnalyticEMModes.jl","text":"This package builds upon:","category":"page"},{"location":"","page":"AnalyticEMModes.jl","title":"AnalyticEMModes.jl","text":"Bessels.jl for Bessel function evaluation\nClassic EM and waveguide books.","category":"page"},{"location":"#Support","page":"AnalyticEMModes.jl","title":"Support","text":"","category":"section"},{"location":"","page":"AnalyticEMModes.jl","title":"AnalyticEMModes.jl","text":"Documentation: This site\nIssues: GitHub Issues\nDiscussions: GitHub Discussions","category":"page"}]
}
