<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Coaxial Waveguides · AnalyticEMModes.jl</title><meta name="title" content="Coaxial Waveguides · AnalyticEMModes.jl"/><meta property="og:title" content="Coaxial Waveguides · AnalyticEMModes.jl"/><meta property="twitter:title" content="Coaxial Waveguides · AnalyticEMModes.jl"/><meta name="description" content="Documentation for AnalyticEMModes.jl."/><meta property="og:description" content="Documentation for AnalyticEMModes.jl."/><meta property="twitter:description" content="Documentation for AnalyticEMModes.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">AnalyticEMModes.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">AnalyticEMModes.jl</a></li><li><a class="tocitem" href="../../Usage/">Usage Guide</a></li><li><a class="tocitem" href="../../api_reference/">API Reference</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../Examples/">Gallery</a></li><li><a class="tocitem" href="../../Rectangular/rectangular/">Rectangular</a></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox" checked/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Cylindrical</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../Circular/">Circular Waveguides</a></li><li class="is-active"><a class="tocitem" href>Coaxial Waveguides</a><ul class="internal"><li><a class="tocitem" href="#Numerical-/-Analytical-Comparison"><span>Numerical / Analytical Comparison</span></a></li><li><a class="tocitem" href="#Analytical-Results"><span>Analytical Results</span></a></li><li><a class="tocitem" href="#Additional-Examples"><span>Additional Examples</span></a></li></ul></li><li><a class="tocitem" href="../Radial/">Radial &amp; Wedge</a></li></ul></li><li><a class="tocitem" href="../../Elliptic/elliptic/">Elliptic</a></li></ul></li><li><span class="tocitem">Theory</span><ul><li><a class="tocitem" href="../../theory/introduction/">Introduction</a></li><li><a class="tocitem" href="../../theory/coordinate/">Coordinate Systems</a></li><li><a class="tocitem" href="../../theory/em_solutions/">Mode Theory</a></li><li><a class="tocitem" href="../../theory/power_normalization/">Power Normalization</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li><a class="is-disabled">Cylindrical</a></li><li class="is-active"><a href>Coaxial Waveguides</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Coaxial Waveguides</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/uvegege/AnalyticEMModes.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/uvegege/AnalyticEMModes.jl/blob/main/docs/src/Cylindrical/Coaxial.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Coaxial-Waveguide"><a class="docs-heading-anchor" href="#Coaxial-Waveguide">Coaxial Waveguide</a><a id="Coaxial-Waveguide-1"></a><a class="docs-heading-anchor-permalink" href="#Coaxial-Waveguide" title="Permalink"></a></h1><p>Coaxial waveguides are unique in supporting a TEM mode, which has no cutoff frequency. This makes coaxial transmission lines suitable for broadband applications. Additionally, coaxial structures support TE and TM higher-order modes, whose field solutions involve both Bessel functions of the first kind (Jₘ) and second kind (Yₘ) to satisfy boundary conditions on both the inner and outer conductors.</p><p>For visualization purposes, we focus on the higher-order TE and TM modes, as the TEM mode has a simple radial field pattern.</p><h2 id="Numerical-/-Analytical-Comparison"><a class="docs-heading-anchor" href="#Numerical-/-Analytical-Comparison">Numerical / Analytical Comparison</a><a id="Numerical-/-Analytical-Comparison-1"></a><a class="docs-heading-anchor-permalink" href="#Numerical-/-Analytical-Comparison" title="Permalink"></a></h2><p>To validate the analytical solutions, we compare numerical eigenmode results obtained with finite element method against the closed-form expressions. The mesh for the coaxial cross-section includes both the inner conductor boundary (at radius R2) and the outer conductor boundary (at radius R1).</p><blockquote><p>Mesh files (.msh) can be found in <em>\src\Assets\mesh</em> and are generated with Gmsh.jl using functions in <em>\src\Assets\example_mesh.jl</em>.</p></blockquote><pre><code class="language-julia hljs">
using GLMakie

name = &quot;../Assets/mesh/coax_wg1.msh&quot;

R1 = 1
R2 = 0.1
#coaxwg_mesh(R1, R2; dl = 0.1, name = name)
model = GmshDiscreteModel(name, renumber = false)
A_te, B_te, U_te, V_te = engeimode_gridap(model, :TE, order = 2)
A_tm, B_tm, U_tm, V_tm = engeimode_gridap(model, :TM, order = 2)

nev = 6
λ_te, ϕ_te = eigs(A_te, B_te; nev=nev, which=:SM, maxiter=6200)
λ_tm, ϕ_tm = eigs(A_tm, B_tm; nev=nev, which=:SM, maxiter=6200)

Ω_domain = Triangulation(model, tags=&quot;Domain&quot;)
gridap_coords = get_node_coordinates(Ω_domain)
makie_coords = map(x-&gt;Point2(x.data), gridap_coords)
face_to_nodes = stack(map(x-&gt;x, get_cell_node_ids(Ω_domain)))&#39;

mn = 3
uh = FEFunction(V_te, real.(ϕ_te[:, mn]), get_dirichlet_dof_values(V_te))
gridap_values = evaluate(uh, gridap_coords)
fz_num = abs.(gridap_values)
fz_num = fz_num / maximum(fz_num)
coord2 = makie_coords[argmin(fz_num)]

# Analytic solution
uh_t = CellField(x-&gt; begin
    x, y = x[1], x[2]
    r = hypot(x, y)
    θ = atan(y, x) - (atan(coord2[2], coord2[1])) + pi/2
    (Er, Eθ, Ez, Hr, Hθ, Hz) = te_coax_fields(r, θ, R1, R2, 1, 1, 10e9, 1.0, 1.0)
return Hz end, Ω_domain)
fz_an = evaluate(uh_t, gridap_coords)

fz_norm = abs.(fz_an) / maximum(abs.(fz_an))

fig = Figure()
ax1 = Axis(fig[1,1], title = &quot;Eigenmode solution&quot;)
hidedecorations!(ax1)
t = range(0, 2*pi, length=100)
circ_x_r1 = @. R1 * cos(t)
circ_y_r1 = @. R1 * sin(t)
t1 = lines!(ax1, circ_x_r1, circ_y_r1, linewidth = 3.5, color = :black)

circ_x_r2 = @. R2 * cos(t)
circ_y_r2 = @. R2 * sin(t)
t2 = lines!(ax1, circ_x_r2, circ_y_r2, linewidth = 3.5, color = :black)
translate!(t1, (0, 0, 2))
translate!(t2, (0, 0, 2))

mesh!(ax1, makie_coords, face_to_nodes, color = fz_num, colormap = :jet)


ax2 = Axis(fig[1,2], title = &quot;Analytic solution&quot;)
hidedecorations!(ax2)
t1 = lines!(ax2, circ_x_r1, circ_y_r1, linewidth = 2.5, color = :black)
t2 = lines!(ax2, circ_x_r2, circ_y_r2, linewidth = 2.5, color = :black)
translate!(t1, (0, 0, 2))
translate!(t2, (0, 0, 2))
mesh!(ax2, makie_coords, face_to_nodes, color = abs.(fz_an), colormap = :jet)

fig</code></pre><p><img src="../../Assets/images/coax_gridap1.png" alt="Image 4"/></p><p>The comparison shows excellent agreement between the numerical eigenmode solution and the analytical result. Note that the numerical solution may have an arbitrary phase rotation, which is corrected in the visualization by aligning the field minimum.</p><p>The normalized error between the numerical approximation and the analytical solution is:</p><pre><code class="language-julia hljs">n_num = sqrt(sum(abs2, fz_num))
n_an = sqrt(sum(abs2, fz_an))
fz_num_norm = abs.(fz_num)/n_num 
fz_an_norm = abs.(fz_an)/n_an
rmse = err = sqrt(sum(abs2, fz_num_norm-fz_an_norm)/length(fz_an_norm)) #0.0002707251478033022</code></pre><p>This small RMSE (root mean square error) of approximately 0.00027 confirms the accuracy of the analytical solution.</p><h2 id="Analytical-Results"><a class="docs-heading-anchor" href="#Analytical-Results">Analytical Results</a><a id="Analytical-Results-1"></a><a class="docs-heading-anchor-permalink" href="#Analytical-Results" title="Permalink"></a></h2><p>We now visualize the first 24 TE modes computed analytically using <code>te_coax_fields</code>. The modes are ordered by increasing cutoff frequency. For a coaxial guide with outer radius R1 = 1 and inner radius R2 = 0.1 (ratio 10:1), the mode patterns show the characteristic interference between fields reflected from the inner and outer conductors.</p><pre><code class="language-julia hljs">using GLMakie

name = &quot;../Assets/mesh/coax_wg2.msh&quot;
R1 = 1
R2 = 0.1
#coaxwg_mesh(R1, R2; dl = 0.02, name = name)
coord, conn = mesh_data(name)
coords = coord[:, 1:maximum(conn)]
xcoords = coords[1, :]
ycoords = coords[2, :]
rcoords = map((x, y) -&gt; hypot(x, y), xcoords, ycoords)
θcoords = map((x, y) -&gt; atan(y, x), xcoords, ycoords)

modekind = [(1, 1) ,(2, 1) ,(0, 1) ,(3, 1),(1, 2),
            (4, 1) ,(5, 1) ,(2, 2) ,(0, 2) ,(6, 1),
            (3, 2) ,(1, 3) ,(7, 1) ,(4, 2) ,(8, 1),
            (2, 3) ,(5, 2) ,(9, 1) ,(0, 3) ,(3, 3),
            (1, 4) ,(6, 2) ,(10, 1) ,(4, 3)]

plot_ids = Iterators.product(1:6, 1:4) |&gt; collect |&gt; vec

t = range(0, 2*pi, length=100)
circ_x_r1 = @. R1 * cos(t)
circ_y_r1 = @. R1 * sin(t)
circ_x_r2 = @. R2 * cos(t)
circ_y_r2 = @. R2 * sin(t)

fig = Figure(size = (1200, 900))
for (idplot, (m, n)) in enumerate(modekind)
    stitle = L&quot;TE_{%$m,%$n}&quot;
    ii, jj = plot_ids[idplot]
    axi = Axis(fig[jj,ii], title = stitle, titlesize = 20)
    hidedecorations!(axi)

    fields = te_coax_fields(rcoords, θcoords, R1, R2, m, n, 10e9, 1.0, 1.0)
    fz = getindex.(fields, 6)

    t1 = lines!(axi, circ_x_r1, circ_y_r1, linewidth = 3.5, color = :black)
    t2 = lines!(axi, circ_x_r2, circ_y_r2, linewidth = 3.5, color = :black)
    translate!(t1, (0, 0, 2))
    translate!(t2, (0, 0, 2))
    mesh!(axi, coords, conn, color = abs.(fz), colormap = :jet)
end
fig</code></pre><img src="421cc4b7.png" alt="Example block output"/><p>The TE mode patterns display the magnitude of the longitudinal magnetic field Hz. Modes with m &gt; 0 exhibit azimuthal variations, while modes with larger n exhibit additional radial nodal circles.</p><p>The <strong>TM modes</strong> for the same geometry different ordering and patterns:</p><pre><code class="language-julia hljs">modekind = [(0, 1) ,(1, 1) ,(2, 1) ,(3, 1) ,(0, 2),
            (1, 2) ,(4, 1) ,(2, 2) ,(5, 1) ,(3, 2),
            (6, 1) ,(0, 3) ,(1, 3) ,(4, 2) ,(7, 1),
            (2, 3) ,(8, 1) ,(5, 2) ,(3, 3) ,(9, 1),
            (6, 2) ,(0, 4) ,(1, 4) ,(4, 3)]

plot_ids = Iterators.product(1:6, 1:4) |&gt; collect |&gt; vec

fig = Figure(size = (1200, 900))
for (idplot, (m, n)) in enumerate(modekind)
    stitle = L&quot;TM_{%$m,%$n}&quot;
    ii, jj = plot_ids[idplot]
    axi = Axis(fig[jj,ii], title = stitle, titlesize = 20)
    hidedecorations!(axi)

    fields = tm_coax_fields(rcoords, θcoords, R1, R2, m, n, 10e9, 1.0, 1.0)
    fz = getindex.(fields, 3)

    t1 = lines!(axi, circ_x_r1, circ_y_r1, linewidth = 3.5, color = :black)
    t2 = lines!(axi, circ_x_r2, circ_y_r2, linewidth = 3.5, color = :black)
    translate!(t1, (0, 0, 2))
    translate!(t2, (0, 0, 2))
    mesh!(axi, coords, conn, color = abs.(fz), colormap = :jet)
end
fig</code></pre><img src="4cbcbe96.png" alt="Example block output"/><p>TM modes satisfy the boundary condition that Ez = 0 at both conductor surfaces. The field patterns are determined by combinations of Bessel functions chosen to satisfy these dual boundary conditions.</p><h2 id="Additional-Examples"><a class="docs-heading-anchor" href="#Additional-Examples">Additional Examples</a><a id="Additional-Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Additional-Examples" title="Permalink"></a></h2><p>To demonstrate how geometry affects mode patterns, we now examine a coaxial guide with a larger inner conductor. The following visualization shows the first 24 higher-order modes (excluding the TEM mode) for a radius ratio R1/R2 = 1/0.65, corresponding to a much thinner annular region.</p><pre><code class="language-julia hljs">R1 = 1
R2 = 0.65

name = &quot;../Assets/mesh/coax_wg3.msh&quot;
#coaxwg_mesh(R1, R2; dl = 0.01, name = name)
coord, conn = mesh_data(name)
coords = coord[:, 1:maximum(conn)]
xcoords = coords[1, :]
ycoords = coords[2, :]
rcoords = map((x, y) -&gt; hypot(x, y), xcoords, ycoords)
θcoords = map((x, y) -&gt; atan(y, x), xcoords, ycoords)

modekind = [(1, 1, :TE) , (2, 1, :TE) , (3, 1, :TE), (4, 1, :TE),
            (5, 1, :TE) , (6, 1, :TE), (7, 1, :TE), (0, 1, :TM),
            (0, 1, :TE) , (1, 1, :TM) , (1, 2, :TE) , (2, 1, :TM),
            (2, 2, :TE) , (8, 1, :TE) , (3, 1, :TM) , (3, 2, :TE),
            (4, 1, :TM) , (4, 2, :TE) , (9, 1, :TE), (5, 1, :TM),
            (5, 2, :TE) , (6, 1, :TM) , (10, 1, :TE) , (6, 2, :TE)]

t = range(0, 2*pi, length=100)
circ_x_r1 = @. R1 * cos(t)
circ_y_r1 = @. R1 * sin(t)
circ_x_r2 = @. R2 * cos(t)
circ_y_r2 = @. R2 * sin(t)

fig = Figure(size = (1200, 900))
for (idplot, (m, n, ki)) in enumerate(modekind)
    ii, jj = plot_ids[idplot]
    stitle = L&quot;%$(ki)_{%$m,%$n}&quot;
    axi = Axis(fig[jj,ii], title = stitle, titlesize = 20)
    hidedecorations!(axi)

    if ki == :TE
        fields = te_coax_fields(rcoords, θcoords, R1, R2, m, n, 10e9, 1.0, 1.0)
        fz = getindex.(fields, 6)
    else
        fields = tm_coax_fields(rcoords, θcoords, R1, R2, m, n, 10e9, 1.0, 1.0)
        fz = getindex.(fields, 3)
    end

    t1 = lines!(axi, circ_x_r1, circ_y_r1, linewidth = 3.5, color = :black)
    t2 = lines!(axi, circ_x_r2, circ_y_r2, linewidth = 3.5, color = :black)
    translate!(t1, (0, 0, 2))
    translate!(t2, (0, 0, 2))
    mesh!(axi, coords, conn, color = abs.(fz), colormap = :jet)
end
fig</code></pre><img src="7aa66560.png" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../Circular/">« Circular Waveguides</a><a class="docs-footer-nextpage" href="../Radial/">Radial &amp; Wedge »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Wednesday 12 November 2025 22:25">Wednesday 12 November 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
