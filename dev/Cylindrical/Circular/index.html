<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Circular Waveguides · AnalyticEMModes.jl</title><meta name="title" content="Circular Waveguides · AnalyticEMModes.jl"/><meta property="og:title" content="Circular Waveguides · AnalyticEMModes.jl"/><meta property="twitter:title" content="Circular Waveguides · AnalyticEMModes.jl"/><meta name="description" content="Documentation for AnalyticEMModes.jl."/><meta property="og:description" content="Documentation for AnalyticEMModes.jl."/><meta property="twitter:description" content="Documentation for AnalyticEMModes.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">AnalyticEMModes.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">AnalyticEMModes.jl</a></li><li><a class="tocitem" href="../../Usage/">Usage Guide</a></li><li><a class="tocitem" href="../../api_reference/">API Reference</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../Examples/">Gallery</a></li><li><a class="tocitem" href="../../Rectangular/rectangular/">Rectangular</a></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox" checked/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Cylindrical</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>Circular Waveguides</a><ul class="internal"><li><a class="tocitem" href="#Numerical-/-Analytical-Comparison"><span>Numerical / Analytical Comparison</span></a></li><li><a class="tocitem" href="#Analytical-Results"><span>Analytical Results</span></a></li><li><a class="tocitem" href="#Transverse-Fields"><span>Transverse Fields</span></a></li></ul></li><li><a class="tocitem" href="../Coaxial/">Coaxial Waveguides</a></li><li><a class="tocitem" href="../Radial/">Radial &amp; Wedge</a></li></ul></li><li><a class="tocitem" href="../../Elliptic/elliptic/">Elliptic</a></li></ul></li><li><span class="tocitem">Theory</span><ul><li><a class="tocitem" href="../../theory/introduction/">Introduction</a></li><li><a class="tocitem" href="../../theory/coordinate/">Coordinate Systems</a></li><li><a class="tocitem" href="../../theory/em_solutions/">Mode Theory</a></li><li><a class="tocitem" href="../../theory/theory_rectangular/">Rectangular</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li><a class="is-disabled">Cylindrical</a></li><li class="is-active"><a href>Circular Waveguides</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Circular Waveguides</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/uvegege/AnalyticEMModes.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/uvegege/AnalyticEMModes.jl/blob/main/docs/src/Cylindrical/Circular.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Circular-Waveguide"><a class="docs-heading-anchor" href="#Circular-Waveguide">Circular Waveguide</a><a id="Circular-Waveguide-1"></a><a class="docs-heading-anchor-permalink" href="#Circular-Waveguide" title="Permalink"></a></h1><p>Circular waveguides support both TE and TM modes, characterized by integer indices (m, n) where m represents the azimuthal variation and n represents the radial variation. The solutions involve Bessel functions of the first kind for the radial dependence and sinusoidal functions for the angular variation.</p><p>For modes with m &gt; 0, two polarizations exist (cosine and sine variations), which have identical cutoff frequencies but different field orientations.</p><h2 id="Numerical-/-Analytical-Comparison"><a class="docs-heading-anchor" href="#Numerical-/-Analytical-Comparison">Numerical / Analytical Comparison</a><a id="Numerical-/-Analytical-Comparison-1"></a><a class="docs-heading-anchor-permalink" href="#Numerical-/-Analytical-Comparison" title="Permalink"></a></h2><p>To validate the analytical solutions, we first compute numerical results using a finite element method on a circular mesh. The mesh is generated using Gmsh for the circular cross-section of the waveguide.</p><blockquote><p>Mesh files (.msh) can be found in <em>\src\Assets\mesh</em> and are generated with Gmsh.jl using functions in <em>\src\Assets\example_mesh.jl</em>.</p></blockquote><p>The following code shows the first 18 TE modes computed numerically. Note that modes with m &gt; 0 appear in  pairs (cosine/sine polarizations).</p><pre><code class="language-julia hljs">
R = 1
name = &quot;../Assets/mesh/circular_wg1.msh&quot;
cwg_mesh(R; dl = 0.25e-1, name = name)
model = GmshDiscreteModel(name, renumber = false)

Ω_domain = Triangulation(model, tags=&quot;Domain&quot;)
gridap_coords = get_node_coordinates(Ω_domain)
makie_coords = map(x-&gt;Point2(x.data), gridap_coords)
face_to_nodes = stack(map(x-&gt;x, get_cell_node_ids(Ω_domain)))&#39;

A_te, B_te, U_te, V_te = engeimode_gridap(model, :TE, order = 2)
nev = 20
λ_te, ϕ_te = eigs(A_te, B_te; nev=nev, which=:SM, maxiter=1200)

t = range(0, 2*pi, length=100)
circ_y_r = @. R * sin(t)
circ_x_r = @. R * cos(t)

fig = Figure(size = (1200, 900))
plot_ids = Iterators.product(1:6, 1:3) |&gt; collect |&gt; vec
for (idp, (ii, jj)) in enumerate(plot_ids)
    uh = FEFunction(V_te, real.(ϕ_te[:, idp+1]), get_dirichlet_dof_values(V_te))
    gridap_values = evaluate(uh, gridap_coords)
    fz_num = abs.(gridap_values)
    fz_num = fz_num / maximum(fz_num)
    coord2 = makie_coords[argmin(fz_num)]
    axi = Axis(fig[jj,ii])
    lines!(axi, circ_x_r, circ_y_r, linewidth = 3.5, color = :black)
    mesh!(axi, makie_coords, face_to_nodes, color = fz_num, colormap = :jet)
    hidedecorations!(axi)
end
Label(fig[0, 3:4], &quot;Numeric TE Modes&quot;, fontsize = 20)
fig</code></pre><p><img src="../../Assets/images/circ_gridap1.png" alt="Image 3"/></p><p>The numerical solution shows the magnitude of the longitudinal magnetic field component (Hz) for TE modes. Each mode exhibits a characteristic pattern determined by its indices (m, n), with m radial nodal lines.</p><h2 id="Analytical-Results"><a class="docs-heading-anchor" href="#Analytical-Results">Analytical Results</a><a id="Analytical-Results-1"></a><a class="docs-heading-anchor-permalink" href="#Analytical-Results" title="Permalink"></a></h2><p>We now compute the analytical field solutions using the <code>te_cwg_fields</code> and <code>tm_cwg_fields</code> functions. For visualization clarity, we show only one polarization (cosine variation) for modes with m &gt; 0. The analytical solutions provide exact field distributions based on Bessel function evaluations.</p><pre><code class="language-julia hljs">R = 1
freq = 10e9

name = &quot;../Assets/mesh/circular_wg1.msh&quot;
#cwg_mesh(R; dl = 0.25e-1, name = name)
coord, conn = mesh_data(name)
coords = coord[:, 1:maximum(conn)]
xcoords = coords[1, :]
ycoords = coords[2, :]
rcoords = map((x, y) -&gt; hypot(x, y), xcoords, ycoords)
θcoords = map((x, y) -&gt; atan(y, x), xcoords, ycoords)

modekind = [(1, 1, :TE), (0, 1, :TM), (2, 1, :TE), (0, 1, :TE),
(1, 1, :TM), (3, 1, :TE), (2, 1, :TM), (4, 1, :TE), (1, 2, :TE),
(0, 2, :TM), (3, 1, :TM), (5, 1, :TE), (2, 2, :TE), (0, 2, :TE),
(1, 2, :TM), (6, 1, :TE), (4, 1, :TM), (3, 2, :TE), (2, 2, :TM),
(1, 3, :TE), (7, 1, :TE), (0, 3, :TM), (5, 1, :TM), (4, 2, :TE)]

fig = Figure(size = (1200, 900))

t = range(0, 2*pi, length=100)
circ_y_r = @. R * sin(t)
circ_x_r = @. R * cos(t)

plot_ids = Iterators.product(1:6, 1:4) |&gt; collect |&gt; vec

for (idp, (m, n, ki)) in enumerate(modekind)
    stitle = L&quot;%$(ki)_{%$m,%$n}&quot;
    ii, jj = plot_ids[idp]
    axi = Axis(fig[jj, ii], title = stitle, titlesize = 20)
    hidedecorations!(axi)

    if ki == :TE
        fields = te_cwg_fields(rcoords, θcoords, R, m, n, freq, 1.0, 1.0)
        fz = map(x-&gt;abs(x[6]), fields)
    else
        fields = tm_cwg_fields(rcoords, θcoords, R, m, n, freq, 1.0, 1.0)
        fz = map(x-&gt;abs(x[3]), fields)
    end

    lines!(axi, circ_x_r, circ_y_r, linewidth = 3.5, color = :black)
    mesh!(axi, coords, conn, color = fz, colormap = :jet)
end
fig</code></pre><img src="2371b5c3.png" alt="Example block output"/><p>This visualization displays 24 modes ordered by increasing cutoff frequency, alternating between TE and TM types. The color map shows the magnitude of Hz (for TE modes) or Ez (for TM modes).</p><h2 id="Transverse-Fields"><a class="docs-heading-anchor" href="#Transverse-Fields">Transverse Fields</a><a id="Transverse-Fields-1"></a><a class="docs-heading-anchor-permalink" href="#Transverse-Fields" title="Permalink"></a></h2><p>The field functions return electromagnetic field components in cylindrical coordinates (Er, Eθ, Ez, Hr, Hθ, Hz). For visualization and practical applications, we often need the transverse components in Cartesian coordinates. The conversion is performed using the metric and unit vector transformations provided by the <code>metric_and_unit_cylindrical</code> function.</p><p>The following code computes and visualizes the transverse electric field for TE modes and the transverse magnetic field for TM modes, displayed as vector arrow plots:</p><pre><code class="language-julia hljs">name = &quot;../Assets/mesh/circular_wg2.msh&quot;
#cwg_mesh(R; dl = 0.7e-1, name = name)
coord, conn = mesh_data(name)
coords = coord[:, 1:maximum(conn)]
xcoords = coords[1, :]
ycoords = coords[2, :]
rcoords = map((x, y) -&gt; hypot(x, y), xcoords, ycoords)
θcoords = map((x, y) -&gt; atan(y, x), xcoords, ycoords)

fig = Figure(size = (1200, 900))
for (idp, (m, n, ki)) in enumerate(modekind)
    stitle = L&quot;%$(ki)_{%$m,%$n}&quot;
    ii, jj = plot_ids[idp]
    axi = Axis(fig[jj, ii], title = stitle, titlesize = 20)
    hidedecorations!(axi)

    if ki == :TE
        fields = te_cwg_fields(rcoords, θcoords, R, m, n, freq, 1.0, 1.0)
        fzi = map(x-&gt;(x[1], x[2]), fields)
    else
        fields = tm_cwg_fields(rcoords, θcoords, R, m, n, freq, 1.0, 1.0)
        fzi = map(x-&gt;(x[4], x[5]), fields)
    end

    fxy = map(fzi, rcoords, θcoords) do frθ, r, θ
        h_r, h_ϕ, e_r_x, e_r_y, e_ϕ_x, e_ϕ_y = metric_and_unit_cylindrical(r, θ)
        Fx = frθ[1] * e_r_x + frθ[2] * e_ϕ_x
        Fy = frθ[1] * e_r_y + frθ[2] * e_ϕ_y
        return (Fx, Fy)
    end

    t = lines!(axi, circ_x_r, circ_y_r, linewidth = 3.5, color = :black)
    translate!(t, (0, 0, 2))
    fu = real.(getindex.(fxy, 1))
    fv = real.(getindex.(fxy, 2))
    ft = map(x-&gt;hypot(x...), fxy) * 25
    vm = maximum(ft)*10
    fu = fu ./ ft
    fv = fv ./ ft
    arrows2d!(axi, xcoords, ycoords, fu, fv, color = ft, colormap = :jet)
end
fig</code></pre><img src="e8d078b9.png" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../Rectangular/rectangular/">« Rectangular</a><a class="docs-footer-nextpage" href="../Coaxial/">Coaxial Waveguides »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Tuesday 11 November 2025 23:29">Tuesday 11 November 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
