<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Power Normalization · AnalyticEMModes.jl</title><meta name="title" content="Power Normalization · AnalyticEMModes.jl"/><meta property="og:title" content="Power Normalization · AnalyticEMModes.jl"/><meta property="twitter:title" content="Power Normalization · AnalyticEMModes.jl"/><meta name="description" content="Documentation for AnalyticEMModes.jl."/><meta property="og:description" content="Documentation for AnalyticEMModes.jl."/><meta property="twitter:description" content="Documentation for AnalyticEMModes.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">AnalyticEMModes.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">AnalyticEMModes.jl</a></li><li><a class="tocitem" href="../../Usage/">Usage Guide</a></li><li><a class="tocitem" href="../../api_reference/">API Reference</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../Examples/">Gallery</a></li><li><a class="tocitem" href="../../Rectangular/rectangular/">Rectangular</a></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Cylindrical</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Cylindrical/Circular/">Circular Waveguides</a></li><li><a class="tocitem" href="../../Cylindrical/Coaxial/">Coaxial Waveguides</a></li><li><a class="tocitem" href="../../Cylindrical/Radial/">Radial &amp; Wedge</a></li></ul></li><li><a class="tocitem" href="../../Elliptic/elliptic/">Elliptic</a></li></ul></li><li><span class="tocitem">Theory</span><ul><li><a class="tocitem" href="../introduction/">Introduction</a></li><li><a class="tocitem" href="../coordinate/">Coordinate Systems</a></li><li><a class="tocitem" href="../em_solutions/">Mode Theory</a></li><li class="is-active"><a class="tocitem" href>Power Normalization</a><ul class="internal"><li><a class="tocitem" href="#Power-normalization-in-Rectangular-Waveguides"><span>Power normalization in Rectangular Waveguides</span></a></li><li><a class="tocitem" href="#Power-normalization-in-Circular-and-Coaxial-Waveguides"><span>Power normalization in Circular and Coaxial Waveguides</span></a></li><li><a class="tocitem" href="#Circular-Waveguide"><span>Circular Waveguide</span></a></li><li><a class="tocitem" href="#Coaxial-Waveguide"><span>Coaxial Waveguide</span></a></li><li><a class="tocitem" href="#Radial-and-Wedge-Waveguide"><span>Radial and Wedge Waveguide</span></a></li><li><a class="tocitem" href="#Power-Integration"><span>Power Integration</span></a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Theory</a></li><li class="is-active"><a href>Power Normalization</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Power Normalization</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/uvegege/AnalyticEMModes.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/uvegege/AnalyticEMModes.jl/blob/main/docs/src/theory/power_normalization.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Power-Normalization"><a class="docs-heading-anchor" href="#Power-Normalization">Power Normalization</a><a id="Power-Normalization-1"></a><a class="docs-heading-anchor-permalink" href="#Power-Normalization" title="Permalink"></a></h1><p>The normalization constant is derived from the power flow condition:</p><p class="math-container">\[P = \frac{1}{2} \text{Re} \int_0^a \int_0^b (\mathbf{E} \times \mathbf{H}^*) \cdot \mathbf{\hat{z}}  dx dy = 1 \text{ Watt}\]</p><h2 id="Power-normalization-in-Rectangular-Waveguides"><a class="docs-heading-anchor" href="#Power-normalization-in-Rectangular-Waveguides">Power normalization in Rectangular Waveguides</a><a id="Power-normalization-in-Rectangular-Waveguides-1"></a><a class="docs-heading-anchor-permalink" href="#Power-normalization-in-Rectangular-Waveguides" title="Permalink"></a></h2><h3 id="For-TE-Modes"><a class="docs-heading-anchor" href="#For-TE-Modes">For TE Modes</a><a id="For-TE-Modes-1"></a><a class="docs-heading-anchor-permalink" href="#For-TE-Modes" title="Permalink"></a></h3><p>Using the field components (with the factors implemented in the package):</p><p class="math-container">\[	E_x = F_0 \frac{\omega\mu}{k_c^2}\frac{mx}{a}\sin \left(\frac{mx}{a}\right) \cos\left(\frac{ny}{b}\right), \quad
	E_y = -F_0 \frac{\omega\mu}{k_c^2}\frac{ny}{b}{\epsilon} F_0 \cos\left(\frac{mx}{a}\right)\sin\left(\frac{ny}{b}\right)\]</p><p class="math-container">\[	H_x = -F_0 \frac{\beta}{k_c^2}\frac{ny}{b}{\epsilon} F_0 \cos\left(\frac{mx}{a}\right)\sin\left(\frac{ny}{b}\right), \quad
	H_y = F_0 \frac{\beta}{k_c^2}\frac{mx}{a}\sin \left(\frac{mx}{a}\right) \cos\left(\frac{ny}{b}\right)\]</p><p>The z-component of the Poynting vector is:</p><p class="math-container">\[S_z = \frac{1}{2} (E_x H_y^* - E_y H_x^*)\]</p><p>Substituting and simplifying:</p><p class="math-container">\[S_z = \frac{1}{2} \frac{\beta F_0^2 \omega \mu}{k_c^4} \left[k_y^2 \sin^2(k_y y)\cos^2(k_x x) + k_x^2 \cos^2(k_y y)\sin^2(k_x x)\right]\]</p><p>The power is</p><p class="math-container">\[P_z = \int_{0}^a\int_0^b \frac{1}{2} \frac{\beta F_0^2 \omega \mu}{k_c^4} \left[k_y^2 \sin^2(k_y y)\cos^2(k_x x) + k_x^2 \cos^2(k_y y)\sin^2(k_x x)\right]\]</p><p>Integrating over the cross-section and using the orthogonality of trigonometric functions:</p><p class="math-container">\[\int_0^a \sin^2(k_x x) dx = \frac{a}{2}, \quad \int_0^a \cos^2(k_x x) dx = \frac{a}{2}\]</p><p class="math-container">\[\int_0^b \cos^2(k_y y) dy = \frac{b}{2}, \quad \int_0^b \sin^2(k_y y) dy = \frac{b}{2}\]</p><p>Defining:</p><p class="math-container">\[\delta_m = \begin{cases} 1 &amp; \text{if } n \geq 1 \\ 2 &amp; \text{if } n = 0 \end{cases}, \quad
\delta_n = \begin{cases} 1 &amp; \text{if } m \geq 1 \\ 2 &amp; \text{if } m = 0 \end{cases}\]</p><p>We get:</p><p class="math-container">\[P_z = \frac{1}{2} \frac{\beta F_0^2 \omega \mu}{k_c^4} \left( \int_{0}^a\int_0^b k_y^2 \sin^2(k_y y)\cos^2(k_x x) +  \int_{0}^a\int_0^b k_x^2 \cos^2(k_y y)\sin^2(k_x x) \right)\]</p><p class="math-container">\[P_z = \frac{1}{2} \frac{\beta F_0^2 \omega \mu}{k_c^4} \left( \delta_m k_y^2\frac{ab}{4} +  \delta_n k_x^2 \frac{ab}{4}\right) = = \frac{1}{2} \frac{\beta F_0^2 \omega \mu}{k_c^4} \left( \delta_m \frac{n^2\pi^2}{b^2} \frac{ab}{4} + \delta_n \frac{m^2\pi^2}{a^2}\frac{ab}{4} \right)\]</p><p class="math-container">\[P_z = \frac{1}{2} \frac{\beta F_0^2 \omega \mu \pi^2}{4k_c^4} \left( \delta_m n^2 \frac{a}{b} +  \delta_n m^2\frac{b}{a} \right)\]</p><p>Setting <span>$P = 1$</span> and solving for <span>$F_0$</span>:</p><p class="math-container">\[F_0 = \sqrt{\frac{8k_c^4}{\beta \omega \mu \pi^2 \left( \delta_m n^2 \frac{a}{b} +  \delta_n m^2\frac{b}{a} \right)}}\]</p><p>For <strong>TM</strong> modes:</p><p class="math-container">\[F_0 = \sqrt{\frac{8k_c^4}{\beta \omega \varepsilon \pi^2 \left( \delta_m n^2 \frac{a}{b} +  \delta_n m^2\frac{b}{a} \right)}}\]</p><h2 id="Power-normalization-in-Circular-and-Coaxial-Waveguides"><a class="docs-heading-anchor" href="#Power-normalization-in-Circular-and-Coaxial-Waveguides">Power normalization in Circular and Coaxial Waveguides</a><a id="Power-normalization-in-Circular-and-Coaxial-Waveguides-1"></a><a class="docs-heading-anchor-permalink" href="#Power-normalization-in-Circular-and-Coaxial-Waveguides" title="Permalink"></a></h2><h3 id="Field-Representation"><a class="docs-heading-anchor" href="#Field-Representation">Field Representation</a><a id="Field-Representation-1"></a><a class="docs-heading-anchor-permalink" href="#Field-Representation" title="Permalink"></a></h3><p>Let&#39;s define the potential function as </p><p class="math-container">\[\psi(\rho) = A_m J_m(k_c\rho) + B_m Y_m(k_c\rho)\]</p><p>with derivative</p><p class="math-container">\[\frac{\partial\psi}{\partial \rho} = \psi^{\prime}(\rho) = k_c \left( A_m J_m&#39;(k_c\rho) + B_m Y_m&#39;(k_c\rho) \right)\]</p><p>For <strong>TM modes</strong>, the longitudinal electric field is:</p><p class="math-container">\[H_z = \psi(\rho) \cos(m\theta)\]</p><p>The transverse field components are:</p><p class="math-container">\[E_\rho = -\frac{j\beta}{k_c^2} \psi^{\prime}(\rho) \cos(m\theta), \quad  E_\theta = \frac{j\beta}{k_c^2} \frac{m}{\rho} \psi(\rho) \sin(m\theta)\]</p><p class="math-container">\[H_\rho = -\frac{j\omega\varepsilon}{k_c^2} \frac{m}{\rho} \psi(\rho) \sin(m\theta), \quad H_\theta = -\frac{j\omega\varepsilon}{k_c^2} \psi^{\prime}(\rho) \cos(m\theta)\]</p><h3 id="Power-Flow"><a class="docs-heading-anchor" href="#Power-Flow">Power Flow</a><a id="Power-Flow-1"></a><a class="docs-heading-anchor-permalink" href="#Power-Flow" title="Permalink"></a></h3><p>The time-average power density is:</p><p class="math-container">\[S_z = \frac{1}{2} \left( E_\rho H_\theta^* - E_\theta H_\rho^*\right)\]</p><p>Substituting the field components:</p><p class="math-container">\[S_z = \frac{1}{2}\frac{\beta\omega\varepsilon}{k_c^4} \left( {\psi^\prime}^2\text{cos}^2\left( m\theta\right) + \frac{m^2}{\rho^2}{\psi}^2\text{sin}^2\left( m\theta\right) \right)\]</p><p>The total power is</p><p class="math-container">\[P = \frac{1}{2}\frac{\beta\omega\varepsilon}{k_c^4}\int_b^a \int_0^{2\pi} \left( {\psi^\prime}^2\text{cos}^2\left( m\theta\right) + \frac{m^2}{\rho^2}{\psi}^2\text{sin}^2\left( m\theta\right) \right) \,\rho\, d\rho d\theta\]</p><h3 id="Angular-integration"><a class="docs-heading-anchor" href="#Angular-integration">Angular integration</a><a id="Angular-integration-1"></a><a class="docs-heading-anchor-permalink" href="#Angular-integration" title="Permalink"></a></h3><p>The angular integrals depend on the azimuthal mode number m:</p><p class="math-container">\[\int_0^{2\pi} \cos^2(m\theta) \, d\theta = \begin{cases}
\pi &amp; \text{if } m \geq 1 \\
2\pi &amp; \text{if } m = 0
\end{cases}, \quad
\int_0^{2\pi} \sin^2(m\theta) \, d\theta = \begin{cases}
\pi &amp; \text{if } m \geq 1 \\
0 &amp; \text{if } m = 0
\end{cases}\]</p><p>Thus, the power becomes:</p><p class="math-container">\[P = \frac{1}{2} \frac{\beta\omega\varepsilon}{k_c^4} \cdot \pi \cdot I\]</p><p>where </p><p class="math-container">\[I = \int_b^a \left[ (\psi^{\prime})^2 + \frac{m^2}{\rho^2} \psi^2 \right] \rho \, d\rho\]</p><h3 id="Simplifying-the-Radial-Integral"><a class="docs-heading-anchor" href="#Simplifying-the-Radial-Integral">Simplifying the Radial Integral</a><a id="Simplifying-the-Radial-Integral-1"></a><a class="docs-heading-anchor-permalink" href="#Simplifying-the-Radial-Integral" title="Permalink"></a></h3><p>The integral <strong>I</strong> can be simplified using multiple identities and relations. Consider:</p><p class="math-container">\[F = \psi\]</p><p class="math-container">\[\frac{\partial}{\partial\rho}\left( \rho F F^\prime  \right) = FF^\prime + \rho F^\prime F^\prime + \rho F F^{\prime\prime} = FF^\prime + \rho \left(F^\prime\right)^2+ \rho F F^{\prime\prime}\]</p><p>Rewriting the above expression:</p><p class="math-container">\[\rho \left(F^\prime\right)^2 = \frac{\partial}{\partial\rho}\left( \rho F F^\prime  \right) - \rho F F^{\prime\prime} - F F^\prime \]</p><p>Integrating on both sides:</p><p class="math-container">\[\int_b^a \rho \left(F^\prime\right)^2  d\rho = \left[\rho F F^\prime\right]_b^a - \int_b^a F F^\prime d\rho - \int_b^a\rho F F^{\prime\prime} d\rho\]</p><p>We want to simplify the term with the second derivative. If we multiply Bessel&#39;s ODE we get:</p><p class="math-container">\[\left( \rho^2 F^{\prime\prime} + \rho F^\prime + \left( k_c^2\rho^2 - m^2\right)F\right)\rho F = \left(0\right) \rho F\]</p><p class="math-container">\[\rho F F^{\prime\prime} + F F^{\prime} + \left( k_c^2 \rho - \frac{m^2}{\rho}\right)F^2 = 0\]</p><p class="math-container">\[\rho F F^{\prime\prime} = -F F^{\prime} - \left(k_c^2\rho-\frac{m^2}{\rho}\right)F^2\]</p><p>After algebraic manipulation with the previous results, we get:</p><p class="math-container">\[\int_b^a \rho \left(F^\prime\right)^2  d\rho = \left[\rho F F^\prime\right]_b^a - \int_b^a F F^\prime d\rho - \int_b^a \left( -F F^{\prime} - \left(k_c^2\rho-\frac{m^2}{\rho}\right)F^2\right) d\rho\]</p><p class="math-container">\[\int_b^a \rho \left(F^\prime\right)^2  d\rho = \left[\rho F F^\prime\right]_b^a - \int_b^a F F^\prime d\rho + \int_b^a F F^{\prime}d\rho +\int_b^a  \left(k_c^2\rho-\frac{m^2}{\rho}\right)F^2 d\rho\]</p><p class="math-container">\[\int_b^a \rho \left(F^\prime\right)^2  d\rho = \left[\rho F F^\prime\right]_b^a +\int_b^a k_c^2\rho F^2 d\rho - \int_b^a \frac{m^2}{\rho}F^2 d\rho\]</p><p>If we reagroup the terms we can get exactly <span>$I$</span> on the right hand side</p><p class="math-container">\[I = \int_b^a \rho \left(F^\prime\right)^2  d\rho + \int_b^a \frac{m^2}{\rho}F^2 d\rho = \left[\rho F F^\prime\right]_b^a + k_c^2\int_b^a \rho F^2 d\rho\]</p><p>Now we just need to solve the last part of the rhs:</p><p class="math-container">\[k_c^2\int_b^a \rho F^2 d\rho\]</p><h3 id="Bessel-Function-Integrals"><a class="docs-heading-anchor" href="#Bessel-Function-Integrals">Bessel Function Integrals</a><a id="Bessel-Function-Integrals-1"></a><a class="docs-heading-anchor-permalink" href="#Bessel-Function-Integrals" title="Permalink"></a></h3><p>The function <span>$F$</span> depends of <span>$\rho$</span>. With the change of variable <span>$x = k_c \rho$</span> we get</p><p class="math-container">\[\frac{k_c^2}{k_c^2}\int_{x_b}^{x_a} x F(x)^2 dx\]</p><p>The remaining integral can be evaluated using the identity:</p><p class="math-container">\[\int z C_\mu(az)D_\mu(az) = \frac{1}{4} z^2 \left(  2 C_\mu(az)D_\mu(az) - C_{\mu-1}(az)D_{\mu+1}(az) - C_{\mu+1}(az)D_{\mu-1}(az)\right)\]</p><p>where <span>$C_\mu$</span> and <span>$D_\mu$</span> are cylindrical functions(<span>$J_\mu$</span>, <span>$Y_\mu$</span> or <span>$H_\mu$</span>). </p><p>For <span>$m = 0$</span> the result is almost identical. The derivation follows the same steps, yielding:</p><p class="math-container">\[I = \int_b^a \rho \left(F^\prime\right)^2  d\rho = \left[\rho F F^\prime\right]_b^a + k_c^2\int_b^a \rho F^2 d\rho\]</p><p>which is exactly the same radial integral result. The only difference appears in the angular integration: instead of multiplying by <span>$\pi$</span>, we now multiply by <span>$2\pi$</span>.</p><h2 id="Circular-Waveguide"><a class="docs-heading-anchor" href="#Circular-Waveguide">Circular Waveguide</a><a id="Circular-Waveguide-1"></a><a class="docs-heading-anchor-permalink" href="#Circular-Waveguide" title="Permalink"></a></h2><p>For circular waveguides (<span>$b = 0$</span>, <span>$B_m = 0$</span>), the boundary term vanishes at <span>$\rho = 0$</span> and </p><p class="math-container">\[\psi = Am J_m(k_c\rho)\]</p><p class="math-container">\[I = k_c a J_m(k_c a) J_m&#39;(k_c a) + \frac{(k_c a)^2}{2} \left[ J_m^2(k_c a) - J_{m+1}(k_c a) J_{m-1}(k_c a) \right]\]</p><h3 id="TM-Modes"><a class="docs-heading-anchor" href="#TM-Modes">TM Modes</a><a id="TM-Modes-1"></a><a class="docs-heading-anchor-permalink" href="#TM-Modes" title="Permalink"></a></h3><p class="math-container">\[F_0 = \sqrt{ \frac{2}{\displaystyle \frac{\omega\mu\beta}{k_c^4} \pi I } }\]</p><p>When <span>$m=0$</span> </p><p class="math-container">\[F_0 = \sqrt{ \frac{2}{\displaystyle \frac{\omega\mu\beta}{k_c^4} 2\pi I } }\]</p><h3 id="TE-Modes"><a class="docs-heading-anchor" href="#TE-Modes">TE Modes</a><a id="TE-Modes-1"></a><a class="docs-heading-anchor-permalink" href="#TE-Modes" title="Permalink"></a></h3><p class="math-container">\[F_0 = \sqrt{ \frac{2}{\displaystyle \frac{\omega\varepsilon\beta}{k_c^4} \pi I } }\]</p><p>When <span>$m=0$</span> </p><p class="math-container">\[F_0 = \sqrt{ \frac{2}{\displaystyle \frac{\omega\varepsilon\beta}{k_c^4} 2\pi I } }\]</p><h2 id="Coaxial-Waveguide"><a class="docs-heading-anchor" href="#Coaxial-Waveguide">Coaxial Waveguide</a><a id="Coaxial-Waveguide-1"></a><a class="docs-heading-anchor-permalink" href="#Coaxial-Waveguide" title="Permalink"></a></h2><p>For coaxial waveguides, both Bessel functions are required since the domain excludes the origin:</p><h3 id="TM-Modes-2"><a class="docs-heading-anchor" href="#TM-Modes-2">TM Modes</a><a class="docs-heading-anchor-permalink" href="#TM-Modes-2" title="Permalink"></a></h3><p class="math-container">\[B_m = -\frac{J_m(k_c b)}{Y_m(k_c b)}\]</p><h3 id="TE-Modes-2"><a class="docs-heading-anchor" href="#TE-Modes-2">TE Modes</a><a class="docs-heading-anchor-permalink" href="#TE-Modes-2" title="Permalink"></a></h3><p class="math-container">\[B_m = -\frac{J_m&#39;(k_c b)}{Y_m&#39;(k_c b)}\]</p><p>The radial function becomes</p><p class="math-container">\[F = A_m J_m(k_c\rho) + B_m Y_m(k_c\rho)\]</p><p class="math-container">\[F^{\prime} = k_c \left[ A_m J_m&#39;(k_c\rho) + B_m Y_m&#39;(k_c\rho) \right]\]</p><p>The integral <strong>I</strong> has two parts:</p><p class="math-container">\[I_1 = \left[ xF(x)F^{\prime}(x)\right]_b^a = \left( a F(a) F^{\prime}(a)\right) - \left( b F(b) F^{\prime}(b)\right) \]</p><p>and</p><p class="math-container">\[I_2 =\int_b^a x F^2(x) dx = \int_b^a A_m^2J_m^2(x) + B_m^2 Y_m^2(x) + 2A_mB_mJ_m(x)Y_m(x) dx\]</p><p class="math-container">\[I_2 =\int_b^a x F^2(x) dx = A_m^2\int_b^a J_m^2(x)dx + B_m^2 \int_b^aY_m^2(x)dx + 2A_mB_m \int_b^a J_m(x)Y_m(x) dx\]</p><p>All this integrals can be solved with closed form solutions.</p><p>The normalization constant <span>$F_0$</span> has exactly the same expression as in circular waveguides, only changing the computation of <strong>I</strong>.</p><h2 id="Radial-and-Wedge-Waveguide"><a class="docs-heading-anchor" href="#Radial-and-Wedge-Waveguide">Radial and Wedge Waveguide</a><a id="Radial-and-Wedge-Waveguide-1"></a><a class="docs-heading-anchor-permalink" href="#Radial-and-Wedge-Waveguide" title="Permalink"></a></h2><p>In radial and wedge waveguides, power propagates radially along the <span>$\rho$</span> direction.</p><h3 id="Power-Flow-Components"><a class="docs-heading-anchor" href="#Power-Flow-Components">Power Flow Components</a><a id="Power-Flow-Components-1"></a><a class="docs-heading-anchor-permalink" href="#Power-Flow-Components" title="Permalink"></a></h3><p>The radial component of the Poynting vector is:</p><p class="math-container">\[S_\rho = \frac{1}{2} \left( E_\phi H_z^* - E_z H_\phi^*\right)\]</p><ul><li><p><strong>TE modes</strong> <span>$E_z = 0$</span> so <span>$S_\rho = \frac{1}{2} E_\phi H_z^*$</span></p></li><li><p><strong>TM modes</strong> <span>$H_z = 0$</span> so <span>$S_\rho = \frac{1}{2} E_z H_\phi^*$</span>.</p></li></ul><h3 id="Field-Representation-2"><a class="docs-heading-anchor" href="#Field-Representation-2">Field Representation</a><a class="docs-heading-anchor-permalink" href="#Field-Representation-2" title="Permalink"></a></h3><p>Let&#39;s define the field functions:</p><p class="math-container">\[\psi(\rho) = A_{mn}H_m^{(2)}(k_c\rho)\]</p><p class="math-container">\[\phi_m(\varphi) = \begin{cases} \cos(m\varphi) \\ \sin(m\varphi) \end{cases}\]</p><p class="math-container">\[Z_n(z)  = \begin{cases} \sin(\frac{n\pi}{h}z) \\ \cos(\frac{n\pi}{h}z) \end{cases}\]</p><p>where the longitudinal field <span>$E_z$</span> or <span>$H_z$</span> (<em>TM</em> or <em>TE</em> modes) is defined as <span>$\psi(\rho)\phi_m(\varphi)Z_n(z)$</span>.</p><h2 id="Power-Integration"><a class="docs-heading-anchor" href="#Power-Integration">Power Integration</a><a id="Power-Integration-1"></a><a class="docs-heading-anchor-permalink" href="#Power-Integration" title="Permalink"></a></h2><p>For <strong>TE modes</strong>, integrating the power flow:</p><p class="math-container">\[P = \frac{1}{2} \int_0^{2\pi} \int_0^h \frac{j\mu\omega}{k_c^2}\psi^{\prime}\text{cos}(m\varphi)\text{sin}(\frac{n\pi}{h}z) \psi^*\text{sin}(\frac{n\pi}{h}z)\text{cos}(m\varphi) \rho d\varphi dz\]</p><p>The longitudinal and angular integrals yield:</p><p class="math-container">\[\int_0^h \text{sin}(\frac{n\pi}{h}z)  dz = \frac{h}{2}\]</p><p class="math-container">\[\int_0^{2\pi}\text{cos}^2(m\varphi) d\varphi = \alpha_m =\begin{cases} \pi &amp; \text{if } m \geq 1 \\ 2\pi &amp; \text{if } m = 0 \end{cases}\]</p><p>Thus, the total power simplifies to:</p><p class="math-container">\[P = \frac{1}{2} \text{Re} \left[ \frac{j\mu\omega}{k_c^2} \cdot \frac{h}{2} \cdot \alpha_m \cdot \rho \cdot \psi(\rho) \psi^{\prime}(\rho) \right]\]</p><p class="math-container">\[F_0 = \sqrt\frac{1}{P}\]</p><p>The same procedure and result applies to TM modes, replacing <span>$\mu$</span> by <span>$\varepsilon$</span>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../em_solutions/">« Mode Theory</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Wednesday 12 November 2025 22:57">Wednesday 12 November 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
